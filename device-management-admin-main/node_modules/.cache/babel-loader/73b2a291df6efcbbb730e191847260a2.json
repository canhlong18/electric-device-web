{"ast":null,"code":"import { pathToRegexp } from '@qixian.cs/path-to-regexp';\nimport getFlatMenu from '../getFlatMenus/getFlatMenus';\nimport { isUrl, stripQueryStringAndHashFromPath } from '../transformRoute/transformRoute';\nexport var getMenuMatches = function getMenuMatches() {\n  var flatMenuKeys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var path = arguments.length > 1 ? arguments[1] : undefined;\n  var exact = arguments.length > 2 ? arguments[2] : undefined;\n  return flatMenuKeys.filter(function (item) {\n    if (item === '/' && path === '/') {\n      return true;\n    }\n\n    if (item !== '/' && item !== '/*' && item && !isUrl(item)) {\n      var pathKey = stripQueryStringAndHashFromPath(item);\n\n      try {\n        // exact\n        if (exact) {\n          if (pathToRegexp(\"\".concat(pathKey)).test(path)) {\n            return true;\n          }\n        } // /a\n\n\n        if (pathToRegexp(\"\".concat(pathKey), []).test(path)) {\n          return true;\n        } // /a/b/b\n\n\n        if (pathToRegexp(\"\".concat(pathKey, \"/(.*)\")).test(path)) {\n          return true;\n        }\n      } catch (error) {// console.log(error, path);\n      }\n    }\n\n    return false;\n  }).sort(function (a, b) {\n    // 如果完全匹配放到最后面\n    if (a === path) {\n      return 10;\n    }\n\n    if (b === path) {\n      return -10;\n    }\n\n    return a.substr(1).split('/').length - b.substr(1).split('/').length;\n  });\n};\n/**\n * 获取当前的选中菜单列表\n * @param pathname\n * @param menuData\n * @returns MenuDataItem[]\n */\n\nexport var getMatchMenu = function getMatchMenu(pathname, menuData,\n/**\n * 要不要展示全部的 key\n */\nfullKeys, exact) {\n  var flatMenus = getFlatMenu(menuData);\n  var flatMenuKeys = Object.keys(flatMenus);\n  var menuPathKeys = getMenuMatches(flatMenuKeys, pathname || '/', exact);\n\n  if (!menuPathKeys || menuPathKeys.length < 1) {\n    return [];\n  }\n\n  if (!fullKeys) {\n    menuPathKeys = [menuPathKeys[menuPathKeys.length - 1]];\n  }\n\n  return menuPathKeys.map(function (menuPathKey) {\n    var menuItem = flatMenus[menuPathKey] || {\n      pro_layout_parentKeys: '',\n      key: ''\n    }; // 去重\n\n    var map = new Map();\n    var parentItems = (menuItem.pro_layout_parentKeys || []).map(function (key) {\n      if (map.has(key)) {\n        return null;\n      }\n\n      map.set(key, true);\n      return flatMenus[key];\n    }).filter(function (item) {\n      return item;\n    });\n\n    if (menuItem.key) {\n      parentItems.push(menuItem);\n    }\n\n    return parentItems;\n  }).flat(1);\n};\nexport default getMatchMenu;","map":{"version":3,"names":["pathToRegexp","getFlatMenu","isUrl","stripQueryStringAndHashFromPath","getMenuMatches","flatMenuKeys","arguments","length","undefined","path","exact","filter","item","pathKey","concat","test","error","sort","a","b","substr","split","getMatchMenu","pathname","menuData","fullKeys","flatMenus","Object","keys","menuPathKeys","map","menuPathKey","menuItem","pro_layout_parentKeys","key","Map","parentItems","has","set","push","flat"],"sources":["D:/Canh Long/Documents/Nam4_Ky 2/Chuyên Đề Mạng/Web/device-management-admin-main/node_modules/@umijs/route-utils/es/getMatchMenu/getMatchMenu.js"],"sourcesContent":["import { pathToRegexp } from '@qixian.cs/path-to-regexp';\nimport getFlatMenu from '../getFlatMenus/getFlatMenus';\nimport { isUrl, stripQueryStringAndHashFromPath } from '../transformRoute/transformRoute';\nexport var getMenuMatches = function getMenuMatches() {\n  var flatMenuKeys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var path = arguments.length > 1 ? arguments[1] : undefined;\n  var exact = arguments.length > 2 ? arguments[2] : undefined;\n  return flatMenuKeys.filter(function (item) {\n    if (item === '/' && path === '/') {\n      return true;\n    }\n\n    if (item !== '/' && item !== '/*' && item && !isUrl(item)) {\n      var pathKey = stripQueryStringAndHashFromPath(item);\n\n      try {\n        // exact\n        if (exact) {\n          if (pathToRegexp(\"\".concat(pathKey)).test(path)) {\n            return true;\n          }\n        } // /a\n\n\n        if (pathToRegexp(\"\".concat(pathKey), []).test(path)) {\n          return true;\n        } // /a/b/b\n\n\n        if (pathToRegexp(\"\".concat(pathKey, \"/(.*)\")).test(path)) {\n          return true;\n        }\n      } catch (error) {// console.log(error, path);\n      }\n    }\n\n    return false;\n  }).sort(function (a, b) {\n    // 如果完全匹配放到最后面\n    if (a === path) {\n      return 10;\n    }\n\n    if (b === path) {\n      return -10;\n    }\n\n    return a.substr(1).split('/').length - b.substr(1).split('/').length;\n  });\n};\n/**\n * 获取当前的选中菜单列表\n * @param pathname\n * @param menuData\n * @returns MenuDataItem[]\n */\n\nexport var getMatchMenu = function getMatchMenu(pathname, menuData,\n/**\n * 要不要展示全部的 key\n */\nfullKeys, exact) {\n  var flatMenus = getFlatMenu(menuData);\n  var flatMenuKeys = Object.keys(flatMenus);\n  var menuPathKeys = getMenuMatches(flatMenuKeys, pathname || '/', exact);\n\n  if (!menuPathKeys || menuPathKeys.length < 1) {\n    return [];\n  }\n\n  if (!fullKeys) {\n    menuPathKeys = [menuPathKeys[menuPathKeys.length - 1]];\n  }\n\n  return menuPathKeys.map(function (menuPathKey) {\n    var menuItem = flatMenus[menuPathKey] || {\n      pro_layout_parentKeys: '',\n      key: ''\n    }; // 去重\n\n    var map = new Map();\n    var parentItems = (menuItem.pro_layout_parentKeys || []).map(function (key) {\n      if (map.has(key)) {\n        return null;\n      }\n\n      map.set(key, true);\n      return flatMenus[key];\n    }).filter(function (item) {\n      return item;\n    });\n\n    if (menuItem.key) {\n      parentItems.push(menuItem);\n    }\n\n    return parentItems;\n  }).flat(1);\n};\nexport default getMatchMenu;"],"mappings":"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"},"metadata":{},"sourceType":"module"}