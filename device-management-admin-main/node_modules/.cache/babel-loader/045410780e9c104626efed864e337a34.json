{"ast":null,"code":"/**\n * Dark Reader v4.9.45\n * https://darkreader.org/\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) : typeof define === 'function' && define.amd ? define(['exports'], factory) : (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.DarkReader = {}));\n})(this, function (exports) {\n  'use strict';\n  /*! *****************************************************************************\r\n  Copyright (c) Microsoft Corporation.\r\n    Permission to use, copy, modify, and/or distribute this software for any\r\n  purpose with or without fee is hereby granted.\r\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\n  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\n  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\n  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\n  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\n  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\n  PERFORMANCE OF THIS SOFTWARE.\r\n  ***************************************************************************** */\n\n  var __assign = function () {\n    __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n\n      return t;\n    };\n\n    return __assign.apply(this, arguments);\n  };\n\n  function __awaiter(thisArg, _arguments, P, generator) {\n    function adopt(value) {\n      return value instanceof P ? value : new P(function (resolve) {\n        resolve(value);\n      });\n    }\n\n    return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) {\n        try {\n          step(generator.next(value));\n        } catch (e) {\n          reject(e);\n        }\n      }\n\n      function rejected(value) {\n        try {\n          step(generator[\"throw\"](value));\n        } catch (e) {\n          reject(e);\n        }\n      }\n\n      function step(result) {\n        result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n      }\n\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n  }\n\n  function __generator(thisArg, body) {\n    var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n        f,\n        y,\n        t,\n        g;\n    return g = {\n      next: verb(0),\n      \"throw\": verb(1),\n      \"return\": verb(2)\n    }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n      return this;\n    }), g;\n\n    function verb(n) {\n      return function (v) {\n        return step([n, v]);\n      };\n    }\n\n    function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n\n      while (_) try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n\n      if (op[0] & 5) throw op[1];\n      return {\n        value: op[0] ? op[1] : void 0,\n        done: true\n      };\n    }\n  }\n\n  function __values(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator,\n        m = s && o[s],\n        i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n      next: function () {\n        if (o && i >= o.length) o = void 0;\n        return {\n          value: o && o[i++],\n          done: !o\n        };\n      }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n  }\n\n  function __read(o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o),\n        r,\n        ar = [],\n        e;\n\n    try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    } catch (error) {\n      e = {\n        error: error\n      };\n    } finally {\n      try {\n        if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      } finally {\n        if (e) throw e.error;\n      }\n    }\n\n    return ar;\n  }\n\n  function __spreadArray(to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n        if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n        ar[i] = from[i];\n      }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n  }\n\n  var MessageType = {\n    UI_GET_DATA: 'ui-get-data',\n    UI_GET_ACTIVE_TAB_INFO: 'ui-get-active-tab-info',\n    UI_SUBSCRIBE_TO_CHANGES: 'ui-subscribe-to-changes',\n    UI_UNSUBSCRIBE_FROM_CHANGES: 'ui-unsubscribe-from-changes',\n    UI_CHANGE_SETTINGS: 'ui-change-settings',\n    UI_SET_THEME: 'ui-set-theme',\n    UI_SET_SHORTCUT: 'ui-set-shortcut',\n    UI_TOGGLE_URL: 'ui-toggle-url',\n    UI_MARK_NEWS_AS_READ: 'ui-mark-news-as-read',\n    UI_LOAD_CONFIG: 'ui-load-config',\n    UI_APPLY_DEV_DYNAMIC_THEME_FIXES: 'ui-apply-dev-dynamic-theme-fixes',\n    UI_RESET_DEV_DYNAMIC_THEME_FIXES: 'ui-reset-dev-dynamic-theme-fixes',\n    UI_APPLY_DEV_INVERSION_FIXES: 'ui-apply-dev-inversion-fixes',\n    UI_RESET_DEV_INVERSION_FIXES: 'ui-reset-dev-inversion-fixes',\n    UI_APPLY_DEV_STATIC_THEMES: 'ui-apply-dev-static-themes',\n    UI_RESET_DEV_STATIC_THEMES: 'ui-reset-dev-static-themes',\n    UI_SAVE_FILE: 'ui-save-file',\n    UI_REQUEST_EXPORT_CSS: 'ui-request-export-css',\n    BG_CHANGES: 'bg-changes',\n    BG_ADD_CSS_FILTER: 'bg-add-css-filter',\n    BG_ADD_STATIC_THEME: 'bg-add-static-theme',\n    BG_ADD_SVG_FILTER: 'bg-add-svg-filter',\n    BG_ADD_DYNAMIC_THEME: 'bg-add-dynamic-theme',\n    BG_EXPORT_CSS: 'bg-export-css',\n    BG_UNSUPPORTED_SENDER: 'bg-unsupported-sender',\n    BG_CLEAN_UP: 'bg-clean-up',\n    BG_RELOAD: 'bg-reload',\n    BG_FETCH_RESPONSE: 'bg-fetch-response',\n    BG_UI_UPDATE: 'bg-ui-update',\n    BG_CSS_UPDATE: 'bg-css-update',\n    CS_COLOR_SCHEME_CHANGE: 'cs-color-scheme-change',\n    CS_FRAME_CONNECT: 'cs-frame-connect',\n    CS_FRAME_FORGET: 'cs-frame-forget',\n    CS_FRAME_FREEZE: 'cs-frame-freeze',\n    CS_FRAME_RESUME: 'cs-frame-resume',\n    CS_EXPORT_CSS_RESPONSE: 'cs-export-css-response',\n    CS_FETCH: 'cs-fetch'\n  };\n  var userAgent = typeof navigator === 'undefined' ? 'some useragent' : navigator.userAgent.toLowerCase();\n  var platform = typeof navigator === 'undefined' ? 'some platform' : navigator.platform.toLowerCase();\n  var isChromium = userAgent.includes('chrome') || userAgent.includes('chromium');\n  var isThunderbird = userAgent.includes('thunderbird');\n  var isFirefox = userAgent.includes('firefox') || userAgent.includes('librewolf') || isThunderbird;\n  userAgent.includes('vivaldi');\n  userAgent.includes('yabrowser');\n  userAgent.includes('opr') || userAgent.includes('opera');\n  userAgent.includes('edg');\n  var isSafari = userAgent.includes('safari') && !isChromium;\n  var isWindows = platform.startsWith('win');\n  var isMacOS = platform.startsWith('mac');\n  userAgent.includes('mobile');\n  var isShadowDomSupported = typeof ShadowRoot === 'function';\n  var isMatchMediaChangeEventListenerSupported = typeof MediaQueryList === 'function' && typeof MediaQueryList.prototype.addEventListener === 'function';\n\n  (function () {\n    var m = userAgent.match(/chrom[e|ium]\\/([^ ]+)/);\n\n    if (m && m[1]) {\n      return m[1];\n    }\n\n    return '';\n  })();\n\n  var isDefinedSelectorSupported = function () {\n    try {\n      document.querySelector(':defined');\n      return true;\n    } catch (err) {\n      return false;\n    }\n  }();\n\n  typeof globalThis !== 'undefined' && globalThis.chrome && globalThis.chrome.runtime && globalThis.chrome.runtime.getManifest && globalThis.chrome.runtime.getManifest().manifest_version === 3;\n\n  function getOKResponse(url, mimeType, origin) {\n    return __awaiter(this, void 0, void 0, function () {\n      var response;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4, fetch(url, {\n              cache: 'force-cache',\n              credentials: 'omit',\n              referrer: origin\n            })];\n\n          case 1:\n            response = _a.sent();\n\n            if (isFirefox && mimeType === 'text/css' && url.startsWith('moz-extension://') && url.endsWith('.css')) {\n              return [2, response];\n            }\n\n            if (mimeType && !response.headers.get('Content-Type').startsWith(mimeType)) {\n              throw new Error(\"Mime type mismatch when loading \" + url);\n            }\n\n            if (!response.ok) {\n              throw new Error(\"Unable to load \" + url + \" \" + response.status + \" \" + response.statusText);\n            }\n\n            return [2, response];\n        }\n      });\n    });\n  }\n\n  function loadAsDataURL(url, mimeType) {\n    return __awaiter(this, void 0, void 0, function () {\n      var response;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4, getOKResponse(url, mimeType)];\n\n          case 1:\n            response = _a.sent();\n            return [4, readResponseAsDataURL(response)];\n\n          case 2:\n            return [2, _a.sent()];\n        }\n      });\n    });\n  }\n\n  function readResponseAsDataURL(response) {\n    return __awaiter(this, void 0, void 0, function () {\n      var blob, dataURL;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4, response.blob()];\n\n          case 1:\n            blob = _a.sent();\n            return [4, new Promise(function (resolve) {\n              var reader = new FileReader();\n\n              reader.onloadend = function () {\n                return resolve(reader.result);\n              };\n\n              reader.readAsDataURL(blob);\n            })];\n\n          case 2:\n            dataURL = _a.sent();\n            return [2, dataURL];\n        }\n      });\n    });\n  }\n\n  var throwCORSError = function (url) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2, Promise.reject(new Error(['Embedded Dark Reader cannot access a cross-origin resource', url, 'Overview your URLs and CORS policies or use', '`DarkReader.setFetchMethod(fetch: (url) => Promise<Response>))`.', 'See if using `DarkReader.setFetchMethod(window.fetch)`', 'before `DarkReader.enable()` works.'].join(' ')))];\n      });\n    });\n  };\n\n  var fetcher = throwCORSError;\n\n  function setFetchMethod$1(fetch) {\n    if (fetch) {\n      fetcher = fetch;\n    } else {\n      fetcher = throwCORSError;\n    }\n  }\n\n  function callFetchMethod(url) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4, fetcher(url)];\n\n          case 1:\n            return [2, _a.sent()];\n        }\n      });\n    });\n  }\n\n  function initChrome() {\n    if (typeof chrome === 'undefined') return;\n\n    if (typeof window !== 'undefined' && !window.chrome) {\n      window.chrome = {};\n    }\n\n    if (typeof chrome !== 'undefined' && !chrome.runtime) {\n      chrome.runtime = {};\n    }\n\n    var messageListeners = new Set();\n\n    function sendMessage() {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return __awaiter(this, void 0, void 0, function () {\n        var id_1, _a, url, responseType, response, text_1, error_1;\n\n        return __generator(this, function (_b) {\n          switch (_b.label) {\n            case 0:\n              if (!(args[0] && args[0].type === MessageType.CS_FETCH)) return [3, 8];\n              id_1 = args[0].id;\n              _b.label = 1;\n\n            case 1:\n              _b.trys.push([1, 7,, 8]);\n\n              _a = args[0].data, url = _a.url, responseType = _a.responseType;\n              return [4, callFetchMethod(url)];\n\n            case 2:\n              response = _b.sent();\n              if (!(responseType === 'data-url')) return [3, 4];\n              return [4, readResponseAsDataURL(response)];\n\n            case 3:\n              text_1 = _b.sent();\n              return [3, 6];\n\n            case 4:\n              return [4, response.text()];\n\n            case 5:\n              text_1 = _b.sent();\n              _b.label = 6;\n\n            case 6:\n              messageListeners.forEach(function (cb) {\n                return cb({\n                  type: MessageType.BG_FETCH_RESPONSE,\n                  data: text_1,\n                  error: null,\n                  id: id_1\n                });\n              });\n              return [3, 8];\n\n            case 7:\n              error_1 = _b.sent();\n              console.error(error_1);\n              messageListeners.forEach(function (cb) {\n                return cb({\n                  type: MessageType.BG_FETCH_RESPONSE,\n                  data: null,\n                  error: error_1,\n                  id: id_1\n                });\n              });\n              return [3, 8];\n\n            case 8:\n              return [2];\n          }\n        });\n      });\n    }\n\n    function addMessageListener(callback) {\n      messageListeners.add(callback);\n    }\n\n    if (typeof chrome.runtime.sendMessage === 'function') {\n      var nativeSendMessage_1 = chrome.runtime.sendMessage;\n\n      chrome.runtime.sendMessage = function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        sendMessage.apply(void 0, __spreadArray([], __read(args), false));\n        nativeSendMessage_1.apply(chrome.runtime, args);\n      };\n    } else {\n      chrome.runtime.sendMessage = sendMessage;\n    }\n\n    if (!chrome.runtime.onMessage) {\n      chrome.runtime.onMessage = {};\n    }\n\n    if (typeof chrome.runtime.onMessage.addListener === 'function') {\n      var nativeAddListener_1 = chrome.runtime.onMessage.addListener;\n\n      chrome.runtime.onMessage.addListener = function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        addMessageListener(args[0]);\n        nativeAddListener_1.apply(chrome.runtime.onMessage, args);\n      };\n    } else {\n      chrome.runtime.onMessage.addListener = function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        return addMessageListener(args[0]);\n      };\n    }\n  }\n\n  initChrome();\n  var ThemeEngines = {\n    cssFilter: 'cssFilter',\n    svgFilter: 'svgFilter',\n    staticTheme: 'staticTheme',\n    dynamicTheme: 'dynamicTheme'\n  };\n  var DEFAULT_COLORS = {\n    darkScheme: {\n      background: '#181a1b',\n      text: '#e8e6e3'\n    },\n    lightScheme: {\n      background: '#dcdad7',\n      text: '#181a1b'\n    }\n  };\n  var DEFAULT_THEME = {\n    mode: 1,\n    brightness: 100,\n    contrast: 100,\n    grayscale: 0,\n    sepia: 0,\n    useFont: false,\n    fontFamily: isMacOS ? 'Helvetica Neue' : isWindows ? 'Segoe UI' : 'Open Sans',\n    textStroke: 0,\n    engine: ThemeEngines.dynamicTheme,\n    stylesheet: '',\n    darkSchemeBackgroundColor: DEFAULT_COLORS.darkScheme.background,\n    darkSchemeTextColor: DEFAULT_COLORS.darkScheme.text,\n    lightSchemeBackgroundColor: DEFAULT_COLORS.lightScheme.background,\n    lightSchemeTextColor: DEFAULT_COLORS.lightScheme.text,\n    scrollbarColor: isMacOS ? '' : 'auto',\n    selectionColor: 'auto',\n    styleSystemControls: true,\n    lightColorScheme: 'Default',\n    darkColorScheme: 'Default'\n  };\n\n  function isArrayLike(items) {\n    return items.length != null;\n  }\n\n  function forEach(items, iterator) {\n    var e_1, _a;\n\n    if (isArrayLike(items)) {\n      for (var i = 0, len = items.length; i < len; i++) {\n        iterator(items[i]);\n      }\n    } else {\n      try {\n        for (var items_1 = __values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {\n          var item = items_1_1.value;\n          iterator(item);\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n    }\n  }\n\n  function push(array, addition) {\n    forEach(addition, function (a) {\n      return array.push(a);\n    });\n  }\n\n  function toArray(items) {\n    var results = [];\n\n    for (var i = 0, len = items.length; i < len; i++) {\n      results.push(items[i]);\n    }\n\n    return results;\n  }\n\n  function logInfo() {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n  }\n\n  function logWarn() {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n  }\n\n  function throttle(callback) {\n    var pending = false;\n    var frameId = null;\n    var lastArgs;\n\n    var throttled = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      lastArgs = args;\n\n      if (frameId) {\n        pending = true;\n      } else {\n        callback.apply(void 0, __spreadArray([], __read(lastArgs), false));\n        frameId = requestAnimationFrame(function () {\n          frameId = null;\n\n          if (pending) {\n            callback.apply(void 0, __spreadArray([], __read(lastArgs), false));\n            pending = false;\n          }\n        });\n      }\n    };\n\n    var cancel = function () {\n      cancelAnimationFrame(frameId);\n      pending = false;\n      frameId = null;\n    };\n\n    return Object.assign(throttled, {\n      cancel: cancel\n    });\n  }\n\n  function createAsyncTasksQueue() {\n    var tasks = [];\n    var frameId = null;\n\n    function runTasks() {\n      var task;\n\n      while (task = tasks.shift()) {\n        task();\n      }\n\n      frameId = null;\n    }\n\n    function add(task) {\n      tasks.push(task);\n\n      if (!frameId) {\n        frameId = requestAnimationFrame(runTasks);\n      }\n    }\n\n    function cancel() {\n      tasks.splice(0);\n      cancelAnimationFrame(frameId);\n      frameId = null;\n    }\n\n    return {\n      add: add,\n      cancel: cancel\n    };\n  }\n\n  function getDuration(time) {\n    var duration = 0;\n\n    if (time.seconds) {\n      duration += time.seconds * 1000;\n    }\n\n    if (time.minutes) {\n      duration += time.minutes * 60 * 1000;\n    }\n\n    if (time.hours) {\n      duration += time.hours * 60 * 60 * 1000;\n    }\n\n    if (time.days) {\n      duration += time.days * 24 * 60 * 60 * 1000;\n    }\n\n    return duration;\n  }\n\n  function removeNode(node) {\n    node && node.parentNode && node.parentNode.removeChild(node);\n  }\n\n  function watchForNodePosition(node, mode, onRestore) {\n    if (onRestore === void 0) {\n      onRestore = Function.prototype;\n    }\n\n    var MAX_ATTEMPTS_COUNT = 10;\n    var RETRY_TIMEOUT = getDuration({\n      seconds: 2\n    });\n    var ATTEMPTS_INTERVAL = getDuration({\n      seconds: 10\n    });\n    var prevSibling = node.previousSibling;\n    var parent = node.parentNode;\n\n    if (!parent) {\n      throw new Error('Unable to watch for node position: parent element not found');\n    }\n\n    if (mode === 'prev-sibling' && !prevSibling) {\n      throw new Error('Unable to watch for node position: there is no previous sibling');\n    }\n\n    var attempts = 0;\n    var start = null;\n    var timeoutId = null;\n    var restore = throttle(function () {\n      if (timeoutId) {\n        return;\n      }\n\n      attempts++;\n      var now = Date.now();\n\n      if (start == null) {\n        start = now;\n      } else if (attempts >= MAX_ATTEMPTS_COUNT) {\n        if (now - start < ATTEMPTS_INTERVAL) {\n          logWarn(\"Node position watcher paused: retry in \" + RETRY_TIMEOUT + \"ms\", node, prevSibling);\n          timeoutId = setTimeout(function () {\n            start = null;\n            attempts = 0;\n            timeoutId = null;\n            restore();\n          }, RETRY_TIMEOUT);\n          return;\n        }\n\n        start = now;\n        attempts = 1;\n      }\n\n      if (mode === 'parent') {\n        if (prevSibling && prevSibling.parentNode !== parent) {\n          logWarn('Unable to restore node position: sibling parent changed', node, prevSibling, parent);\n          stop();\n          return;\n        }\n      }\n\n      if (mode === 'prev-sibling') {\n        if (prevSibling.parentNode == null) {\n          logWarn('Unable to restore node position: sibling was removed', node, prevSibling, parent);\n          stop();\n          return;\n        }\n\n        if (prevSibling.parentNode !== parent) {\n          logWarn('Style was moved to another parent', node, prevSibling, parent);\n          updateParent(prevSibling.parentNode);\n        }\n      }\n\n      logWarn('Restoring node position', node, prevSibling, parent);\n      parent.insertBefore(node, prevSibling ? prevSibling.nextSibling : parent.firstChild);\n      observer.takeRecords();\n      onRestore && onRestore();\n    });\n    var observer = new MutationObserver(function () {\n      if (mode === 'parent' && node.parentNode !== parent || mode === 'prev-sibling' && node.previousSibling !== prevSibling) {\n        restore();\n      }\n    });\n\n    var run = function () {\n      observer.observe(parent, {\n        childList: true\n      });\n    };\n\n    var stop = function () {\n      clearTimeout(timeoutId);\n      observer.disconnect();\n      restore.cancel();\n    };\n\n    var skip = function () {\n      observer.takeRecords();\n    };\n\n    var updateParent = function (parentNode) {\n      parent = parentNode;\n      stop();\n      run();\n    };\n\n    run();\n    return {\n      run: run,\n      stop: stop,\n      skip: skip\n    };\n  }\n\n  function iterateShadowHosts(root, iterator) {\n    if (root == null) {\n      return;\n    }\n\n    var walker = document.createTreeWalker(root, NodeFilter.SHOW_ELEMENT, {\n      acceptNode: function (node) {\n        return node.shadowRoot == null ? NodeFilter.FILTER_SKIP : NodeFilter.FILTER_ACCEPT;\n      }\n    });\n\n    for (var node = root.shadowRoot ? walker.currentNode : walker.nextNode(); node != null; node = walker.nextNode()) {\n      iterator(node);\n      iterateShadowHosts(node.shadowRoot, iterator);\n    }\n  }\n\n  function isDOMReady() {\n    if (typeof document === 'undefined') return false;\n    return document.readyState === 'complete' || document.readyState === 'interactive';\n  }\n\n  var readyStateListeners = new Set();\n\n  function addDOMReadyListener(listener) {\n    readyStateListeners.add(listener);\n  }\n\n  function removeDOMReadyListener(listener) {\n    readyStateListeners.delete(listener);\n  }\n\n  function isReadyStateComplete() {\n    return document.readyState === 'complete';\n  }\n\n  var readyStateCompleteListeners = new Set();\n\n  function addReadyStateCompleteListener(listener) {\n    readyStateCompleteListeners.add(listener);\n  }\n\n  function cleanReadyStateCompleteListeners() {\n    readyStateCompleteListeners.clear();\n  }\n\n  if (!isDOMReady()) {\n    var onReadyStateChange_1 = function () {\n      if (isDOMReady()) {\n        readyStateListeners.forEach(function (listener) {\n          return listener();\n        });\n        readyStateListeners.clear();\n\n        if (isReadyStateComplete()) {\n          document.removeEventListener('readystatechange', onReadyStateChange_1);\n          readyStateCompleteListeners.forEach(function (listener) {\n            return listener();\n          });\n          readyStateCompleteListeners.clear();\n        }\n      }\n    };\n\n    if (typeof document !== 'undefined') {\n      document.addEventListener('readystatechange', onReadyStateChange_1);\n    }\n  }\n\n  var HUGE_MUTATIONS_COUNT = 1000;\n\n  function isHugeMutation(mutations) {\n    if (mutations.length > HUGE_MUTATIONS_COUNT) {\n      return true;\n    }\n\n    var addedNodesCount = 0;\n\n    for (var i = 0; i < mutations.length; i++) {\n      addedNodesCount += mutations[i].addedNodes.length;\n\n      if (addedNodesCount > HUGE_MUTATIONS_COUNT) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function getElementsTreeOperations(mutations) {\n    var additions = new Set();\n    var deletions = new Set();\n    var moves = new Set();\n    mutations.forEach(function (m) {\n      forEach(m.addedNodes, function (n) {\n        if (n instanceof Element && n.isConnected) {\n          additions.add(n);\n        }\n      });\n      forEach(m.removedNodes, function (n) {\n        if (n instanceof Element) {\n          if (n.isConnected) {\n            moves.add(n);\n            additions.delete(n);\n          } else {\n            deletions.add(n);\n          }\n        }\n      });\n    });\n    var duplicateAdditions = [];\n    var duplicateDeletions = [];\n    additions.forEach(function (node) {\n      if (additions.has(node.parentElement)) {\n        duplicateAdditions.push(node);\n      }\n    });\n    deletions.forEach(function (node) {\n      if (deletions.has(node.parentElement)) {\n        duplicateDeletions.push(node);\n      }\n    });\n    duplicateAdditions.forEach(function (node) {\n      return additions.delete(node);\n    });\n    duplicateDeletions.forEach(function (node) {\n      return deletions.delete(node);\n    });\n    return {\n      additions: additions,\n      moves: moves,\n      deletions: deletions\n    };\n  }\n\n  var optimizedTreeObservers = new Map();\n  var optimizedTreeCallbacks = new WeakMap();\n\n  function createOptimizedTreeObserver(root, callbacks) {\n    var observer;\n    var observerCallbacks;\n    var domReadyListener;\n\n    if (optimizedTreeObservers.has(root)) {\n      observer = optimizedTreeObservers.get(root);\n      observerCallbacks = optimizedTreeCallbacks.get(observer);\n    } else {\n      var hadHugeMutationsBefore_1 = false;\n      var subscribedForReadyState_1 = false;\n      observer = new MutationObserver(function (mutations) {\n        if (isHugeMutation(mutations)) {\n          if (!hadHugeMutationsBefore_1 || isDOMReady()) {\n            observerCallbacks.forEach(function (_a) {\n              var onHugeMutations = _a.onHugeMutations;\n              return onHugeMutations(root);\n            });\n          } else if (!subscribedForReadyState_1) {\n            domReadyListener = function () {\n              return observerCallbacks.forEach(function (_a) {\n                var onHugeMutations = _a.onHugeMutations;\n                return onHugeMutations(root);\n              });\n            };\n\n            addDOMReadyListener(domReadyListener);\n            subscribedForReadyState_1 = true;\n          }\n\n          hadHugeMutationsBefore_1 = true;\n        } else {\n          var elementsOperations_1 = getElementsTreeOperations(mutations);\n          observerCallbacks.forEach(function (_a) {\n            var onMinorMutations = _a.onMinorMutations;\n            return onMinorMutations(elementsOperations_1);\n          });\n        }\n      });\n      observer.observe(root, {\n        childList: true,\n        subtree: true\n      });\n      optimizedTreeObservers.set(root, observer);\n      observerCallbacks = new Set();\n      optimizedTreeCallbacks.set(observer, observerCallbacks);\n    }\n\n    observerCallbacks.add(callbacks);\n    return {\n      disconnect: function () {\n        observerCallbacks.delete(callbacks);\n\n        if (domReadyListener) {\n          removeDOMReadyListener(domReadyListener);\n        }\n\n        if (observerCallbacks.size === 0) {\n          observer.disconnect();\n          optimizedTreeCallbacks.delete(observer);\n          optimizedTreeObservers.delete(root);\n        }\n      }\n    };\n  }\n\n  var anchor;\n  var parsedURLCache = new Map();\n\n  function fixBaseURL($url) {\n    if (!anchor) {\n      anchor = document.createElement('a');\n    }\n\n    anchor.href = $url;\n    return anchor.href;\n  }\n\n  function parseURL($url, $base) {\n    if ($base === void 0) {\n      $base = null;\n    }\n\n    var key = \"\" + $url + ($base ? \";\" + $base : '');\n\n    if (parsedURLCache.has(key)) {\n      return parsedURLCache.get(key);\n    }\n\n    if ($base) {\n      var parsedURL_1 = new URL($url, fixBaseURL($base));\n      parsedURLCache.set(key, parsedURL_1);\n      return parsedURL_1;\n    }\n\n    var parsedURL = new URL(fixBaseURL($url));\n    parsedURLCache.set($url, parsedURL);\n    return parsedURL;\n  }\n\n  function getAbsoluteURL($base, $relative) {\n    if ($relative.match(/^data\\\\?\\:/)) {\n      return $relative;\n    }\n\n    if (/^\\/\\//.test($relative)) {\n      return \"\" + location.protocol + $relative;\n    }\n\n    var b = parseURL($base);\n    var a = parseURL($relative, b.href);\n    return a.href;\n  }\n\n  function isRelativeHrefOnAbsolutePath(href) {\n    if (href.startsWith('data:')) {\n      return true;\n    }\n\n    var url = parseURL(href);\n\n    if (url.protocol !== location.protocol) {\n      return false;\n    }\n\n    if (url.hostname !== location.hostname) {\n      return false;\n    }\n\n    if (url.port !== location.port) {\n      return false;\n    }\n\n    return url.pathname === location.pathname;\n  }\n\n  function iterateCSSRules(rules, iterate, onMediaRuleError) {\n    forEach(rules, function (rule) {\n      if (rule.selectorText) {\n        iterate(rule);\n      } else if (rule.href) {\n        try {\n          iterateCSSRules(rule.styleSheet.cssRules, iterate, onMediaRuleError);\n        } catch (err) {\n          logInfo(\"Found a non-loaded link.\");\n          onMediaRuleError && onMediaRuleError();\n        }\n      } else if (rule.media) {\n        var media = Array.from(rule.media);\n        var isScreenOrAllOrQuery = media.some(function (m) {\n          return m.startsWith('screen') || m.startsWith('all') || m.startsWith('(');\n        });\n        var isPrintOrSpeech = media.some(function (m) {\n          return m.startsWith('print') || m.startsWith('speech');\n        });\n\n        if (isScreenOrAllOrQuery || !isPrintOrSpeech) {\n          iterateCSSRules(rule.cssRules, iterate, onMediaRuleError);\n        }\n      } else if (rule.conditionText) {\n        if (CSS.supports(rule.conditionText)) {\n          iterateCSSRules(rule.cssRules, iterate, onMediaRuleError);\n        }\n      } else {\n        logWarn(\"CSSRule type not supported\", rule);\n      }\n    });\n  }\n\n  var shorthandVarDependantProperties = ['background', 'border', 'border-color', 'border-bottom', 'border-left', 'border-right', 'border-top', 'outline', 'outline-color'];\n  var shorthandVarDepPropRegexps = isSafari ? shorthandVarDependantProperties.map(function (prop) {\n    var regexp = new RegExp(prop + \":\\\\s*(.*?)\\\\s*;\");\n    return [prop, regexp];\n  }) : null;\n\n  function iterateCSSDeclarations(style, iterate) {\n    forEach(style, function (property) {\n      var value = style.getPropertyValue(property).trim();\n\n      if (!value) {\n        return;\n      }\n\n      iterate(property, value);\n    });\n    var cssText = style.cssText;\n\n    if (cssText.includes('var(')) {\n      if (isSafari) {\n        shorthandVarDepPropRegexps.forEach(function (_a) {\n          var _b = __read(_a, 2),\n              prop = _b[0],\n              regexp = _b[1];\n\n          var match = cssText.match(regexp);\n\n          if (match && match[1]) {\n            var val = match[1].trim();\n            iterate(prop, val);\n          }\n        });\n      } else {\n        shorthandVarDependantProperties.forEach(function (prop) {\n          var val = style.getPropertyValue(prop);\n\n          if (val && val.includes('var(')) {\n            iterate(prop, val);\n          }\n        });\n      }\n    }\n  }\n\n  var cssURLRegex = /url\\((('.+?')|(\".+?\")|([^\\)]*?))\\)/g;\n  var cssImportRegex = /@import\\s*(url\\()?(('.+?')|(\".+?\")|([^\\)]*?))\\)? ?(screen)?;?/g;\n\n  function getCSSURLValue(cssURL) {\n    return cssURL.replace(/^url\\((.*)\\)$/, '$1').trim().replace(/^\"(.*)\"$/, '$1').replace(/^'(.*)'$/, '$1');\n  }\n\n  function getCSSBaseBath(url) {\n    var cssURL = parseURL(url);\n    return \"\" + cssURL.origin + cssURL.pathname.replace(/\\?.*$/, '').replace(/(\\/)([^\\/]+)$/i, '$1');\n  }\n\n  function replaceCSSRelativeURLsWithAbsolute($css, cssBasePath) {\n    return $css.replace(cssURLRegex, function (match) {\n      var pathValue = getCSSURLValue(match);\n\n      try {\n        return \"url(\\\"\" + getAbsoluteURL(cssBasePath, pathValue) + \"\\\")\";\n      } catch (err) {\n        logWarn('Not able to replace relative URL with Absolute URL, skipping');\n        return match;\n      }\n    });\n  }\n\n  var cssCommentsRegex = /\\/\\*[\\s\\S]*?\\*\\//g;\n\n  function removeCSSComments($css) {\n    return $css.replace(cssCommentsRegex, '');\n  }\n\n  var fontFaceRegex = /@font-face\\s*{[^}]*}/g;\n\n  function replaceCSSFontFace($css) {\n    return $css.replace(fontFaceRegex, '');\n  }\n\n  function hslToRGB(_a) {\n    var h = _a.h,\n        s = _a.s,\n        l = _a.l,\n        _b = _a.a,\n        a = _b === void 0 ? 1 : _b;\n\n    if (s === 0) {\n      var _c = __read([l, l, l].map(function (x) {\n        return Math.round(x * 255);\n      }), 3),\n          r_1 = _c[0],\n          b_1 = _c[1],\n          g_1 = _c[2];\n\n      return {\n        r: r_1,\n        g: g_1,\n        b: b_1,\n        a: a\n      };\n    }\n\n    var c = (1 - Math.abs(2 * l - 1)) * s;\n    var x = c * (1 - Math.abs(h / 60 % 2 - 1));\n    var m = l - c / 2;\n\n    var _d = __read((h < 60 ? [c, x, 0] : h < 120 ? [x, c, 0] : h < 180 ? [0, c, x] : h < 240 ? [0, x, c] : h < 300 ? [x, 0, c] : [c, 0, x]).map(function (n) {\n      return Math.round((n + m) * 255);\n    }), 3),\n        r = _d[0],\n        g = _d[1],\n        b = _d[2];\n\n    return {\n      r: r,\n      g: g,\n      b: b,\n      a: a\n    };\n  }\n\n  function rgbToHSL(_a) {\n    var r255 = _a.r,\n        g255 = _a.g,\n        b255 = _a.b,\n        _b = _a.a,\n        a = _b === void 0 ? 1 : _b;\n    var r = r255 / 255;\n    var g = g255 / 255;\n    var b = b255 / 255;\n    var max = Math.max(r, g, b);\n    var min = Math.min(r, g, b);\n    var c = max - min;\n    var l = (max + min) / 2;\n\n    if (c === 0) {\n      return {\n        h: 0,\n        s: 0,\n        l: l,\n        a: a\n      };\n    }\n\n    var h = (max === r ? (g - b) / c % 6 : max === g ? (b - r) / c + 2 : (r - g) / c + 4) * 60;\n\n    if (h < 0) {\n      h += 360;\n    }\n\n    var s = c / (1 - Math.abs(2 * l - 1));\n    return {\n      h: h,\n      s: s,\n      l: l,\n      a: a\n    };\n  }\n\n  function toFixed(n, digits) {\n    if (digits === void 0) {\n      digits = 0;\n    }\n\n    var fixed = n.toFixed(digits);\n\n    if (digits === 0) {\n      return fixed;\n    }\n\n    var dot = fixed.indexOf('.');\n\n    if (dot >= 0) {\n      var zerosMatch = fixed.match(/0+$/);\n\n      if (zerosMatch) {\n        if (zerosMatch.index === dot + 1) {\n          return fixed.substring(0, dot);\n        }\n\n        return fixed.substring(0, zerosMatch.index);\n      }\n    }\n\n    return fixed;\n  }\n\n  function rgbToString(rgb) {\n    var r = rgb.r,\n        g = rgb.g,\n        b = rgb.b,\n        a = rgb.a;\n\n    if (a != null && a < 1) {\n      return \"rgba(\" + toFixed(r) + \", \" + toFixed(g) + \", \" + toFixed(b) + \", \" + toFixed(a, 2) + \")\";\n    }\n\n    return \"rgb(\" + toFixed(r) + \", \" + toFixed(g) + \", \" + toFixed(b) + \")\";\n  }\n\n  function rgbToHexString(_a) {\n    var r = _a.r,\n        g = _a.g,\n        b = _a.b,\n        a = _a.a;\n    return \"#\" + (a != null && a < 1 ? [r, g, b, Math.round(a * 255)] : [r, g, b]).map(function (x) {\n      return \"\" + (x < 16 ? '0' : '') + x.toString(16);\n    }).join('');\n  }\n\n  function hslToString(hsl) {\n    var h = hsl.h,\n        s = hsl.s,\n        l = hsl.l,\n        a = hsl.a;\n\n    if (a != null && a < 1) {\n      return \"hsla(\" + toFixed(h) + \", \" + toFixed(s * 100) + \"%, \" + toFixed(l * 100) + \"%, \" + toFixed(a, 2) + \")\";\n    }\n\n    return \"hsl(\" + toFixed(h) + \", \" + toFixed(s * 100) + \"%, \" + toFixed(l * 100) + \"%)\";\n  }\n\n  var rgbMatch = /^rgba?\\([^\\(\\)]+\\)$/;\n  var hslMatch = /^hsla?\\([^\\(\\)]+\\)$/;\n  var hexMatch = /^#[0-9a-f]+$/i;\n\n  function parse($color) {\n    var c = $color.trim().toLowerCase();\n\n    if (c.match(rgbMatch)) {\n      return parseRGB(c);\n    }\n\n    if (c.match(hslMatch)) {\n      return parseHSL(c);\n    }\n\n    if (c.match(hexMatch)) {\n      return parseHex(c);\n    }\n\n    if (knownColors.has(c)) {\n      return getColorByName(c);\n    }\n\n    if (systemColors.has(c)) {\n      return getSystemColor(c);\n    }\n\n    if ($color === 'transparent') {\n      return {\n        r: 0,\n        g: 0,\n        b: 0,\n        a: 0\n      };\n    }\n\n    throw new Error(\"Unable to parse \" + $color);\n  }\n\n  function getNumbers($color) {\n    var numbers = [];\n    var prevPos = 0;\n    var isMining = false;\n    var startIndex = $color.indexOf('(');\n    $color = $color.substring(startIndex + 1, $color.length - 1);\n\n    for (var i = 0; i < $color.length; i++) {\n      var c = $color[i];\n\n      if (c >= '0' && c <= '9' || c === '.' || c === '+' || c === '-') {\n        isMining = true;\n      } else if (isMining && (c === ' ' || c === ',')) {\n        numbers.push($color.substring(prevPos, i));\n        isMining = false;\n        prevPos = i + 1;\n      } else if (!isMining) {\n        prevPos = i + 1;\n      }\n    }\n\n    if (isMining) {\n      numbers.push($color.substring(prevPos, $color.length));\n    }\n\n    return numbers;\n  }\n\n  function getNumbersFromString(str, range, units) {\n    var raw = getNumbers(str);\n    var unitsList = Object.entries(units);\n    var numbers = raw.map(function (r) {\n      return r.trim();\n    }).map(function (r, i) {\n      var n;\n      var unit = unitsList.find(function (_a) {\n        var _b = __read(_a, 1),\n            u = _b[0];\n\n        return r.endsWith(u);\n      });\n\n      if (unit) {\n        n = parseFloat(r.substring(0, r.length - unit[0].length)) / unit[1] * range[i];\n      } else {\n        n = parseFloat(r);\n      }\n\n      if (range[i] > 1) {\n        return Math.round(n);\n      }\n\n      return n;\n    });\n    return numbers;\n  }\n\n  var rgbRange = [255, 255, 255, 1];\n  var rgbUnits = {\n    '%': 100\n  };\n\n  function parseRGB($rgb) {\n    var _a = __read(getNumbersFromString($rgb, rgbRange, rgbUnits), 4),\n        r = _a[0],\n        g = _a[1],\n        b = _a[2],\n        _b = _a[3],\n        a = _b === void 0 ? 1 : _b;\n\n    return {\n      r: r,\n      g: g,\n      b: b,\n      a: a\n    };\n  }\n\n  var hslRange = [360, 1, 1, 1];\n  var hslUnits = {\n    '%': 100,\n    'deg': 360,\n    'rad': 2 * Math.PI,\n    'turn': 1\n  };\n\n  function parseHSL($hsl) {\n    var _a = __read(getNumbersFromString($hsl, hslRange, hslUnits), 4),\n        h = _a[0],\n        s = _a[1],\n        l = _a[2],\n        _b = _a[3],\n        a = _b === void 0 ? 1 : _b;\n\n    return hslToRGB({\n      h: h,\n      s: s,\n      l: l,\n      a: a\n    });\n  }\n\n  function parseHex($hex) {\n    var h = $hex.substring(1);\n\n    switch (h.length) {\n      case 3:\n      case 4:\n        {\n          var _a = __read([0, 1, 2].map(function (i) {\n            return parseInt(\"\" + h[i] + h[i], 16);\n          }), 3),\n              r = _a[0],\n              g = _a[1],\n              b = _a[2];\n\n          var a = h.length === 3 ? 1 : parseInt(\"\" + h[3] + h[3], 16) / 255;\n          return {\n            r: r,\n            g: g,\n            b: b,\n            a: a\n          };\n        }\n\n      case 6:\n      case 8:\n        {\n          var _b = __read([0, 2, 4].map(function (i) {\n            return parseInt(h.substring(i, i + 2), 16);\n          }), 3),\n              r = _b[0],\n              g = _b[1],\n              b = _b[2];\n\n          var a = h.length === 6 ? 1 : parseInt(h.substring(6, 8), 16) / 255;\n          return {\n            r: r,\n            g: g,\n            b: b,\n            a: a\n          };\n        }\n    }\n\n    throw new Error(\"Unable to parse \" + $hex);\n  }\n\n  function getColorByName($color) {\n    var n = knownColors.get($color);\n    return {\n      r: n >> 16 & 255,\n      g: n >> 8 & 255,\n      b: n >> 0 & 255,\n      a: 1\n    };\n  }\n\n  function getSystemColor($color) {\n    var n = systemColors.get($color);\n    return {\n      r: n >> 16 & 255,\n      g: n >> 8 & 255,\n      b: n >> 0 & 255,\n      a: 1\n    };\n  }\n\n  var isCharDigit = function (char) {\n    return char >= '0' && char <= '9';\n  };\n\n  var getAmountOfDigits = function (number) {\n    return Math.floor(Math.log10(number)) + 1;\n  };\n\n  function lowerCalcExpression(color) {\n    var searchIndex = 0;\n\n    var replaceBetweenIndices = function (start, end, replacement) {\n      color = color.substring(0, start) + replacement + color.substring(end);\n    };\n\n    var getNumber = function () {\n      var resultNumber = 0;\n\n      for (var i = 1; i < 4; i++) {\n        var char = color[searchIndex + i];\n\n        if (char === ' ') {\n          break;\n        }\n\n        if (isCharDigit(char)) {\n          resultNumber *= 10;\n          resultNumber += Number(char);\n        } else {\n          break;\n        }\n      }\n\n      var lenDigits = getAmountOfDigits(resultNumber);\n      searchIndex += lenDigits;\n      var possibleType = color[searchIndex + 1];\n\n      if (possibleType !== '%') {\n        return;\n      }\n\n      searchIndex++;\n      return resultNumber;\n    };\n\n    while ((searchIndex = color.indexOf('calc(')) !== 0) {\n      var startIndex = searchIndex;\n      searchIndex += 4;\n      var firstNumber = getNumber();\n\n      if (!firstNumber) {\n        break;\n      }\n\n      if (color[searchIndex + 1] !== ' ') {\n        break;\n      }\n\n      searchIndex++;\n      var operation = color[searchIndex + 1];\n\n      if (operation !== '+' && operation !== '-') {\n        break;\n      }\n\n      searchIndex++;\n\n      if (color[searchIndex + 1] !== ' ') {\n        break;\n      }\n\n      searchIndex++;\n      var secondNumber = getNumber();\n\n      if (!secondNumber) {\n        break;\n      }\n\n      var replacement = void 0;\n\n      if (operation === '+') {\n        replacement = firstNumber + secondNumber + \"%\";\n      } else {\n        replacement = firstNumber - secondNumber + \"%\";\n      }\n\n      replaceBetweenIndices(startIndex, searchIndex + 2, replacement);\n    }\n\n    return color;\n  }\n\n  var knownColors = new Map(Object.entries({\n    aliceblue: 0xf0f8ff,\n    antiquewhite: 0xfaebd7,\n    aqua: 0x00ffff,\n    aquamarine: 0x7fffd4,\n    azure: 0xf0ffff,\n    beige: 0xf5f5dc,\n    bisque: 0xffe4c4,\n    black: 0x000000,\n    blanchedalmond: 0xffebcd,\n    blue: 0x0000ff,\n    blueviolet: 0x8a2be2,\n    brown: 0xa52a2a,\n    burlywood: 0xdeb887,\n    cadetblue: 0x5f9ea0,\n    chartreuse: 0x7fff00,\n    chocolate: 0xd2691e,\n    coral: 0xff7f50,\n    cornflowerblue: 0x6495ed,\n    cornsilk: 0xfff8dc,\n    crimson: 0xdc143c,\n    cyan: 0x00ffff,\n    darkblue: 0x00008b,\n    darkcyan: 0x008b8b,\n    darkgoldenrod: 0xb8860b,\n    darkgray: 0xa9a9a9,\n    darkgrey: 0xa9a9a9,\n    darkgreen: 0x006400,\n    darkkhaki: 0xbdb76b,\n    darkmagenta: 0x8b008b,\n    darkolivegreen: 0x556b2f,\n    darkorange: 0xff8c00,\n    darkorchid: 0x9932cc,\n    darkred: 0x8b0000,\n    darksalmon: 0xe9967a,\n    darkseagreen: 0x8fbc8f,\n    darkslateblue: 0x483d8b,\n    darkslategray: 0x2f4f4f,\n    darkslategrey: 0x2f4f4f,\n    darkturquoise: 0x00ced1,\n    darkviolet: 0x9400d3,\n    deeppink: 0xff1493,\n    deepskyblue: 0x00bfff,\n    dimgray: 0x696969,\n    dimgrey: 0x696969,\n    dodgerblue: 0x1e90ff,\n    firebrick: 0xb22222,\n    floralwhite: 0xfffaf0,\n    forestgreen: 0x228b22,\n    fuchsia: 0xff00ff,\n    gainsboro: 0xdcdcdc,\n    ghostwhite: 0xf8f8ff,\n    gold: 0xffd700,\n    goldenrod: 0xdaa520,\n    gray: 0x808080,\n    grey: 0x808080,\n    green: 0x008000,\n    greenyellow: 0xadff2f,\n    honeydew: 0xf0fff0,\n    hotpink: 0xff69b4,\n    indianred: 0xcd5c5c,\n    indigo: 0x4b0082,\n    ivory: 0xfffff0,\n    khaki: 0xf0e68c,\n    lavender: 0xe6e6fa,\n    lavenderblush: 0xfff0f5,\n    lawngreen: 0x7cfc00,\n    lemonchiffon: 0xfffacd,\n    lightblue: 0xadd8e6,\n    lightcoral: 0xf08080,\n    lightcyan: 0xe0ffff,\n    lightgoldenrodyellow: 0xfafad2,\n    lightgray: 0xd3d3d3,\n    lightgrey: 0xd3d3d3,\n    lightgreen: 0x90ee90,\n    lightpink: 0xffb6c1,\n    lightsalmon: 0xffa07a,\n    lightseagreen: 0x20b2aa,\n    lightskyblue: 0x87cefa,\n    lightslategray: 0x778899,\n    lightslategrey: 0x778899,\n    lightsteelblue: 0xb0c4de,\n    lightyellow: 0xffffe0,\n    lime: 0x00ff00,\n    limegreen: 0x32cd32,\n    linen: 0xfaf0e6,\n    magenta: 0xff00ff,\n    maroon: 0x800000,\n    mediumaquamarine: 0x66cdaa,\n    mediumblue: 0x0000cd,\n    mediumorchid: 0xba55d3,\n    mediumpurple: 0x9370db,\n    mediumseagreen: 0x3cb371,\n    mediumslateblue: 0x7b68ee,\n    mediumspringgreen: 0x00fa9a,\n    mediumturquoise: 0x48d1cc,\n    mediumvioletred: 0xc71585,\n    midnightblue: 0x191970,\n    mintcream: 0xf5fffa,\n    mistyrose: 0xffe4e1,\n    moccasin: 0xffe4b5,\n    navajowhite: 0xffdead,\n    navy: 0x000080,\n    oldlace: 0xfdf5e6,\n    olive: 0x808000,\n    olivedrab: 0x6b8e23,\n    orange: 0xffa500,\n    orangered: 0xff4500,\n    orchid: 0xda70d6,\n    palegoldenrod: 0xeee8aa,\n    palegreen: 0x98fb98,\n    paleturquoise: 0xafeeee,\n    palevioletred: 0xdb7093,\n    papayawhip: 0xffefd5,\n    peachpuff: 0xffdab9,\n    peru: 0xcd853f,\n    pink: 0xffc0cb,\n    plum: 0xdda0dd,\n    powderblue: 0xb0e0e6,\n    purple: 0x800080,\n    rebeccapurple: 0x663399,\n    red: 0xff0000,\n    rosybrown: 0xbc8f8f,\n    royalblue: 0x4169e1,\n    saddlebrown: 0x8b4513,\n    salmon: 0xfa8072,\n    sandybrown: 0xf4a460,\n    seagreen: 0x2e8b57,\n    seashell: 0xfff5ee,\n    sienna: 0xa0522d,\n    silver: 0xc0c0c0,\n    skyblue: 0x87ceeb,\n    slateblue: 0x6a5acd,\n    slategray: 0x708090,\n    slategrey: 0x708090,\n    snow: 0xfffafa,\n    springgreen: 0x00ff7f,\n    steelblue: 0x4682b4,\n    tan: 0xd2b48c,\n    teal: 0x008080,\n    thistle: 0xd8bfd8,\n    tomato: 0xff6347,\n    turquoise: 0x40e0d0,\n    violet: 0xee82ee,\n    wheat: 0xf5deb3,\n    white: 0xffffff,\n    whitesmoke: 0xf5f5f5,\n    yellow: 0xffff00,\n    yellowgreen: 0x9acd32\n  }));\n  var systemColors = new Map(Object.entries({\n    ActiveBorder: 0x3b99fc,\n    ActiveCaption: 0x000000,\n    AppWorkspace: 0xaaaaaa,\n    Background: 0x6363ce,\n    ButtonFace: 0xffffff,\n    ButtonHighlight: 0xe9e9e9,\n    ButtonShadow: 0x9fa09f,\n    ButtonText: 0x000000,\n    CaptionText: 0x000000,\n    GrayText: 0x7f7f7f,\n    Highlight: 0xb2d7ff,\n    HighlightText: 0x000000,\n    InactiveBorder: 0xffffff,\n    InactiveCaption: 0xffffff,\n    InactiveCaptionText: 0x000000,\n    InfoBackground: 0xfbfcc5,\n    InfoText: 0x000000,\n    Menu: 0xf6f6f6,\n    MenuText: 0xffffff,\n    Scrollbar: 0xaaaaaa,\n    ThreeDDarkShadow: 0x000000,\n    ThreeDFace: 0xc0c0c0,\n    ThreeDHighlight: 0xffffff,\n    ThreeDLightShadow: 0xffffff,\n    ThreeDShadow: 0x000000,\n    Window: 0xececec,\n    WindowFrame: 0xaaaaaa,\n    WindowText: 0x000000,\n    '-webkit-focus-ring-color': 0xe59700\n  }).map(function (_a) {\n    var _b = __read(_a, 2),\n        key = _b[0],\n        value = _b[1];\n\n    return [key.toLowerCase(), value];\n  }));\n\n  function scale(x, inLow, inHigh, outLow, outHigh) {\n    return (x - inLow) * (outHigh - outLow) / (inHigh - inLow) + outLow;\n  }\n\n  function clamp(x, min, max) {\n    return Math.min(max, Math.max(min, x));\n  }\n\n  function multiplyMatrices(m1, m2) {\n    var result = [];\n\n    for (var i = 0, len = m1.length; i < len; i++) {\n      result[i] = [];\n\n      for (var j = 0, len2 = m2[0].length; j < len2; j++) {\n        var sum = 0;\n\n        for (var k = 0, len3 = m1[0].length; k < len3; k++) {\n          sum += m1[i][k] * m2[k][j];\n        }\n\n        result[i][j] = sum;\n      }\n    }\n\n    return result;\n  }\n\n  function getMatches(regex, input, group) {\n    if (group === void 0) {\n      group = 0;\n    }\n\n    var matches = [];\n    var m;\n\n    while (m = regex.exec(input)) {\n      matches.push(m[group]);\n    }\n\n    return matches;\n  }\n\n  function formatCSS(text) {\n    function trimLeft(text) {\n      return text.replace(/^\\s+/, '');\n    }\n\n    function getIndent(depth) {\n      if (depth === 0) {\n        return '';\n      }\n\n      return ' '.repeat(4 * depth);\n    }\n\n    if (text.length < 50000) {\n      var emptyRuleRegexp = /[^{}]+{\\s*}/;\n\n      while (emptyRuleRegexp.test(text)) {\n        text = text.replace(emptyRuleRegexp, '');\n      }\n    }\n\n    var css = text.replace(/\\s{2,}/g, ' ').replace(/\\{/g, '{\\n').replace(/\\}/g, '\\n}\\n').replace(/\\;(?![^\\(|\\\"]*(\\)|\\\"))/g, ';\\n').replace(/\\,(?![^\\(|\\\"]*(\\)|\\\"))/g, ',\\n').replace(/\\n\\s*\\n/g, '\\n').split('\\n');\n    var depth = 0;\n    var formatted = [];\n\n    for (var x = 0, len = css.length; x < len; x++) {\n      var line = css[x] + \"\\n\";\n\n      if (line.includes('{')) {\n        formatted.push(getIndent(depth++) + trimLeft(line));\n      } else if (line.includes('\\}')) {\n        formatted.push(getIndent(--depth) + trimLeft(line));\n      } else {\n        formatted.push(getIndent(depth) + trimLeft(line));\n      }\n    }\n\n    return formatted.join('').trim();\n  }\n\n  function getParenthesesRange(input, searchStartIndex) {\n    if (searchStartIndex === void 0) {\n      searchStartIndex = 0;\n    }\n\n    var length = input.length;\n    var depth = 0;\n    var firstOpenIndex = -1;\n\n    for (var i = searchStartIndex; i < length; i++) {\n      if (depth === 0) {\n        var openIndex = input.indexOf('(', i);\n\n        if (openIndex < 0) {\n          break;\n        }\n\n        firstOpenIndex = openIndex;\n        depth++;\n        i = openIndex;\n      } else {\n        var closingIndex = input.indexOf(')', i);\n\n        if (closingIndex < 0) {\n          break;\n        }\n\n        var openIndex = input.indexOf('(', i);\n\n        if (openIndex < 0 || closingIndex < openIndex) {\n          depth--;\n\n          if (depth === 0) {\n            return {\n              start: firstOpenIndex,\n              end: closingIndex + 1\n            };\n          }\n\n          i = closingIndex;\n        } else {\n          depth++;\n          i = openIndex;\n        }\n      }\n    }\n\n    return null;\n  }\n\n  function createFilterMatrix(config) {\n    var m = Matrix.identity();\n\n    if (config.sepia !== 0) {\n      m = multiplyMatrices(m, Matrix.sepia(config.sepia / 100));\n    }\n\n    if (config.grayscale !== 0) {\n      m = multiplyMatrices(m, Matrix.grayscale(config.grayscale / 100));\n    }\n\n    if (config.contrast !== 100) {\n      m = multiplyMatrices(m, Matrix.contrast(config.contrast / 100));\n    }\n\n    if (config.brightness !== 100) {\n      m = multiplyMatrices(m, Matrix.brightness(config.brightness / 100));\n    }\n\n    if (config.mode === 1) {\n      m = multiplyMatrices(m, Matrix.invertNHue());\n    }\n\n    return m;\n  }\n\n  function applyColorMatrix(_a, matrix) {\n    var _b = __read(_a, 3),\n        r = _b[0],\n        g = _b[1],\n        b = _b[2];\n\n    var rgb = [[r / 255], [g / 255], [b / 255], [1], [1]];\n    var result = multiplyMatrices(matrix, rgb);\n    return [0, 1, 2].map(function (i) {\n      return clamp(Math.round(result[i][0] * 255), 0, 255);\n    });\n  }\n\n  var Matrix = {\n    identity: function () {\n      return [[1, 0, 0, 0, 0], [0, 1, 0, 0, 0], [0, 0, 1, 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    },\n    invertNHue: function () {\n      return [[0.333, -0.667, -0.667, 0, 1], [-0.667, 0.333, -0.667, 0, 1], [-0.667, -0.667, 0.333, 0, 1], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    },\n    brightness: function (v) {\n      return [[v, 0, 0, 0, 0], [0, v, 0, 0, 0], [0, 0, v, 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    },\n    contrast: function (v) {\n      var t = (1 - v) / 2;\n      return [[v, 0, 0, 0, t], [0, v, 0, 0, t], [0, 0, v, 0, t], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    },\n    sepia: function (v) {\n      return [[0.393 + 0.607 * (1 - v), 0.769 - 0.769 * (1 - v), 0.189 - 0.189 * (1 - v), 0, 0], [0.349 - 0.349 * (1 - v), 0.686 + 0.314 * (1 - v), 0.168 - 0.168 * (1 - v), 0, 0], [0.272 - 0.272 * (1 - v), 0.534 - 0.534 * (1 - v), 0.131 + 0.869 * (1 - v), 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    },\n    grayscale: function (v) {\n      return [[0.2126 + 0.7874 * (1 - v), 0.7152 - 0.7152 * (1 - v), 0.0722 - 0.0722 * (1 - v), 0, 0], [0.2126 - 0.2126 * (1 - v), 0.7152 + 0.2848 * (1 - v), 0.0722 - 0.0722 * (1 - v), 0, 0], [0.2126 - 0.2126 * (1 - v), 0.7152 - 0.7152 * (1 - v), 0.0722 + 0.9278 * (1 - v), 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    }\n  };\n\n  function getBgPole(theme) {\n    var isDarkScheme = theme.mode === 1;\n    var prop = isDarkScheme ? 'darkSchemeBackgroundColor' : 'lightSchemeBackgroundColor';\n    return theme[prop];\n  }\n\n  function getFgPole(theme) {\n    var isDarkScheme = theme.mode === 1;\n    var prop = isDarkScheme ? 'darkSchemeTextColor' : 'lightSchemeTextColor';\n    return theme[prop];\n  }\n\n  var colorModificationCache = new Map();\n  var colorParseCache$1 = new Map();\n\n  function parseToHSLWithCache(color) {\n    if (colorParseCache$1.has(color)) {\n      return colorParseCache$1.get(color);\n    }\n\n    var rgb = parse(color);\n    var hsl = rgbToHSL(rgb);\n    colorParseCache$1.set(color, hsl);\n    return hsl;\n  }\n\n  function clearColorModificationCache() {\n    colorModificationCache.clear();\n    colorParseCache$1.clear();\n  }\n\n  var rgbCacheKeys = ['r', 'g', 'b', 'a'];\n  var themeCacheKeys$1 = ['mode', 'brightness', 'contrast', 'grayscale', 'sepia', 'darkSchemeBackgroundColor', 'darkSchemeTextColor', 'lightSchemeBackgroundColor', 'lightSchemeTextColor'];\n\n  function getCacheId(rgb, theme) {\n    var resultId = '';\n    rgbCacheKeys.forEach(function (key) {\n      resultId += rgb[key] + \";\";\n    });\n    themeCacheKeys$1.forEach(function (key) {\n      resultId += theme[key] + \";\";\n    });\n    return resultId;\n  }\n\n  function modifyColorWithCache(rgb, theme, modifyHSL, poleColor, anotherPoleColor) {\n    var fnCache;\n\n    if (colorModificationCache.has(modifyHSL)) {\n      fnCache = colorModificationCache.get(modifyHSL);\n    } else {\n      fnCache = new Map();\n      colorModificationCache.set(modifyHSL, fnCache);\n    }\n\n    var id = getCacheId(rgb, theme);\n\n    if (fnCache.has(id)) {\n      return fnCache.get(id);\n    }\n\n    var hsl = rgbToHSL(rgb);\n    var pole = poleColor == null ? null : parseToHSLWithCache(poleColor);\n    var anotherPole = anotherPoleColor == null ? null : parseToHSLWithCache(anotherPoleColor);\n    var modified = modifyHSL(hsl, pole, anotherPole);\n\n    var _a = hslToRGB(modified),\n        r = _a.r,\n        g = _a.g,\n        b = _a.b,\n        a = _a.a;\n\n    var matrix = createFilterMatrix(theme);\n\n    var _b = __read(applyColorMatrix([r, g, b], matrix), 3),\n        rf = _b[0],\n        gf = _b[1],\n        bf = _b[2];\n\n    var color = a === 1 ? rgbToHexString({\n      r: rf,\n      g: gf,\n      b: bf\n    }) : rgbToString({\n      r: rf,\n      g: gf,\n      b: bf,\n      a: a\n    });\n    fnCache.set(id, color);\n    return color;\n  }\n\n  function noopHSL(hsl) {\n    return hsl;\n  }\n\n  function modifyColor(rgb, theme) {\n    return modifyColorWithCache(rgb, theme, noopHSL);\n  }\n\n  function modifyLightSchemeColor(rgb, theme) {\n    var poleBg = getBgPole(theme);\n    var poleFg = getFgPole(theme);\n    return modifyColorWithCache(rgb, theme, modifyLightModeHSL, poleFg, poleBg);\n  }\n\n  function modifyLightModeHSL(_a, poleFg, poleBg) {\n    var h = _a.h,\n        s = _a.s,\n        l = _a.l,\n        a = _a.a;\n    var isDark = l < 0.5;\n    var isNeutral;\n\n    if (isDark) {\n      isNeutral = l < 0.2 || s < 0.12;\n    } else {\n      var isBlue = h > 200 && h < 280;\n      isNeutral = s < 0.24 || l > 0.8 && isBlue;\n    }\n\n    var hx = h;\n    var sx = l;\n\n    if (isNeutral) {\n      if (isDark) {\n        hx = poleFg.h;\n        sx = poleFg.s;\n      } else {\n        hx = poleBg.h;\n        sx = poleBg.s;\n      }\n    }\n\n    var lx = scale(l, 0, 1, poleFg.l, poleBg.l);\n    return {\n      h: hx,\n      s: sx,\n      l: lx,\n      a: a\n    };\n  }\n\n  var MAX_BG_LIGHTNESS = 0.4;\n\n  function modifyBgHSL(_a, pole) {\n    var h = _a.h,\n        s = _a.s,\n        l = _a.l,\n        a = _a.a;\n    var isDark = l < 0.5;\n    var isBlue = h > 200 && h < 280;\n    var isNeutral = s < 0.12 || l > 0.8 && isBlue;\n\n    if (isDark) {\n      var lx_1 = scale(l, 0, 0.5, 0, MAX_BG_LIGHTNESS);\n\n      if (isNeutral) {\n        var hx_1 = pole.h;\n        var sx = pole.s;\n        return {\n          h: hx_1,\n          s: sx,\n          l: lx_1,\n          a: a\n        };\n      }\n\n      return {\n        h: h,\n        s: s,\n        l: lx_1,\n        a: a\n      };\n    }\n\n    var lx = scale(l, 0.5, 1, MAX_BG_LIGHTNESS, pole.l);\n\n    if (isNeutral) {\n      var hx_2 = pole.h;\n      var sx = pole.s;\n      return {\n        h: hx_2,\n        s: sx,\n        l: lx,\n        a: a\n      };\n    }\n\n    var hx = h;\n    var isYellow = h > 60 && h < 180;\n\n    if (isYellow) {\n      var isCloserToGreen = h > 120;\n\n      if (isCloserToGreen) {\n        hx = scale(h, 120, 180, 135, 180);\n      } else {\n        hx = scale(h, 60, 120, 60, 105);\n      }\n    }\n\n    return {\n      h: hx,\n      s: s,\n      l: lx,\n      a: a\n    };\n  }\n\n  function modifyBackgroundColor(rgb, theme) {\n    if (theme.mode === 0) {\n      return modifyLightSchemeColor(rgb, theme);\n    }\n\n    var pole = getBgPole(theme);\n    return modifyColorWithCache(rgb, __assign(__assign({}, theme), {\n      mode: 0\n    }), modifyBgHSL, pole);\n  }\n\n  var MIN_FG_LIGHTNESS = 0.55;\n\n  function modifyBlueFgHue(hue) {\n    return scale(hue, 205, 245, 205, 220);\n  }\n\n  function modifyFgHSL(_a, pole) {\n    var h = _a.h,\n        s = _a.s,\n        l = _a.l,\n        a = _a.a;\n    var isLight = l > 0.5;\n    var isNeutral = l < 0.2 || s < 0.24;\n    var isBlue = !isNeutral && h > 205 && h < 245;\n\n    if (isLight) {\n      var lx_2 = scale(l, 0.5, 1, MIN_FG_LIGHTNESS, pole.l);\n\n      if (isNeutral) {\n        var hx_3 = pole.h;\n        var sx = pole.s;\n        return {\n          h: hx_3,\n          s: sx,\n          l: lx_2,\n          a: a\n        };\n      }\n\n      var hx_4 = h;\n\n      if (isBlue) {\n        hx_4 = modifyBlueFgHue(h);\n      }\n\n      return {\n        h: hx_4,\n        s: s,\n        l: lx_2,\n        a: a\n      };\n    }\n\n    if (isNeutral) {\n      var hx_5 = pole.h;\n      var sx = pole.s;\n      var lx_3 = scale(l, 0, 0.5, pole.l, MIN_FG_LIGHTNESS);\n      return {\n        h: hx_5,\n        s: sx,\n        l: lx_3,\n        a: a\n      };\n    }\n\n    var hx = h;\n    var lx;\n\n    if (isBlue) {\n      hx = modifyBlueFgHue(h);\n      lx = scale(l, 0, 0.5, pole.l, Math.min(1, MIN_FG_LIGHTNESS + 0.05));\n    } else {\n      lx = scale(l, 0, 0.5, pole.l, MIN_FG_LIGHTNESS);\n    }\n\n    return {\n      h: hx,\n      s: s,\n      l: lx,\n      a: a\n    };\n  }\n\n  function modifyForegroundColor(rgb, theme) {\n    if (theme.mode === 0) {\n      return modifyLightSchemeColor(rgb, theme);\n    }\n\n    var pole = getFgPole(theme);\n    return modifyColorWithCache(rgb, __assign(__assign({}, theme), {\n      mode: 0\n    }), modifyFgHSL, pole);\n  }\n\n  function modifyBorderHSL(_a, poleFg, poleBg) {\n    var h = _a.h,\n        s = _a.s,\n        l = _a.l,\n        a = _a.a;\n    var isDark = l < 0.5;\n    var isNeutral = l < 0.2 || s < 0.24;\n    var hx = h;\n    var sx = s;\n\n    if (isNeutral) {\n      if (isDark) {\n        hx = poleFg.h;\n        sx = poleFg.s;\n      } else {\n        hx = poleBg.h;\n        sx = poleBg.s;\n      }\n    }\n\n    var lx = scale(l, 0, 1, 0.5, 0.2);\n    return {\n      h: hx,\n      s: sx,\n      l: lx,\n      a: a\n    };\n  }\n\n  function modifyBorderColor(rgb, theme) {\n    if (theme.mode === 0) {\n      return modifyLightSchemeColor(rgb, theme);\n    }\n\n    var poleFg = getFgPole(theme);\n    var poleBg = getBgPole(theme);\n    return modifyColorWithCache(rgb, __assign(__assign({}, theme), {\n      mode: 0\n    }), modifyBorderHSL, poleFg, poleBg);\n  }\n\n  function modifyShadowColor(rgb, filter) {\n    return modifyBackgroundColor(rgb, filter);\n  }\n\n  function modifyGradientColor(rgb, filter) {\n    return modifyBackgroundColor(rgb, filter);\n  }\n\n  function createTextStyle(config) {\n    var lines = [];\n    lines.push('*:not(pre, pre *, code, .far, .fa, .glyphicon, [class*=\"vjs-\"], .fab, .fa-github, .fas, .material-icons, .icofont, .typcn, mu, [class*=\"mu-\"], .glyphicon, .icon) {');\n\n    if (config.useFont && config.fontFamily) {\n      lines.push(\"  font-family: \" + config.fontFamily + \" !important;\");\n    }\n\n    if (config.textStroke > 0) {\n      lines.push(\"  -webkit-text-stroke: \" + config.textStroke + \"px !important;\");\n      lines.push(\"  text-stroke: \" + config.textStroke + \"px !important;\");\n    }\n\n    lines.push('}');\n    return lines.join('\\n');\n  }\n\n  var FilterMode;\n\n  (function (FilterMode) {\n    FilterMode[FilterMode[\"light\"] = 0] = \"light\";\n    FilterMode[FilterMode[\"dark\"] = 1] = \"dark\";\n  })(FilterMode || (FilterMode = {}));\n\n  function getCSSFilterValue(config) {\n    var filters = [];\n\n    if (config.mode === FilterMode.dark) {\n      filters.push('invert(100%) hue-rotate(180deg)');\n    }\n\n    if (config.brightness !== 100) {\n      filters.push(\"brightness(\" + config.brightness + \"%)\");\n    }\n\n    if (config.contrast !== 100) {\n      filters.push(\"contrast(\" + config.contrast + \"%)\");\n    }\n\n    if (config.grayscale !== 0) {\n      filters.push(\"grayscale(\" + config.grayscale + \"%)\");\n    }\n\n    if (config.sepia !== 0) {\n      filters.push(\"sepia(\" + config.sepia + \"%)\");\n    }\n\n    if (filters.length === 0) {\n      return null;\n    }\n\n    return filters.join(' ');\n  }\n\n  function toSVGMatrix(matrix) {\n    return matrix.slice(0, 4).map(function (m) {\n      return m.map(function (m) {\n        return m.toFixed(3);\n      }).join(' ');\n    }).join(' ');\n  }\n\n  function getSVGFilterMatrixValue(config) {\n    return toSVGMatrix(createFilterMatrix(config));\n  }\n\n  var counter = 0;\n  var resolvers$1 = new Map();\n  var rejectors = new Map();\n\n  function bgFetch(request) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2, new Promise(function (resolve, reject) {\n          var id = ++counter;\n          resolvers$1.set(id, resolve);\n          rejectors.set(id, reject);\n\n          if (typeof chrome !== 'undefined') {\n            chrome.runtime.sendMessage({\n              type: MessageType.CS_FETCH,\n              data: request,\n              id: id\n            });\n          }\n        })];\n      });\n    });\n  }\n\n  if (typeof chrome !== 'undefined') {\n    chrome.runtime.onMessage.addListener(function (_a) {\n      var type = _a.type,\n          data = _a.data,\n          error = _a.error,\n          id = _a.id;\n\n      if (type === MessageType.BG_FETCH_RESPONSE) {\n        var resolve = resolvers$1.get(id);\n        var reject = rejectors.get(id);\n        resolvers$1.delete(id);\n        rejectors.delete(id);\n\n        if (error) {\n          reject && reject(error);\n        } else {\n          resolve && resolve(data);\n        }\n      }\n    });\n  }\n\n  var AsyncQueue = function () {\n    function AsyncQueue() {\n      this.queue = [];\n      this.timerId = null;\n      this.frameDuration = 1000 / 60;\n    }\n\n    AsyncQueue.prototype.addToQueue = function (entry) {\n      this.queue.push(entry);\n      this.startQueue();\n    };\n\n    AsyncQueue.prototype.stopQueue = function () {\n      if (this.timerId !== null) {\n        cancelAnimationFrame(this.timerId);\n        this.timerId = null;\n      }\n\n      this.queue = [];\n    };\n\n    AsyncQueue.prototype.startQueue = function () {\n      var _this = this;\n\n      if (this.timerId) {\n        return;\n      }\n\n      this.timerId = requestAnimationFrame(function () {\n        _this.timerId = null;\n        var start = Date.now();\n        var cb;\n\n        while (cb = _this.queue.shift()) {\n          cb();\n\n          if (Date.now() - start >= _this.frameDuration) {\n            _this.startQueue();\n\n            break;\n          }\n        }\n      });\n    };\n\n    return AsyncQueue;\n  }();\n\n  var imageManager = new AsyncQueue();\n\n  function getImageDetails(url) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _this = this;\n\n      return __generator(this, function (_a) {\n        return [2, new Promise(function (resolve, reject) {\n          return __awaiter(_this, void 0, void 0, function () {\n            var dataURL, error_1, image_1, error_2;\n            return __generator(this, function (_a) {\n              switch (_a.label) {\n                case 0:\n                  if (!url.startsWith('data:')) return [3, 1];\n                  dataURL = url;\n                  return [3, 4];\n\n                case 1:\n                  _a.trys.push([1, 3,, 4]);\n\n                  return [4, getImageDataURL(url)];\n\n                case 2:\n                  dataURL = _a.sent();\n                  return [3, 4];\n\n                case 3:\n                  error_1 = _a.sent();\n                  reject(error_1);\n                  return [2];\n\n                case 4:\n                  _a.trys.push([4, 6,, 7]);\n\n                  return [4, urlToImage(dataURL)];\n\n                case 5:\n                  image_1 = _a.sent();\n                  imageManager.addToQueue(function () {\n                    resolve(__assign({\n                      src: url,\n                      dataURL: dataURL,\n                      width: image_1.naturalWidth,\n                      height: image_1.naturalHeight\n                    }, analyzeImage(image_1)));\n                  });\n                  return [3, 7];\n\n                case 6:\n                  error_2 = _a.sent();\n                  reject(error_2);\n                  return [3, 7];\n\n                case 7:\n                  return [2];\n              }\n            });\n          });\n        })];\n      });\n    });\n  }\n\n  function getImageDataURL(url) {\n    return __awaiter(this, void 0, void 0, function () {\n      var parsedURL;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            parsedURL = new URL(url);\n            if (!(parsedURL.origin === location.origin)) return [3, 2];\n            return [4, loadAsDataURL(url)];\n\n          case 1:\n            return [2, _a.sent()];\n\n          case 2:\n            return [4, bgFetch({\n              url: url,\n              responseType: 'data-url'\n            })];\n\n          case 3:\n            return [2, _a.sent()];\n        }\n      });\n    });\n  }\n\n  function urlToImage(url) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2, new Promise(function (resolve, reject) {\n          var image = new Image();\n\n          image.onload = function () {\n            return resolve(image);\n          };\n\n          image.onerror = function () {\n            return reject(\"Unable to load image \" + url);\n          };\n\n          image.src = url;\n        })];\n      });\n    });\n  }\n\n  var MAX_ANALIZE_PIXELS_COUNT = 32 * 32;\n  var canvas;\n  var context;\n\n  function createCanvas() {\n    var maxWidth = MAX_ANALIZE_PIXELS_COUNT;\n    var maxHeight = MAX_ANALIZE_PIXELS_COUNT;\n    canvas = document.createElement('canvas');\n    canvas.width = maxWidth;\n    canvas.height = maxHeight;\n    context = canvas.getContext('2d');\n    context.imageSmoothingEnabled = false;\n  }\n\n  function removeCanvas() {\n    canvas = null;\n    context = null;\n  }\n\n  var MAX_IMAGE_SIZE = 5 * 1024 * 1024;\n\n  function analyzeImage(image) {\n    if (!canvas) {\n      createCanvas();\n    }\n\n    var naturalWidth = image.naturalWidth,\n        naturalHeight = image.naturalHeight;\n\n    if (naturalHeight === 0 || naturalWidth === 0) {\n      logWarn(\"logWarn(Image is empty \" + image.currentSrc + \")\");\n      return null;\n    }\n\n    var size = naturalWidth * naturalHeight * 4;\n\n    if (size > MAX_IMAGE_SIZE) {\n      logInfo('Skipped large image analyzing(Larger than 5mb in memory)');\n      return {\n        isDark: false,\n        isLight: false,\n        isTransparent: false,\n        isLarge: false,\n        isTooLarge: true\n      };\n    }\n\n    var naturalPixelsCount = naturalWidth * naturalHeight;\n    var k = Math.min(1, Math.sqrt(MAX_ANALIZE_PIXELS_COUNT / naturalPixelsCount));\n    var width = Math.ceil(naturalWidth * k);\n    var height = Math.ceil(naturalHeight * k);\n    context.clearRect(0, 0, width, height);\n    context.drawImage(image, 0, 0, naturalWidth, naturalHeight, 0, 0, width, height);\n    var imageData = context.getImageData(0, 0, width, height);\n    var d = imageData.data;\n    var TRANSPARENT_ALPHA_THRESHOLD = 0.05;\n    var DARK_LIGHTNESS_THRESHOLD = 0.4;\n    var LIGHT_LIGHTNESS_THRESHOLD = 0.7;\n    var transparentPixelsCount = 0;\n    var darkPixelsCount = 0;\n    var lightPixelsCount = 0;\n    var i, x, y;\n    var r, g, b, a;\n    var l;\n\n    for (y = 0; y < height; y++) {\n      for (x = 0; x < width; x++) {\n        i = 4 * (y * width + x);\n        r = d[i + 0] / 255;\n        g = d[i + 1] / 255;\n        b = d[i + 2] / 255;\n        a = d[i + 3] / 255;\n\n        if (a < TRANSPARENT_ALPHA_THRESHOLD) {\n          transparentPixelsCount++;\n        } else {\n          l = 0.2126 * r + 0.7152 * g + 0.0722 * b;\n\n          if (l < DARK_LIGHTNESS_THRESHOLD) {\n            darkPixelsCount++;\n          }\n\n          if (l > LIGHT_LIGHTNESS_THRESHOLD) {\n            lightPixelsCount++;\n          }\n        }\n      }\n    }\n\n    var totalPixelsCount = width * height;\n    var opaquePixelsCount = totalPixelsCount - transparentPixelsCount;\n    var DARK_IMAGE_THRESHOLD = 0.7;\n    var LIGHT_IMAGE_THRESHOLD = 0.7;\n    var TRANSPARENT_IMAGE_THRESHOLD = 0.1;\n    var LARGE_IMAGE_PIXELS_COUNT = 800 * 600;\n    return {\n      isDark: darkPixelsCount / opaquePixelsCount >= DARK_IMAGE_THRESHOLD,\n      isLight: lightPixelsCount / opaquePixelsCount >= LIGHT_IMAGE_THRESHOLD,\n      isTransparent: transparentPixelsCount / totalPixelsCount >= TRANSPARENT_IMAGE_THRESHOLD,\n      isLarge: naturalPixelsCount >= LARGE_IMAGE_PIXELS_COUNT,\n      isTooLarge: false\n    };\n  }\n\n  function getFilteredImageDataURL(_a, theme) {\n    var dataURL = _a.dataURL,\n        width = _a.width,\n        height = _a.height;\n    var matrix = getSVGFilterMatrixValue(theme);\n    var svg = [\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" width=\\\"\" + width + \"\\\" height=\\\"\" + height + \"\\\">\", '<defs>', '<filter id=\"darkreader-image-filter\">', \"<feColorMatrix type=\\\"matrix\\\" values=\\\"\" + matrix + \"\\\" />\", '</filter>', '</defs>', \"<image width=\\\"\" + width + \"\\\" height=\\\"\" + height + \"\\\" filter=\\\"url(#darkreader-image-filter)\\\" xlink:href=\\\"\" + dataURL + \"\\\" />\", '</svg>'].join('');\n    return \"data:image/svg+xml;base64,\" + btoa(svg);\n  }\n\n  function cleanImageProcessingCache() {\n    imageManager && imageManager.stopQueue();\n    removeCanvas();\n  }\n\n  function getPriority(ruleStyle, property) {\n    return Boolean(ruleStyle && ruleStyle.getPropertyPriority(property));\n  }\n\n  function getModifiableCSSDeclaration(property, value, rule, variablesStore, ignoreImageSelectors, isCancelled) {\n    if (property.startsWith('--')) {\n      var modifier = getVariableModifier(variablesStore, property, value, rule, ignoreImageSelectors, isCancelled);\n\n      if (modifier) {\n        return {\n          property: property,\n          value: modifier,\n          important: getPriority(rule.style, property),\n          sourceValue: value\n        };\n      }\n    } else if (value.includes('var(')) {\n      var modifier = getVariableDependantModifier(variablesStore, property, value);\n\n      if (modifier) {\n        return {\n          property: property,\n          value: modifier,\n          important: getPriority(rule.style, property),\n          sourceValue: value\n        };\n      }\n    } else if (property.includes('color') && property !== '-webkit-print-color-adjust' || property === 'fill' || property === 'stroke' || property === 'stop-color') {\n      var modifier = getColorModifier(property, value);\n\n      if (modifier) {\n        return {\n          property: property,\n          value: modifier,\n          important: getPriority(rule.style, property),\n          sourceValue: value\n        };\n      }\n    } else if (property === 'background-image' || property === 'list-style-image') {\n      var modifier = getBgImageModifier(value, rule, ignoreImageSelectors, isCancelled);\n\n      if (modifier) {\n        return {\n          property: property,\n          value: modifier,\n          important: getPriority(rule.style, property),\n          sourceValue: value\n        };\n      }\n    } else if (property.includes('shadow')) {\n      var modifier = getShadowModifier(value);\n\n      if (modifier) {\n        return {\n          property: property,\n          value: modifier,\n          important: getPriority(rule.style, property),\n          sourceValue: value\n        };\n      }\n    }\n\n    return null;\n  }\n\n  function getModifiedUserAgentStyle(theme, isIFrame, styleSystemControls) {\n    var lines = [];\n\n    if (!isIFrame) {\n      lines.push('html {');\n      lines.push(\"    background-color: \" + modifyBackgroundColor({\n        r: 255,\n        g: 255,\n        b: 255\n      }, theme) + \" !important;\");\n      lines.push('}');\n    }\n\n    lines.push(\"\" + (isIFrame ? '' : 'html, body, ') + (styleSystemControls ? 'input, textarea, select, button' : '') + \" {\");\n    lines.push(\"    background-color: \" + modifyBackgroundColor({\n      r: 255,\n      g: 255,\n      b: 255\n    }, theme) + \";\");\n    lines.push('}');\n    lines.push(\"html, body, \" + (styleSystemControls ? 'input, textarea, select, button' : '') + \" {\");\n    lines.push(\"    border-color: \" + modifyBorderColor({\n      r: 76,\n      g: 76,\n      b: 76\n    }, theme) + \";\");\n    lines.push(\"    color: \" + modifyForegroundColor({\n      r: 0,\n      g: 0,\n      b: 0\n    }, theme) + \";\");\n    lines.push('}');\n    lines.push('a {');\n    lines.push(\"    color: \" + modifyForegroundColor({\n      r: 0,\n      g: 64,\n      b: 255\n    }, theme) + \";\");\n    lines.push('}');\n    lines.push('table {');\n    lines.push(\"    border-color: \" + modifyBorderColor({\n      r: 128,\n      g: 128,\n      b: 128\n    }, theme) + \";\");\n    lines.push('}');\n    lines.push('::placeholder {');\n    lines.push(\"    color: \" + modifyForegroundColor({\n      r: 169,\n      g: 169,\n      b: 169\n    }, theme) + \";\");\n    lines.push('}');\n    lines.push('input:-webkit-autofill,');\n    lines.push('textarea:-webkit-autofill,');\n    lines.push('select:-webkit-autofill {');\n    lines.push(\"    background-color: \" + modifyBackgroundColor({\n      r: 250,\n      g: 255,\n      b: 189\n    }, theme) + \" !important;\");\n    lines.push(\"    color: \" + modifyForegroundColor({\n      r: 0,\n      g: 0,\n      b: 0\n    }, theme) + \" !important;\");\n    lines.push('}');\n\n    if (theme.scrollbarColor) {\n      lines.push(getModifiedScrollbarStyle(theme));\n    }\n\n    if (theme.selectionColor) {\n      lines.push(getModifiedSelectionStyle(theme));\n    }\n\n    return lines.join('\\n');\n  }\n\n  function getSelectionColor(theme) {\n    var backgroundColorSelection;\n    var foregroundColorSelection;\n\n    if (theme.selectionColor === 'auto') {\n      backgroundColorSelection = modifyBackgroundColor({\n        r: 0,\n        g: 96,\n        b: 212\n      }, __assign(__assign({}, theme), {\n        grayscale: 0\n      }));\n      foregroundColorSelection = modifyForegroundColor({\n        r: 255,\n        g: 255,\n        b: 255\n      }, __assign(__assign({}, theme), {\n        grayscale: 0\n      }));\n    } else {\n      var rgb = parse(theme.selectionColor);\n      var hsl = rgbToHSL(rgb);\n      backgroundColorSelection = theme.selectionColor;\n\n      if (hsl.l < 0.5) {\n        foregroundColorSelection = '#FFF';\n      } else {\n        foregroundColorSelection = '#000';\n      }\n    }\n\n    return {\n      backgroundColorSelection: backgroundColorSelection,\n      foregroundColorSelection: foregroundColorSelection\n    };\n  }\n\n  function getModifiedSelectionStyle(theme) {\n    var lines = [];\n    var modifiedSelectionColor = getSelectionColor(theme);\n    var backgroundColorSelection = modifiedSelectionColor.backgroundColorSelection;\n    var foregroundColorSelection = modifiedSelectionColor.foregroundColorSelection;\n    ['::selection', '::-moz-selection'].forEach(function (selection) {\n      lines.push(selection + \" {\");\n      lines.push(\"    background-color: \" + backgroundColorSelection + \" !important;\");\n      lines.push(\"    color: \" + foregroundColorSelection + \" !important;\");\n      lines.push('}');\n    });\n    return lines.join('\\n');\n  }\n\n  function getModifiedScrollbarStyle(theme) {\n    var lines = [];\n    var colorTrack;\n    var colorIcons;\n    var colorThumb;\n    var colorThumbHover;\n    var colorThumbActive;\n    var colorCorner;\n\n    if (theme.scrollbarColor === 'auto') {\n      colorTrack = modifyBackgroundColor({\n        r: 241,\n        g: 241,\n        b: 241\n      }, theme);\n      colorIcons = modifyForegroundColor({\n        r: 96,\n        g: 96,\n        b: 96\n      }, theme);\n      colorThumb = modifyBackgroundColor({\n        r: 176,\n        g: 176,\n        b: 176\n      }, theme);\n      colorThumbHover = modifyBackgroundColor({\n        r: 144,\n        g: 144,\n        b: 144\n      }, theme);\n      colorThumbActive = modifyBackgroundColor({\n        r: 96,\n        g: 96,\n        b: 96\n      }, theme);\n      colorCorner = modifyBackgroundColor({\n        r: 255,\n        g: 255,\n        b: 255\n      }, theme);\n    } else {\n      var rgb = parse(theme.scrollbarColor);\n      var hsl_1 = rgbToHSL(rgb);\n      var isLight = hsl_1.l > 0.5;\n\n      var lighten = function (lighter) {\n        return __assign(__assign({}, hsl_1), {\n          l: clamp(hsl_1.l + lighter, 0, 1)\n        });\n      };\n\n      var darken = function (darker) {\n        return __assign(__assign({}, hsl_1), {\n          l: clamp(hsl_1.l - darker, 0, 1)\n        });\n      };\n\n      colorTrack = hslToString(darken(0.4));\n      colorIcons = hslToString(isLight ? darken(0.4) : lighten(0.4));\n      colorThumb = hslToString(hsl_1);\n      colorThumbHover = hslToString(lighten(0.1));\n      colorThumbActive = hslToString(lighten(0.2));\n    }\n\n    lines.push('::-webkit-scrollbar {');\n    lines.push(\"    background-color: \" + colorTrack + \";\");\n    lines.push(\"    color: \" + colorIcons + \";\");\n    lines.push('}');\n    lines.push('::-webkit-scrollbar-thumb {');\n    lines.push(\"    background-color: \" + colorThumb + \";\");\n    lines.push('}');\n    lines.push('::-webkit-scrollbar-thumb:hover {');\n    lines.push(\"    background-color: \" + colorThumbHover + \";\");\n    lines.push('}');\n    lines.push('::-webkit-scrollbar-thumb:active {');\n    lines.push(\"    background-color: \" + colorThumbActive + \";\");\n    lines.push('}');\n    lines.push('::-webkit-scrollbar-corner {');\n    lines.push(\"    background-color: \" + colorCorner + \";\");\n    lines.push('}');\n\n    if (isFirefox) {\n      lines.push('* {');\n      lines.push(\"    scrollbar-color: \" + colorThumb + \" \" + colorTrack + \";\");\n      lines.push('}');\n    }\n\n    return lines.join('\\n');\n  }\n\n  function getModifiedFallbackStyle(filter, _a) {\n    var strict = _a.strict;\n    var lines = [];\n    var isMicrosoft = location.hostname.endsWith('microsoft.com');\n    lines.push(\"html, body, \" + (strict ? \"body :not(iframe)\" + (isMicrosoft ? ':not(div[style^=\"position:absolute;top:0;left:-\"]' : '') : 'body > :not(iframe)') + \" {\");\n    lines.push(\"    background-color: \" + modifyBackgroundColor({\n      r: 255,\n      g: 255,\n      b: 255\n    }, filter) + \" !important;\");\n    lines.push(\"    border-color: \" + modifyBorderColor({\n      r: 64,\n      g: 64,\n      b: 64\n    }, filter) + \" !important;\");\n    lines.push(\"    color: \" + modifyForegroundColor({\n      r: 0,\n      g: 0,\n      b: 0\n    }, filter) + \" !important;\");\n    lines.push('}');\n    return lines.join('\\n');\n  }\n\n  var unparsableColors = new Set(['inherit', 'transparent', 'initial', 'currentcolor', 'none', 'unset']);\n  var colorParseCache = new Map();\n\n  function parseColorWithCache($color) {\n    $color = $color.trim();\n\n    if (colorParseCache.has($color)) {\n      return colorParseCache.get($color);\n    }\n\n    if ($color.includes('calc(')) {\n      $color = lowerCalcExpression($color);\n    }\n\n    var color = parse($color);\n    colorParseCache.set($color, color);\n    return color;\n  }\n\n  function tryParseColor($color) {\n    try {\n      return parseColorWithCache($color);\n    } catch (err) {\n      return null;\n    }\n  }\n\n  function getColorModifier(prop, value) {\n    if (unparsableColors.has(value.toLowerCase())) {\n      return value;\n    }\n\n    try {\n      var rgb_1 = parseColorWithCache(value);\n\n      if (prop.includes('background')) {\n        return function (filter) {\n          return modifyBackgroundColor(rgb_1, filter);\n        };\n      }\n\n      if (prop.includes('border') || prop.includes('outline')) {\n        return function (filter) {\n          return modifyBorderColor(rgb_1, filter);\n        };\n      }\n\n      return function (filter) {\n        return modifyForegroundColor(rgb_1, filter);\n      };\n    } catch (err) {\n      logWarn('Color parse error', err);\n      return null;\n    }\n  }\n\n  var gradientRegex = /[\\-a-z]+gradient\\(([^\\(\\)]*(\\(([^\\(\\)]*(\\(.*?\\)))*[^\\(\\)]*\\))){0,15}[^\\(\\)]*\\)/g;\n  var imageDetailsCache = new Map();\n  var awaitingForImageLoading = new Map();\n\n  function shouldIgnoreImage(selectorText, selectors) {\n    if (!selectorText || selectors.length === 0) {\n      return false;\n    }\n\n    if (selectors.some(function (s) {\n      return s === '*';\n    })) {\n      return true;\n    }\n\n    var ruleSelectors = selectorText.split(/,\\s*/g);\n\n    var _loop_1 = function (i) {\n      var ignoredSelector = selectors[i];\n\n      if (ruleSelectors.some(function (s) {\n        return s === ignoredSelector;\n      })) {\n        return {\n          value: true\n        };\n      }\n    };\n\n    for (var i = 0; i < selectors.length; i++) {\n      var state_1 = _loop_1(i);\n\n      if (typeof state_1 === \"object\") return state_1.value;\n    }\n\n    return false;\n  }\n\n  function getBgImageModifier(value, rule, ignoreImageSelectors, isCancelled) {\n    var _this = this;\n\n    try {\n      var gradients = getMatches(gradientRegex, value);\n      var urls = getMatches(cssURLRegex, value);\n\n      if (urls.length === 0 && gradients.length === 0) {\n        return value;\n      }\n\n      var getIndices = function (matches) {\n        var index = 0;\n        return matches.map(function (match) {\n          var valueIndex = value.indexOf(match, index);\n          index = valueIndex + match.length;\n          return {\n            match: match,\n            index: valueIndex\n          };\n        });\n      };\n\n      var matches_1 = getIndices(urls).map(function (i) {\n        return __assign({\n          type: 'url'\n        }, i);\n      }).concat(getIndices(gradients).map(function (i) {\n        return __assign({\n          type: 'gradient'\n        }, i);\n      })).sort(function (a, b) {\n        return a.index - b.index;\n      });\n\n      var getGradientModifier_1 = function (gradient) {\n        var match = gradient.match(/^(.*-gradient)\\((.*)\\)$/);\n        var type = match[1];\n        var content = match[2];\n        var partsRegex = /([^\\(\\),]+(\\([^\\(\\)]*(\\([^\\(\\)]*\\)*[^\\(\\)]*)?\\))?[^\\(\\),]*),?/g;\n        var colorStopRegex = /^(from|color-stop|to)\\(([^\\(\\)]*?,\\s*)?(.*?)\\)$/;\n        var parts = getMatches(partsRegex, content, 1).map(function (part) {\n          part = part.trim();\n          var rgb = tryParseColor(part);\n\n          if (rgb) {\n            return function (filter) {\n              return modifyGradientColor(rgb, filter);\n            };\n          }\n\n          var space = part.lastIndexOf(' ');\n          rgb = tryParseColor(part.substring(0, space));\n\n          if (rgb) {\n            return function (filter) {\n              return modifyGradientColor(rgb, filter) + \" \" + part.substring(space + 1);\n            };\n          }\n\n          var colorStopMatch = part.match(colorStopRegex);\n\n          if (colorStopMatch) {\n            rgb = tryParseColor(colorStopMatch[3]);\n\n            if (rgb) {\n              return function (filter) {\n                return colorStopMatch[1] + \"(\" + (colorStopMatch[2] ? colorStopMatch[2] + \", \" : '') + modifyGradientColor(rgb, filter) + \")\";\n              };\n            }\n          }\n\n          return function () {\n            return part;\n          };\n        });\n        return function (filter) {\n          return type + \"(\" + parts.map(function (modify) {\n            return modify(filter);\n          }).join(', ') + \")\";\n        };\n      };\n\n      var getURLModifier_1 = function (urlValue) {\n        var _a;\n\n        if (shouldIgnoreImage(rule.selectorText, ignoreImageSelectors)) {\n          return null;\n        }\n\n        var url = getCSSURLValue(urlValue);\n        var parentStyleSheet = rule.parentStyleSheet;\n        var baseURL = parentStyleSheet && parentStyleSheet.href ? getCSSBaseBath(parentStyleSheet.href) : ((_a = parentStyleSheet.ownerNode) === null || _a === void 0 ? void 0 : _a.baseURI) || location.origin;\n        url = getAbsoluteURL(baseURL, url);\n        var absoluteValue = \"url(\\\"\" + url + \"\\\")\";\n        return function (filter) {\n          return __awaiter(_this, void 0, void 0, function () {\n            var imageDetails, awaiters_1, err_1, bgImageValue;\n            return __generator(this, function (_a) {\n              switch (_a.label) {\n                case 0:\n                  if (!imageDetailsCache.has(url)) return [3, 1];\n                  imageDetails = imageDetailsCache.get(url);\n                  return [3, 7];\n\n                case 1:\n                  _a.trys.push([1, 6,, 7]);\n\n                  if (!awaitingForImageLoading.has(url)) return [3, 3];\n                  awaiters_1 = awaitingForImageLoading.get(url);\n                  return [4, new Promise(function (resolve) {\n                    return awaiters_1.push(resolve);\n                  })];\n\n                case 2:\n                  imageDetails = _a.sent();\n\n                  if (!imageDetails) {\n                    return [2, null];\n                  }\n\n                  return [3, 5];\n\n                case 3:\n                  awaitingForImageLoading.set(url, []);\n                  return [4, getImageDetails(url)];\n\n                case 4:\n                  imageDetails = _a.sent();\n                  imageDetailsCache.set(url, imageDetails);\n                  awaitingForImageLoading.get(url).forEach(function (resolve) {\n                    return resolve(imageDetails);\n                  });\n                  awaitingForImageLoading.delete(url);\n                  _a.label = 5;\n\n                case 5:\n                  if (isCancelled()) {\n                    return [2, null];\n                  }\n\n                  return [3, 7];\n\n                case 6:\n                  err_1 = _a.sent();\n                  logWarn(err_1);\n\n                  if (awaitingForImageLoading.has(url)) {\n                    awaitingForImageLoading.get(url).forEach(function (resolve) {\n                      return resolve(null);\n                    });\n                    awaitingForImageLoading.delete(url);\n                  }\n\n                  return [2, absoluteValue];\n\n                case 7:\n                  bgImageValue = getBgImageValue_1(imageDetails, filter) || absoluteValue;\n                  return [2, bgImageValue];\n              }\n            });\n          });\n        };\n      };\n\n      var getBgImageValue_1 = function (imageDetails, filter) {\n        var isDark = imageDetails.isDark,\n            isLight = imageDetails.isLight,\n            isTransparent = imageDetails.isTransparent,\n            isLarge = imageDetails.isLarge,\n            isTooLarge = imageDetails.isTooLarge,\n            width = imageDetails.width;\n        var result;\n\n        if (isTooLarge) {\n          result = \"url(\\\"\" + imageDetails.src + \"\\\")\";\n        } else if (isDark && isTransparent && filter.mode === 1 && !isLarge && width > 2) {\n          logInfo(\"Inverting dark image \" + imageDetails.src);\n          var inverted = getFilteredImageDataURL(imageDetails, __assign(__assign({}, filter), {\n            sepia: clamp(filter.sepia + 10, 0, 100)\n          }));\n          result = \"url(\\\"\" + inverted + \"\\\")\";\n        } else if (isLight && !isTransparent && filter.mode === 1) {\n          if (isLarge) {\n            result = 'none';\n          } else {\n            logInfo(\"Dimming light image \" + imageDetails.src);\n            var dimmed = getFilteredImageDataURL(imageDetails, filter);\n            result = \"url(\\\"\" + dimmed + \"\\\")\";\n          }\n        } else if (filter.mode === 0 && isLight && !isLarge) {\n          logInfo(\"Applying filter to image \" + imageDetails.src);\n          var filtered = getFilteredImageDataURL(imageDetails, __assign(__assign({}, filter), {\n            brightness: clamp(filter.brightness - 10, 5, 200),\n            sepia: clamp(filter.sepia + 10, 0, 100)\n          }));\n          result = \"url(\\\"\" + filtered + \"\\\")\";\n        } else {\n          result = null;\n        }\n\n        return result;\n      };\n\n      var modifiers_1 = [];\n      var index_1 = 0;\n      matches_1.forEach(function (_a, i) {\n        var match = _a.match,\n            type = _a.type,\n            matchStart = _a.index;\n        var prefixStart = index_1;\n        var matchEnd = matchStart + match.length;\n        index_1 = matchEnd;\n        modifiers_1.push(function () {\n          return value.substring(prefixStart, matchStart);\n        });\n        modifiers_1.push(type === 'url' ? getURLModifier_1(match) : getGradientModifier_1(match));\n\n        if (i === matches_1.length - 1) {\n          modifiers_1.push(function () {\n            return value.substring(matchEnd);\n          });\n        }\n      });\n      return function (filter) {\n        var results = modifiers_1.filter(Boolean).map(function (modify) {\n          return modify(filter);\n        });\n\n        if (results.some(function (r) {\n          return r instanceof Promise;\n        })) {\n          return Promise.all(results).then(function (asyncResults) {\n            return asyncResults.join('');\n          });\n        }\n\n        return results.join('');\n      };\n    } catch (err) {\n      logWarn(\"Unable to parse gradient \" + value, err);\n      return null;\n    }\n  }\n\n  function getShadowModifierWithInfo(value) {\n    try {\n      var index_2 = 0;\n      var colorMatches_1 = getMatches(/(^|\\s)(?!calc)([a-z]+\\(.+?\\)|#[0-9a-f]+|[a-z]+)(.*?(inset|outset)?($|,))/ig, value, 2);\n      var notParsed_1 = 0;\n      var modifiers_2 = colorMatches_1.map(function (match, i) {\n        var prefixIndex = index_2;\n        var matchIndex = value.indexOf(match, index_2);\n        var matchEnd = matchIndex + match.length;\n        index_2 = matchEnd;\n        var rgb = tryParseColor(match);\n\n        if (!rgb) {\n          notParsed_1++;\n          return function () {\n            return value.substring(prefixIndex, matchEnd);\n          };\n        }\n\n        return function (filter) {\n          return \"\" + value.substring(prefixIndex, matchIndex) + modifyShadowColor(rgb, filter) + (i === colorMatches_1.length - 1 ? value.substring(matchEnd) : '');\n        };\n      });\n      return function (filter) {\n        var modified = modifiers_2.map(function (modify) {\n          return modify(filter);\n        }).join('');\n        return {\n          matchesLength: colorMatches_1.length,\n          unparseableMatchesLength: notParsed_1,\n          result: modified\n        };\n      };\n    } catch (err) {\n      logWarn(\"Unable to parse shadow \" + value, err);\n      return null;\n    }\n  }\n\n  function getShadowModifier(value) {\n    var shadowModifier = getShadowModifierWithInfo(value);\n\n    if (!shadowModifier) {\n      return null;\n    }\n\n    return function (theme) {\n      return shadowModifier(theme).result;\n    };\n  }\n\n  function getVariableModifier(variablesStore, prop, value, rule, ignoredImgSelectors, isCancelled) {\n    return variablesStore.getModifierForVariable({\n      varName: prop,\n      sourceValue: value,\n      rule: rule,\n      ignoredImgSelectors: ignoredImgSelectors,\n      isCancelled: isCancelled\n    });\n  }\n\n  function getVariableDependantModifier(variablesStore, prop, value) {\n    return variablesStore.getModifierForVarDependant(prop, value);\n  }\n\n  function cleanModificationCache() {\n    colorParseCache.clear();\n    clearColorModificationCache();\n    imageDetailsCache.clear();\n    cleanImageProcessingCache();\n    awaitingForImageLoading.clear();\n  }\n\n  var VAR_TYPE_BGCOLOR = 1 << 0;\n  var VAR_TYPE_TEXTCOLOR = 1 << 1;\n  var VAR_TYPE_BORDERCOLOR = 1 << 2;\n  var VAR_TYPE_BGIMG = 1 << 3;\n\n  var VariablesStore = function () {\n    function VariablesStore() {\n      this.varTypes = new Map();\n      this.rulesQueue = [];\n      this.definedVars = new Set();\n      this.varRefs = new Map();\n      this.unknownColorVars = new Set();\n      this.unknownBgVars = new Set();\n      this.undefinedVars = new Set();\n      this.initialVarTypes = new Map();\n      this.changedTypeVars = new Set();\n      this.typeChangeSubscriptions = new Map();\n      this.unstableVarValues = new Map();\n    }\n\n    VariablesStore.prototype.clear = function () {\n      this.varTypes.clear();\n      this.rulesQueue.splice(0);\n      this.definedVars.clear();\n      this.varRefs.clear();\n      this.unknownColorVars.clear();\n      this.unknownBgVars.clear();\n      this.undefinedVars.clear();\n      this.initialVarTypes.clear();\n      this.changedTypeVars.clear();\n      this.typeChangeSubscriptions.clear();\n      this.unstableVarValues.clear();\n    };\n\n    VariablesStore.prototype.isVarType = function (varName, typeNum) {\n      return this.varTypes.has(varName) && (this.varTypes.get(varName) & typeNum) > 0;\n    };\n\n    VariablesStore.prototype.addRulesForMatching = function (rules) {\n      this.rulesQueue.push(rules);\n    };\n\n    VariablesStore.prototype.matchVariablesAndDependants = function () {\n      var _this = this;\n\n      this.changedTypeVars.clear();\n      this.initialVarTypes = new Map(this.varTypes);\n      this.collectRootVariables();\n      this.collectVariablesAndVarDep(this.rulesQueue);\n      this.rulesQueue.splice(0);\n      this.collectRootVarDependants();\n      this.varRefs.forEach(function (refs, v) {\n        refs.forEach(function (r) {\n          if (_this.varTypes.has(v)) {\n            _this.resolveVariableType(r, _this.varTypes.get(v));\n          }\n        });\n      });\n      this.unknownColorVars.forEach(function (v) {\n        if (_this.unknownBgVars.has(v)) {\n          _this.unknownColorVars.delete(v);\n\n          _this.unknownBgVars.delete(v);\n\n          _this.resolveVariableType(v, VAR_TYPE_BGCOLOR);\n        } else if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR)) {\n          _this.unknownColorVars.delete(v);\n        } else {\n          _this.undefinedVars.add(v);\n        }\n      });\n      this.unknownBgVars.forEach(function (v) {\n        var hasColor = _this.findVarRef(v, function (ref) {\n          return _this.unknownColorVars.has(ref) || _this.isVarType(ref, VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR);\n        }) != null;\n\n        if (hasColor) {\n          _this.itarateVarRefs(v, function (ref) {\n            _this.resolveVariableType(ref, VAR_TYPE_BGCOLOR);\n          });\n        } else if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_BGIMG)) {\n          _this.unknownBgVars.delete(v);\n        } else {\n          _this.undefinedVars.add(v);\n        }\n      });\n      this.changedTypeVars.forEach(function (varName) {\n        if (_this.typeChangeSubscriptions.has(varName)) {\n          _this.typeChangeSubscriptions.get(varName).forEach(function (callback) {\n            callback();\n          });\n        }\n      });\n      this.changedTypeVars.clear();\n    };\n\n    VariablesStore.prototype.getModifierForVariable = function (options) {\n      var _this = this;\n\n      return function (theme) {\n        var varName = options.varName,\n            sourceValue = options.sourceValue,\n            rule = options.rule,\n            ignoredImgSelectors = options.ignoredImgSelectors,\n            isCancelled = options.isCancelled;\n\n        var getDeclarations = function () {\n          var declarations = [];\n\n          var addModifiedValue = function (typeNum, varNameWrapper, colorModifier) {\n            if (!_this.isVarType(varName, typeNum)) {\n              return;\n            }\n\n            var property = varNameWrapper(varName);\n            var modifiedValue;\n\n            if (isVarDependant(sourceValue)) {\n              if (isConstructedColorVar(sourceValue)) {\n                var value = insertVarValues(sourceValue, _this.unstableVarValues);\n\n                if (!value) {\n                  value = typeNum === VAR_TYPE_BGCOLOR ? '#ffffff' : '#000000';\n                }\n\n                modifiedValue = colorModifier(value, theme);\n              } else {\n                modifiedValue = replaceCSSVariablesNames(sourceValue, function (v) {\n                  return varNameWrapper(v);\n                }, function (fallback) {\n                  return colorModifier(fallback, theme);\n                });\n              }\n            } else {\n              modifiedValue = colorModifier(sourceValue, theme);\n            }\n\n            declarations.push({\n              property: property,\n              value: modifiedValue\n            });\n          };\n\n          addModifiedValue(VAR_TYPE_BGCOLOR, wrapBgColorVariableName, tryModifyBgColor);\n          addModifiedValue(VAR_TYPE_TEXTCOLOR, wrapTextColorVariableName, tryModifyTextColor);\n          addModifiedValue(VAR_TYPE_BORDERCOLOR, wrapBorderColorVariableName, tryModifyBorderColor);\n\n          if (_this.isVarType(varName, VAR_TYPE_BGIMG)) {\n            var property = wrapBgImgVariableName(varName);\n            var modifiedValue = sourceValue;\n\n            if (isVarDependant(sourceValue)) {\n              modifiedValue = replaceCSSVariablesNames(sourceValue, function (v) {\n                return wrapBgColorVariableName(v);\n              }, function (fallback) {\n                return tryModifyBgColor(fallback, theme);\n              });\n            }\n\n            var bgModifier = getBgImageModifier(modifiedValue, rule, ignoredImgSelectors, isCancelled);\n            modifiedValue = typeof bgModifier === 'function' ? bgModifier(theme) : bgModifier;\n            declarations.push({\n              property: property,\n              value: modifiedValue\n            });\n          }\n\n          return declarations;\n        };\n\n        var callbacks = new Set();\n\n        var addListener = function (onTypeChange) {\n          var callback = function () {\n            var decs = getDeclarations();\n            onTypeChange(decs);\n          };\n\n          callbacks.add(callback);\n\n          _this.subscribeForVarTypeChange(varName, callback);\n        };\n\n        var removeListeners = function () {\n          callbacks.forEach(function (callback) {\n            _this.unsubscribeFromVariableTypeChanges(varName, callback);\n          });\n        };\n\n        return {\n          declarations: getDeclarations(),\n          onTypeChange: {\n            addListener: addListener,\n            removeListeners: removeListeners\n          }\n        };\n      };\n    };\n\n    VariablesStore.prototype.getModifierForVarDependant = function (property, sourceValue) {\n      var _this = this;\n\n      if (sourceValue.match(/^\\s*(rgb|hsl)a?\\(/)) {\n        var isBg_1 = property.startsWith('background');\n        var isText_1 = property === 'color' || property === 'caret-color';\n        return function (theme) {\n          var value = insertVarValues(sourceValue, _this.unstableVarValues);\n\n          if (!value) {\n            value = isBg_1 ? '#ffffff' : '#000000';\n          }\n\n          var modifier = isBg_1 ? tryModifyBgColor : isText_1 ? tryModifyTextColor : tryModifyBorderColor;\n          return modifier(value, theme);\n        };\n      }\n\n      if (property === 'background-color') {\n        return function (theme) {\n          return replaceCSSVariablesNames(sourceValue, function (v) {\n            return wrapBgColorVariableName(v);\n          }, function (fallback) {\n            return tryModifyBgColor(fallback, theme);\n          });\n        };\n      }\n\n      if (property === 'color' || property === 'caret-color') {\n        return function (theme) {\n          return replaceCSSVariablesNames(sourceValue, function (v) {\n            return wrapTextColorVariableName(v);\n          }, function (fallback) {\n            return tryModifyTextColor(fallback, theme);\n          });\n        };\n      }\n\n      if (property === 'background' || property === 'background-image' || property === 'box-shadow') {\n        return function (theme) {\n          var unknownVars = new Set();\n\n          var modify = function () {\n            var variableReplaced = replaceCSSVariablesNames(sourceValue, function (v) {\n              if (_this.isVarType(v, VAR_TYPE_BGCOLOR)) {\n                return wrapBgColorVariableName(v);\n              }\n\n              if (_this.isVarType(v, VAR_TYPE_BGIMG)) {\n                return wrapBgImgVariableName(v);\n              }\n\n              unknownVars.add(v);\n              return v;\n            }, function (fallback) {\n              return tryModifyBgColor(fallback, theme);\n            });\n\n            if (property === 'box-shadow') {\n              var shadowModifier = getShadowModifierWithInfo(variableReplaced);\n              var modifiedShadow = shadowModifier(theme);\n\n              if (modifiedShadow.unparseableMatchesLength !== modifiedShadow.matchesLength) {\n                return modifiedShadow.result;\n              }\n            }\n\n            return variableReplaced;\n          };\n\n          var modified = modify();\n\n          if (unknownVars.size > 0) {\n            return new Promise(function (resolve) {\n              var firstUnknownVar = unknownVars.values().next().value;\n\n              var callback = function () {\n                _this.unsubscribeFromVariableTypeChanges(firstUnknownVar, callback);\n\n                var newValue = modify();\n                resolve(newValue);\n              };\n\n              _this.subscribeForVarTypeChange(firstUnknownVar, callback);\n            });\n          }\n\n          return modified;\n        };\n      }\n\n      if (property.startsWith('border') || property.startsWith('outline')) {\n        return function (theme) {\n          return replaceCSSVariablesNames(sourceValue, function (v) {\n            return wrapBorderColorVariableName(v);\n          }, function (fallback) {\n            return tryModifyBorderColor(fallback, theme);\n          });\n        };\n      }\n\n      return null;\n    };\n\n    VariablesStore.prototype.subscribeForVarTypeChange = function (varName, callback) {\n      if (!this.typeChangeSubscriptions.has(varName)) {\n        this.typeChangeSubscriptions.set(varName, new Set());\n      }\n\n      var rootStore = this.typeChangeSubscriptions.get(varName);\n\n      if (!rootStore.has(callback)) {\n        rootStore.add(callback);\n      }\n    };\n\n    VariablesStore.prototype.unsubscribeFromVariableTypeChanges = function (varName, callback) {\n      if (this.typeChangeSubscriptions.has(varName)) {\n        this.typeChangeSubscriptions.get(varName).delete(callback);\n      }\n    };\n\n    VariablesStore.prototype.collectVariablesAndVarDep = function (ruleList) {\n      var _this = this;\n\n      ruleList.forEach(function (rules) {\n        iterateCSSRules(rules, function (rule) {\n          rule.style && iterateCSSDeclarations(rule.style, function (property, value) {\n            if (isVariable(property)) {\n              _this.inspectVariable(property, value);\n            }\n\n            if (isVarDependant(value)) {\n              _this.inspectVarDependant(property, value);\n            }\n          });\n        });\n      });\n    };\n\n    VariablesStore.prototype.collectRootVariables = function () {\n      var _this = this;\n\n      iterateCSSDeclarations(document.documentElement.style, function (property, value) {\n        if (isVariable(property)) {\n          _this.inspectVariable(property, value);\n        }\n      });\n    };\n\n    VariablesStore.prototype.inspectVariable = function (varName, value) {\n      this.unstableVarValues.set(varName, value);\n\n      if (isVarDependant(value) && isConstructedColorVar(value)) {\n        this.unknownColorVars.add(varName);\n        this.definedVars.add(varName);\n      }\n\n      if (this.definedVars.has(varName)) {\n        return;\n      }\n\n      this.definedVars.add(varName);\n      var color = tryParseColor(value);\n\n      if (color) {\n        this.unknownColorVars.add(varName);\n      } else if (value.includes('url(') || value.includes('linear-gradient(') || value.includes('radial-gradient(')) {\n        this.resolveVariableType(varName, VAR_TYPE_BGIMG);\n      }\n    };\n\n    VariablesStore.prototype.resolveVariableType = function (varName, typeNum) {\n      var initialType = this.initialVarTypes.get(varName) || 0;\n      var currentType = this.varTypes.get(varName) || 0;\n      var newType = currentType | typeNum;\n      this.varTypes.set(varName, newType);\n\n      if (newType !== initialType || this.undefinedVars.has(varName)) {\n        this.changedTypeVars.add(varName);\n        this.undefinedVars.delete(varName);\n      }\n\n      this.unknownColorVars.delete(varName);\n      this.unknownBgVars.delete(varName);\n    };\n\n    VariablesStore.prototype.collectRootVarDependants = function () {\n      var _this = this;\n\n      iterateCSSDeclarations(document.documentElement.style, function (property, value) {\n        if (isVarDependant(value)) {\n          _this.inspectVarDependant(property, value);\n        }\n      });\n    };\n\n    VariablesStore.prototype.inspectVarDependant = function (property, value) {\n      var _this = this;\n\n      if (isVariable(property)) {\n        this.iterateVarDeps(value, function (ref) {\n          if (!_this.varRefs.has(property)) {\n            _this.varRefs.set(property, new Set());\n          }\n\n          _this.varRefs.get(property).add(ref);\n        });\n      } else if (property === 'background-color' || property === 'box-shadow') {\n        this.iterateVarDeps(value, function (v) {\n          return _this.resolveVariableType(v, VAR_TYPE_BGCOLOR);\n        });\n      } else if (property === 'color' || property === 'caret-color') {\n        this.iterateVarDeps(value, function (v) {\n          return _this.resolveVariableType(v, VAR_TYPE_TEXTCOLOR);\n        });\n      } else if (property.startsWith('border') || property.startsWith('outline')) {\n        this.iterateVarDeps(value, function (v) {\n          return _this.resolveVariableType(v, VAR_TYPE_BORDERCOLOR);\n        });\n      } else if (property === 'background' || property === 'background-image') {\n        this.iterateVarDeps(value, function (v) {\n          if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_BGIMG)) {\n            return;\n          }\n\n          var isBgColor = _this.findVarRef(v, function (ref) {\n            return _this.unknownColorVars.has(ref) || _this.isVarType(ref, VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR);\n          }) != null;\n\n          _this.itarateVarRefs(v, function (ref) {\n            if (isBgColor) {\n              _this.resolveVariableType(ref, VAR_TYPE_BGCOLOR);\n            } else {\n              _this.unknownBgVars.add(ref);\n            }\n          });\n        });\n      }\n    };\n\n    VariablesStore.prototype.iterateVarDeps = function (value, iterator) {\n      var varDeps = new Set();\n      iterateVarDependencies(value, function (v) {\n        return varDeps.add(v);\n      });\n      varDeps.forEach(function (v) {\n        return iterator(v);\n      });\n    };\n\n    VariablesStore.prototype.findVarRef = function (varName, iterator, stack) {\n      var e_1, _a;\n\n      if (stack === void 0) {\n        stack = new Set();\n      }\n\n      if (stack.has(varName)) {\n        return null;\n      }\n\n      stack.add(varName);\n      var result = iterator(varName);\n\n      if (result) {\n        return varName;\n      }\n\n      var refs = this.varRefs.get(varName);\n\n      if (!refs || refs.size === 0) {\n        return null;\n      }\n\n      try {\n        for (var refs_1 = __values(refs), refs_1_1 = refs_1.next(); !refs_1_1.done; refs_1_1 = refs_1.next()) {\n          var ref = refs_1_1.value;\n          var found = this.findVarRef(ref, iterator, stack);\n\n          if (found) {\n            return found;\n          }\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (refs_1_1 && !refs_1_1.done && (_a = refs_1.return)) _a.call(refs_1);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n\n      return null;\n    };\n\n    VariablesStore.prototype.itarateVarRefs = function (varName, iterator) {\n      this.findVarRef(varName, function (ref) {\n        iterator(ref);\n        return false;\n      });\n    };\n\n    VariablesStore.prototype.setOnRootVariableChange = function (callback) {\n      this.onRootVariableDefined = callback;\n    };\n\n    VariablesStore.prototype.putRootVars = function (styleElement, theme) {\n      var e_2, _a;\n\n      var _this = this;\n\n      var sheet = styleElement.sheet;\n\n      if (sheet.cssRules.length > 0) {\n        sheet.deleteRule(0);\n      }\n\n      var declarations = new Map();\n      iterateCSSDeclarations(document.documentElement.style, function (property, value) {\n        if (isVariable(property)) {\n          if (_this.isVarType(property, VAR_TYPE_BGCOLOR)) {\n            declarations.set(wrapBgColorVariableName(property), tryModifyBgColor(value, theme));\n          }\n\n          if (_this.isVarType(property, VAR_TYPE_TEXTCOLOR)) {\n            declarations.set(wrapTextColorVariableName(property), tryModifyTextColor(value, theme));\n          }\n\n          if (_this.isVarType(property, VAR_TYPE_BORDERCOLOR)) {\n            declarations.set(wrapBorderColorVariableName(property), tryModifyBorderColor(value, theme));\n          }\n\n          _this.subscribeForVarTypeChange(property, _this.onRootVariableDefined);\n        }\n      });\n      var cssLines = [];\n      cssLines.push(':root {');\n\n      try {\n        for (var declarations_1 = __values(declarations), declarations_1_1 = declarations_1.next(); !declarations_1_1.done; declarations_1_1 = declarations_1.next()) {\n          var _b = __read(declarations_1_1.value, 2),\n              property = _b[0],\n              value = _b[1];\n\n          cssLines.push(\"    \" + property + \": \" + value + \";\");\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (declarations_1_1 && !declarations_1_1.done && (_a = declarations_1.return)) _a.call(declarations_1);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n\n      cssLines.push('}');\n      var cssText = cssLines.join('\\n');\n      sheet.insertRule(cssText);\n    };\n\n    return VariablesStore;\n  }();\n\n  var variablesStore = new VariablesStore();\n\n  function getVariableRange(input, searchStart) {\n    if (searchStart === void 0) {\n      searchStart = 0;\n    }\n\n    var start = input.indexOf('var(', searchStart);\n\n    if (start >= 0) {\n      var range = getParenthesesRange(input, start + 3);\n\n      if (range) {\n        return {\n          start: start,\n          end: range.end\n        };\n      }\n\n      return null;\n    }\n  }\n\n  function getVariablesMatches(input) {\n    var ranges = [];\n    var i = 0;\n    var range;\n\n    while (range = getVariableRange(input, i)) {\n      var start = range.start,\n          end = range.end;\n      ranges.push({\n        start: start,\n        end: end,\n        value: input.substring(start, end)\n      });\n      i = range.end + 1;\n    }\n\n    return ranges;\n  }\n\n  function replaceVariablesMatches(input, replacer) {\n    var matches = getVariablesMatches(input);\n    var matchesCount = matches.length;\n\n    if (matchesCount === 0) {\n      return input;\n    }\n\n    var inputLength = input.length;\n    var replacements = matches.map(function (m) {\n      return replacer(m.value);\n    });\n    var parts = [];\n    parts.push(input.substring(0, matches[0].start));\n\n    for (var i = 0; i < matchesCount; i++) {\n      parts.push(replacements[i]);\n      var start = matches[i].end;\n      var end = i < matchesCount - 1 ? matches[i + 1].start : inputLength;\n      parts.push(input.substring(start, end));\n    }\n\n    return parts.join('');\n  }\n\n  function getVariableNameAndFallback(match) {\n    var commaIndex = match.indexOf(',');\n    var name;\n    var fallback;\n\n    if (commaIndex >= 0) {\n      name = match.substring(4, commaIndex).trim();\n      fallback = match.substring(commaIndex + 1, match.length - 1).trim();\n    } else {\n      name = match.substring(4, match.length - 1).trim();\n      fallback = '';\n    }\n\n    return {\n      name: name,\n      fallback: fallback\n    };\n  }\n\n  function replaceCSSVariablesNames(value, nameReplacer, fallbackReplacer) {\n    var matchReplacer = function (match) {\n      var _a = getVariableNameAndFallback(match),\n          name = _a.name,\n          fallback = _a.fallback;\n\n      var newName = nameReplacer(name);\n\n      if (!fallback) {\n        return \"var(\" + newName + \")\";\n      }\n\n      var newFallback;\n\n      if (isVarDependant(fallback)) {\n        newFallback = replaceCSSVariablesNames(fallback, nameReplacer, fallbackReplacer);\n      } else if (fallbackReplacer) {\n        newFallback = fallbackReplacer(fallback);\n      } else {\n        newFallback = fallback;\n      }\n\n      return \"var(\" + newName + \", \" + newFallback + \")\";\n    };\n\n    return replaceVariablesMatches(value, matchReplacer);\n  }\n\n  function iterateVarDependencies(value, iterator) {\n    replaceCSSVariablesNames(value, function (varName) {\n      iterator(varName);\n      return varName;\n    });\n  }\n\n  function wrapBgColorVariableName(name) {\n    return \"--darkreader-bg\" + name;\n  }\n\n  function wrapTextColorVariableName(name) {\n    return \"--darkreader-text\" + name;\n  }\n\n  function wrapBorderColorVariableName(name) {\n    return \"--darkreader-border\" + name;\n  }\n\n  function wrapBgImgVariableName(name) {\n    return \"--darkreader-bgimg\" + name;\n  }\n\n  function isVariable(property) {\n    return property.startsWith('--');\n  }\n\n  function isVarDependant(value) {\n    return value.includes('var(');\n  }\n\n  function isConstructedColorVar(value) {\n    return value.match(/^\\s*(rgb|hsl)a?\\(/);\n  }\n\n  var rawValueRegex = /^\\d{1,3}, ?\\d{1,3}, ?\\d{1,3}$/;\n\n  function parseRawValue(color) {\n    if (rawValueRegex.test(color)) {\n      var splitted = color.split(',');\n      var resultInRGB_1 = 'rgb(';\n      splitted.forEach(function (number) {\n        resultInRGB_1 += number.trim() + \", \";\n      });\n      resultInRGB_1 = resultInRGB_1.substr(0, resultInRGB_1.length - 2);\n      resultInRGB_1 += ')';\n      return {\n        isRaw: true,\n        color: resultInRGB_1\n      };\n    }\n\n    return {\n      isRaw: false,\n      color: color\n    };\n  }\n\n  function handleRawValue(color, theme, modifyFunction) {\n    var _a = parseRawValue(color),\n        isRaw = _a.isRaw,\n        newColor = _a.color;\n\n    var rgb = tryParseColor(newColor);\n\n    if (rgb) {\n      var outputColor = modifyFunction(rgb, theme);\n\n      if (isRaw) {\n        var outputInRGB = tryParseColor(outputColor);\n        return outputInRGB ? outputInRGB.r + \", \" + outputInRGB.g + \", \" + outputInRGB.b : outputColor;\n      }\n\n      return outputColor;\n    }\n\n    return newColor;\n  }\n\n  function tryModifyBgColor(color, theme) {\n    return handleRawValue(color, theme, modifyBackgroundColor);\n  }\n\n  function tryModifyTextColor(color, theme) {\n    return handleRawValue(color, theme, modifyForegroundColor);\n  }\n\n  function tryModifyBorderColor(color, theme) {\n    return handleRawValue(color, theme, modifyBorderColor);\n  }\n\n  function insertVarValues(source, varValues, stack) {\n    if (stack === void 0) {\n      stack = new Set();\n    }\n\n    var containsUnresolvedVar = false;\n\n    var matchReplacer = function (match) {\n      var _a = getVariableNameAndFallback(match),\n          name = _a.name,\n          fallback = _a.fallback;\n\n      if (stack.has(name)) {\n        containsUnresolvedVar = true;\n        return null;\n      }\n\n      stack.add(name);\n      var varValue = varValues.get(name) || fallback;\n      var inserted = null;\n\n      if (varValue) {\n        if (isVarDependant(varValue)) {\n          inserted = insertVarValues(varValue, varValues, stack);\n        } else {\n          inserted = varValue;\n        }\n      }\n\n      if (!inserted) {\n        containsUnresolvedVar = true;\n        return null;\n      }\n\n      return inserted;\n    };\n\n    var replaced = replaceVariablesMatches(source, matchReplacer);\n\n    if (containsUnresolvedVar) {\n      return null;\n    }\n\n    return replaced;\n  }\n\n  var overrides = {\n    'background-color': {\n      customProp: '--darkreader-inline-bgcolor',\n      cssProp: 'background-color',\n      dataAttr: 'data-darkreader-inline-bgcolor'\n    },\n    'background-image': {\n      customProp: '--darkreader-inline-bgimage',\n      cssProp: 'background-image',\n      dataAttr: 'data-darkreader-inline-bgimage'\n    },\n    'border-color': {\n      customProp: '--darkreader-inline-border',\n      cssProp: 'border-color',\n      dataAttr: 'data-darkreader-inline-border'\n    },\n    'border-bottom-color': {\n      customProp: '--darkreader-inline-border-bottom',\n      cssProp: 'border-bottom-color',\n      dataAttr: 'data-darkreader-inline-border-bottom'\n    },\n    'border-left-color': {\n      customProp: '--darkreader-inline-border-left',\n      cssProp: 'border-left-color',\n      dataAttr: 'data-darkreader-inline-border-left'\n    },\n    'border-right-color': {\n      customProp: '--darkreader-inline-border-right',\n      cssProp: 'border-right-color',\n      dataAttr: 'data-darkreader-inline-border-right'\n    },\n    'border-top-color': {\n      customProp: '--darkreader-inline-border-top',\n      cssProp: 'border-top-color',\n      dataAttr: 'data-darkreader-inline-border-top'\n    },\n    'box-shadow': {\n      customProp: '--darkreader-inline-boxshadow',\n      cssProp: 'box-shadow',\n      dataAttr: 'data-darkreader-inline-boxshadow'\n    },\n    'color': {\n      customProp: '--darkreader-inline-color',\n      cssProp: 'color',\n      dataAttr: 'data-darkreader-inline-color'\n    },\n    'fill': {\n      customProp: '--darkreader-inline-fill',\n      cssProp: 'fill',\n      dataAttr: 'data-darkreader-inline-fill'\n    },\n    'stroke': {\n      customProp: '--darkreader-inline-stroke',\n      cssProp: 'stroke',\n      dataAttr: 'data-darkreader-inline-stroke'\n    },\n    'outline-color': {\n      customProp: '--darkreader-inline-outline',\n      cssProp: 'outline-color',\n      dataAttr: 'data-darkreader-inline-outline'\n    },\n    'stop-color': {\n      customProp: '--darkreader-inline-stopcolor',\n      cssProp: 'stop-color',\n      dataAttr: 'data-darkreader-inline-stopcolor'\n    }\n  };\n  var overridesList = Object.values(overrides);\n  var normalizedPropList = {};\n  overridesList.forEach(function (_a) {\n    var cssProp = _a.cssProp,\n        customProp = _a.customProp;\n    return normalizedPropList[customProp] = cssProp;\n  });\n  var INLINE_STYLE_ATTRS = ['style', 'fill', 'stop-color', 'stroke', 'bgcolor', 'color'];\n  var INLINE_STYLE_SELECTOR = INLINE_STYLE_ATTRS.map(function (attr) {\n    return \"[\" + attr + \"]\";\n  }).join(', ');\n\n  function getInlineOverrideStyle() {\n    return overridesList.map(function (_a) {\n      var dataAttr = _a.dataAttr,\n          customProp = _a.customProp,\n          cssProp = _a.cssProp;\n      return [\"[\" + dataAttr + \"] {\", \"  \" + cssProp + \": var(\" + customProp + \") !important;\", '}'].join('\\n');\n    }).join('\\n');\n  }\n\n  function getInlineStyleElements(root) {\n    var results = [];\n\n    if (root instanceof Element && root.matches(INLINE_STYLE_SELECTOR)) {\n      results.push(root);\n    }\n\n    if (root instanceof Element || isShadowDomSupported && root instanceof ShadowRoot || root instanceof Document) {\n      push(results, root.querySelectorAll(INLINE_STYLE_SELECTOR));\n    }\n\n    return results;\n  }\n\n  var treeObservers = new Map();\n  var attrObservers = new Map();\n\n  function watchForInlineStyles(elementStyleDidChange, shadowRootDiscovered) {\n    deepWatchForInlineStyles(document, elementStyleDidChange, shadowRootDiscovered);\n    iterateShadowHosts(document.documentElement, function (host) {\n      deepWatchForInlineStyles(host.shadowRoot, elementStyleDidChange, shadowRootDiscovered);\n    });\n  }\n\n  function deepWatchForInlineStyles(root, elementStyleDidChange, shadowRootDiscovered) {\n    if (treeObservers.has(root)) {\n      treeObservers.get(root).disconnect();\n      attrObservers.get(root).disconnect();\n    }\n\n    var discoveredNodes = new WeakSet();\n\n    function discoverNodes(node) {\n      getInlineStyleElements(node).forEach(function (el) {\n        if (discoveredNodes.has(el)) {\n          return;\n        }\n\n        discoveredNodes.add(el);\n        elementStyleDidChange(el);\n      });\n      iterateShadowHosts(node, function (n) {\n        if (discoveredNodes.has(node)) {\n          return;\n        }\n\n        discoveredNodes.add(node);\n        shadowRootDiscovered(n.shadowRoot);\n        deepWatchForInlineStyles(n.shadowRoot, elementStyleDidChange, shadowRootDiscovered);\n      });\n    }\n\n    var treeObserver = createOptimizedTreeObserver(root, {\n      onMinorMutations: function (_a) {\n        var additions = _a.additions;\n        additions.forEach(function (added) {\n          return discoverNodes(added);\n        });\n      },\n      onHugeMutations: function () {\n        discoverNodes(root);\n      }\n    });\n    treeObservers.set(root, treeObserver);\n    var attemptCount = 0;\n    var start = null;\n    var ATTEMPTS_INTERVAL = getDuration({\n      seconds: 10\n    });\n    var RETRY_TIMEOUT = getDuration({\n      seconds: 2\n    });\n    var MAX_ATTEMPTS_COUNT = 50;\n    var cache = [];\n    var timeoutId = null;\n    var handleAttributeMutations = throttle(function (mutations) {\n      mutations.forEach(function (m) {\n        if (INLINE_STYLE_ATTRS.includes(m.attributeName)) {\n          elementStyleDidChange(m.target);\n        }\n      });\n    });\n    var attrObserver = new MutationObserver(function (mutations) {\n      if (timeoutId) {\n        cache.push.apply(cache, __spreadArray([], __read(mutations), false));\n        return;\n      }\n\n      attemptCount++;\n      var now = Date.now();\n\n      if (start == null) {\n        start = now;\n      } else if (attemptCount >= MAX_ATTEMPTS_COUNT) {\n        if (now - start < ATTEMPTS_INTERVAL) {\n          timeoutId = setTimeout(function () {\n            start = null;\n            attemptCount = 0;\n            timeoutId = null;\n            var attributeCache = cache;\n            cache = [];\n            handleAttributeMutations(attributeCache);\n          }, RETRY_TIMEOUT);\n          cache.push.apply(cache, __spreadArray([], __read(mutations), false));\n          return;\n        }\n\n        start = now;\n        attemptCount = 1;\n      }\n\n      handleAttributeMutations(mutations);\n    });\n    attrObserver.observe(root, {\n      attributes: true,\n      attributeFilter: INLINE_STYLE_ATTRS.concat(overridesList.map(function (_a) {\n        var dataAttr = _a.dataAttr;\n        return dataAttr;\n      })),\n      subtree: true\n    });\n    attrObservers.set(root, attrObserver);\n  }\n\n  function stopWatchingForInlineStyles() {\n    treeObservers.forEach(function (o) {\n      return o.disconnect();\n    });\n    attrObservers.forEach(function (o) {\n      return o.disconnect();\n    });\n    treeObservers.clear();\n    attrObservers.clear();\n  }\n\n  var inlineStyleCache = new WeakMap();\n  var filterProps = ['brightness', 'contrast', 'grayscale', 'sepia', 'mode'];\n\n  function getInlineStyleCacheKey(el, theme) {\n    return INLINE_STYLE_ATTRS.map(function (attr) {\n      return attr + \"=\\\"\" + el.getAttribute(attr) + \"\\\"\";\n    }).concat(filterProps.map(function (prop) {\n      return prop + \"=\\\"\" + theme[prop] + \"\\\"\";\n    })).join(' ');\n  }\n\n  function shouldIgnoreInlineStyle(element, selectors) {\n    for (var i = 0, len = selectors.length; i < len; i++) {\n      var ingnoredSelector = selectors[i];\n\n      if (element.matches(ingnoredSelector)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function overrideInlineStyle(element, theme, ignoreInlineSelectors, ignoreImageSelectors) {\n    var cacheKey = getInlineStyleCacheKey(element, theme);\n\n    if (cacheKey === inlineStyleCache.get(element)) {\n      return;\n    }\n\n    var unsetProps = new Set(Object.keys(overrides));\n\n    function setCustomProp(targetCSSProp, modifierCSSProp, cssVal) {\n      var _a = overrides[targetCSSProp],\n          customProp = _a.customProp,\n          dataAttr = _a.dataAttr;\n      var mod = getModifiableCSSDeclaration(modifierCSSProp, cssVal, {}, variablesStore, ignoreImageSelectors, null);\n\n      if (!mod) {\n        return;\n      }\n\n      var value = mod.value;\n\n      if (typeof value === 'function') {\n        value = value(theme);\n      }\n\n      element.style.setProperty(customProp, value);\n\n      if (!element.hasAttribute(dataAttr)) {\n        element.setAttribute(dataAttr, '');\n      }\n\n      unsetProps.delete(targetCSSProp);\n    }\n\n    if (ignoreInlineSelectors.length > 0) {\n      if (shouldIgnoreInlineStyle(element, ignoreInlineSelectors)) {\n        unsetProps.forEach(function (cssProp) {\n          element.removeAttribute(overrides[cssProp].dataAttr);\n        });\n        return;\n      }\n    }\n\n    if (element.hasAttribute('bgcolor')) {\n      var value = element.getAttribute('bgcolor');\n\n      if (value.match(/^[0-9a-f]{3}$/i) || value.match(/^[0-9a-f]{6}$/i)) {\n        value = \"#\" + value;\n      }\n\n      setCustomProp('background-color', 'background-color', value);\n    }\n\n    if (element.hasAttribute('color') && element.rel !== 'mask-icon') {\n      var value = element.getAttribute('color');\n\n      if (value.match(/^[0-9a-f]{3}$/i) || value.match(/^[0-9a-f]{6}$/i)) {\n        value = \"#\" + value;\n      }\n\n      setCustomProp('color', 'color', value);\n    }\n\n    if (element instanceof SVGElement) {\n      if (element.hasAttribute('fill')) {\n        var SMALL_SVG_LIMIT_1 = 32;\n        var value_1 = element.getAttribute('fill');\n\n        if (value_1 !== 'none') {\n          if (!(element instanceof SVGTextElement)) {\n            var handleSVGElement = function () {\n              var _a = element.getBoundingClientRect(),\n                  width = _a.width,\n                  height = _a.height;\n\n              var isBg = width > SMALL_SVG_LIMIT_1 || height > SMALL_SVG_LIMIT_1;\n              setCustomProp('fill', isBg ? 'background-color' : 'color', value_1);\n            };\n\n            if (isReadyStateComplete()) {\n              handleSVGElement();\n            } else {\n              addReadyStateCompleteListener(handleSVGElement);\n            }\n          } else {\n            setCustomProp('fill', 'color', value_1);\n          }\n        }\n      }\n\n      if (element.hasAttribute('stop-color')) {\n        setCustomProp('stop-color', 'background-color', element.getAttribute('stop-color'));\n      }\n    }\n\n    if (element.hasAttribute('stroke')) {\n      var value = element.getAttribute('stroke');\n      setCustomProp('stroke', element instanceof SVGLineElement || element instanceof SVGTextElement ? 'border-color' : 'color', value);\n    }\n\n    element.style && iterateCSSDeclarations(element.style, function (property, value) {\n      if (property === 'background-image' && value.includes('url')) {\n        return;\n      }\n\n      if (overrides.hasOwnProperty(property)) {\n        setCustomProp(property, property, value);\n      } else {\n        var overridenProp = normalizedPropList[property];\n\n        if (overridenProp && !element.style.getPropertyValue(overridenProp) && !element.hasAttribute(overridenProp)) {\n          if (overridenProp === 'background-color' && element.hasAttribute('bgcolor')) {\n            return;\n          }\n\n          element.style.setProperty(property, '');\n        }\n      }\n    });\n\n    if (element.style && element instanceof SVGTextElement && element.style.fill) {\n      setCustomProp('fill', 'color', element.style.getPropertyValue('fill'));\n    }\n\n    forEach(unsetProps, function (cssProp) {\n      element.removeAttribute(overrides[cssProp].dataAttr);\n    });\n    inlineStyleCache.set(element, getInlineStyleCacheKey(element, theme));\n  }\n\n  var metaThemeColorName = 'theme-color';\n  var metaThemeColorSelector = \"meta[name=\\\"\" + metaThemeColorName + \"\\\"]\";\n  var srcMetaThemeColor = null;\n  var observer = null;\n\n  function changeMetaThemeColor(meta, theme) {\n    srcMetaThemeColor = srcMetaThemeColor || meta.content;\n\n    try {\n      var color = parse(srcMetaThemeColor);\n      meta.content = modifyBackgroundColor(color, theme);\n    } catch (err) {\n      logWarn(err);\n    }\n  }\n\n  function changeMetaThemeColorWhenAvailable(theme) {\n    var meta = document.querySelector(metaThemeColorSelector);\n\n    if (meta) {\n      changeMetaThemeColor(meta, theme);\n    } else {\n      if (observer) {\n        observer.disconnect();\n      }\n\n      observer = new MutationObserver(function (mutations) {\n        loop: for (var i = 0; i < mutations.length; i++) {\n          var addedNodes = mutations[i].addedNodes;\n\n          for (var j = 0; j < addedNodes.length; j++) {\n            var node = addedNodes[j];\n\n            if (node instanceof HTMLMetaElement && node.name === metaThemeColorName) {\n              observer.disconnect();\n              observer = null;\n              changeMetaThemeColor(node, theme);\n              break loop;\n            }\n          }\n        }\n      });\n      observer.observe(document.head, {\n        childList: true\n      });\n    }\n  }\n\n  function restoreMetaThemeColor() {\n    if (observer) {\n      observer.disconnect();\n      observer = null;\n    }\n\n    var meta = document.querySelector(metaThemeColorSelector);\n\n    if (meta && srcMetaThemeColor) {\n      meta.content = srcMetaThemeColor;\n    }\n  }\n\n  var themeCacheKeys = ['mode', 'brightness', 'contrast', 'grayscale', 'sepia', 'darkSchemeBackgroundColor', 'darkSchemeTextColor', 'lightSchemeBackgroundColor', 'lightSchemeTextColor'];\n\n  function getThemeKey(theme) {\n    return themeCacheKeys.map(function (p) {\n      return p + \":\" + theme[p];\n    }).join(';');\n  }\n\n  var asyncQueue = createAsyncTasksQueue();\n\n  function createStyleSheetModifier() {\n    var renderId = 0;\n    var rulesTextCache = new Set();\n    var rulesModCache = new Map();\n    var varTypeChangeCleaners = new Set();\n    var prevFilterKey = null;\n    var hasNonLoadedLink = false;\n    var wasRebuilt = false;\n\n    function shouldRebuildStyle() {\n      return hasNonLoadedLink && !wasRebuilt;\n    }\n\n    function modifySheet(options) {\n      var rules = options.sourceCSSRules;\n      var theme = options.theme,\n          ignoreImageAnalysis = options.ignoreImageAnalysis,\n          force = options.force,\n          prepareSheet = options.prepareSheet,\n          isAsyncCancelled = options.isAsyncCancelled;\n      var rulesChanged = rulesModCache.size === 0;\n      var notFoundCacheKeys = new Set(rulesModCache.keys());\n      var themeKey = getThemeKey(theme);\n      var themeChanged = themeKey !== prevFilterKey;\n\n      if (hasNonLoadedLink) {\n        wasRebuilt = true;\n      }\n\n      var modRules = [];\n      iterateCSSRules(rules, function (rule) {\n        var cssText = rule.cssText;\n        var textDiffersFromPrev = false;\n        notFoundCacheKeys.delete(cssText);\n\n        if (rule.parentRule instanceof CSSMediaRule) {\n          cssText += \";\" + rule.parentRule.media.mediaText;\n        }\n\n        if (!rulesTextCache.has(cssText)) {\n          rulesTextCache.add(cssText);\n          textDiffersFromPrev = true;\n        }\n\n        if (textDiffersFromPrev) {\n          rulesChanged = true;\n        } else {\n          modRules.push(rulesModCache.get(cssText));\n          return;\n        }\n\n        var modDecs = [];\n        rule.style && iterateCSSDeclarations(rule.style, function (property, value) {\n          var mod = getModifiableCSSDeclaration(property, value, rule, variablesStore, ignoreImageAnalysis, isAsyncCancelled);\n\n          if (mod) {\n            modDecs.push(mod);\n          }\n        });\n        var modRule = null;\n\n        if (modDecs.length > 0) {\n          var parentRule = rule.parentRule;\n          modRule = {\n            selector: rule.selectorText,\n            declarations: modDecs,\n            parentRule: parentRule\n          };\n          modRules.push(modRule);\n        }\n\n        rulesModCache.set(cssText, modRule);\n      }, function () {\n        hasNonLoadedLink = true;\n      });\n      notFoundCacheKeys.forEach(function (key) {\n        rulesTextCache.delete(key);\n        rulesModCache.delete(key);\n      });\n      prevFilterKey = themeKey;\n\n      if (!force && !rulesChanged && !themeChanged) {\n        return;\n      }\n\n      renderId++;\n\n      function setRule(target, index, rule) {\n        var selector = rule.selector,\n            declarations = rule.declarations;\n\n        var getDeclarationText = function (dec) {\n          var property = dec.property,\n              value = dec.value,\n              important = dec.important,\n              sourceValue = dec.sourceValue;\n          return property + \": \" + (value == null ? sourceValue : value) + (important ? ' !important' : '') + \";\";\n        };\n\n        var cssRulesText = '';\n        declarations.forEach(function (declarations) {\n          cssRulesText += getDeclarationText(declarations) + \" \";\n        });\n        var ruleText = selector + \" { \" + cssRulesText + \" }\";\n        target.insertRule(ruleText, index);\n      }\n\n      var asyncDeclarations = new Map();\n      var varDeclarations = new Map();\n      var asyncDeclarationCounter = 0;\n      var varDeclarationCounter = 0;\n      var rootReadyGroup = {\n        rule: null,\n        rules: [],\n        isGroup: true\n      };\n      var groupRefs = new WeakMap();\n\n      function getGroup(rule) {\n        if (rule == null) {\n          return rootReadyGroup;\n        }\n\n        if (groupRefs.has(rule)) {\n          return groupRefs.get(rule);\n        }\n\n        var group = {\n          rule: rule,\n          rules: [],\n          isGroup: true\n        };\n        groupRefs.set(rule, group);\n        var parentGroup = getGroup(rule.parentRule);\n        parentGroup.rules.push(group);\n        return group;\n      }\n\n      varTypeChangeCleaners.forEach(function (clear) {\n        return clear();\n      });\n      varTypeChangeCleaners.clear();\n      modRules.filter(function (r) {\n        return r;\n      }).forEach(function (_a) {\n        var selector = _a.selector,\n            declarations = _a.declarations,\n            parentRule = _a.parentRule;\n        var group = getGroup(parentRule);\n        var readyStyleRule = {\n          selector: selector,\n          declarations: [],\n          isGroup: false\n        };\n        var readyDeclarations = readyStyleRule.declarations;\n        group.rules.push(readyStyleRule);\n\n        function handleAsyncDeclaration(property, modified, important, sourceValue) {\n          var asyncKey = ++asyncDeclarationCounter;\n          var asyncDeclaration = {\n            property: property,\n            value: null,\n            important: important,\n            asyncKey: asyncKey,\n            sourceValue: sourceValue\n          };\n          readyDeclarations.push(asyncDeclaration);\n          var currentRenderId = renderId;\n          modified.then(function (asyncValue) {\n            if (!asyncValue || isAsyncCancelled() || currentRenderId !== renderId) {\n              return;\n            }\n\n            asyncDeclaration.value = asyncValue;\n            asyncQueue.add(function () {\n              if (isAsyncCancelled() || currentRenderId !== renderId) {\n                return;\n              }\n\n              rebuildAsyncRule(asyncKey);\n            });\n          });\n        }\n\n        function handleVarDeclarations(property, modified, important, sourceValue) {\n          var _a = modified,\n              varDecs = _a.declarations,\n              onTypeChange = _a.onTypeChange;\n          var varKey = ++varDeclarationCounter;\n          var currentRenderId = renderId;\n          var initialIndex = readyDeclarations.length;\n          var oldDecs = [];\n\n          if (varDecs.length === 0) {\n            var tempDec = {\n              property: property,\n              value: sourceValue,\n              important: important,\n              sourceValue: sourceValue,\n              varKey: varKey\n            };\n            readyDeclarations.push(tempDec);\n            oldDecs = [tempDec];\n          }\n\n          varDecs.forEach(function (mod) {\n            if (mod.value instanceof Promise) {\n              handleAsyncDeclaration(mod.property, mod.value, important, sourceValue);\n            } else {\n              var readyDec = {\n                property: mod.property,\n                value: mod.value,\n                important: important,\n                sourceValue: sourceValue,\n                varKey: varKey\n              };\n              readyDeclarations.push(readyDec);\n              oldDecs.push(readyDec);\n            }\n          });\n          onTypeChange.addListener(function (newDecs) {\n            if (isAsyncCancelled() || currentRenderId !== renderId) {\n              return;\n            }\n\n            var readyVarDecs = newDecs.map(function (mod) {\n              return {\n                property: mod.property,\n                value: mod.value,\n                important: important,\n                sourceValue: sourceValue,\n                varKey: varKey\n              };\n            });\n            var index = readyDeclarations.indexOf(oldDecs[0], initialIndex);\n            readyDeclarations.splice.apply(readyDeclarations, __spreadArray([index, oldDecs.length], __read(readyVarDecs), false));\n            oldDecs = readyVarDecs;\n            rebuildVarRule(varKey);\n          });\n          varTypeChangeCleaners.add(function () {\n            return onTypeChange.removeListeners();\n          });\n        }\n\n        declarations.forEach(function (_a) {\n          var property = _a.property,\n              value = _a.value,\n              important = _a.important,\n              sourceValue = _a.sourceValue;\n\n          if (typeof value === 'function') {\n            var modified = value(theme);\n\n            if (modified instanceof Promise) {\n              handleAsyncDeclaration(property, modified, important, sourceValue);\n            } else if (property.startsWith('--')) {\n              handleVarDeclarations(property, modified, important, sourceValue);\n            } else {\n              readyDeclarations.push({\n                property: property,\n                value: modified,\n                important: important,\n                sourceValue: sourceValue\n              });\n            }\n          } else {\n            readyDeclarations.push({\n              property: property,\n              value: value,\n              important: important,\n              sourceValue: sourceValue\n            });\n          }\n        });\n      });\n      var sheet = prepareSheet();\n\n      function buildStyleSheet() {\n        function createTarget(group, parent) {\n          var rule = group.rule;\n\n          if (rule instanceof CSSMediaRule) {\n            var media = rule.media;\n            var index = parent.cssRules.length;\n            parent.insertRule(\"@media \" + media.mediaText + \" {}\", index);\n            return parent.cssRules[index];\n          }\n\n          return parent;\n        }\n\n        function iterateReadyRules(group, target, styleIterator) {\n          group.rules.forEach(function (r) {\n            if (r.isGroup) {\n              var t = createTarget(r, target);\n              iterateReadyRules(r, t, styleIterator);\n            } else {\n              styleIterator(r, target);\n            }\n          });\n        }\n\n        iterateReadyRules(rootReadyGroup, sheet, function (rule, target) {\n          var index = target.cssRules.length;\n          rule.declarations.forEach(function (_a) {\n            var asyncKey = _a.asyncKey,\n                varKey = _a.varKey;\n\n            if (asyncKey != null) {\n              asyncDeclarations.set(asyncKey, {\n                rule: rule,\n                target: target,\n                index: index\n              });\n            }\n\n            if (varKey != null) {\n              varDeclarations.set(varKey, {\n                rule: rule,\n                target: target,\n                index: index\n              });\n            }\n          });\n          setRule(target, index, rule);\n        });\n      }\n\n      function rebuildAsyncRule(key) {\n        var _a = asyncDeclarations.get(key),\n            rule = _a.rule,\n            target = _a.target,\n            index = _a.index;\n\n        target.deleteRule(index);\n        setRule(target, index, rule);\n        asyncDeclarations.delete(key);\n      }\n\n      function rebuildVarRule(key) {\n        var _a = varDeclarations.get(key),\n            rule = _a.rule,\n            target = _a.target,\n            index = _a.index;\n\n        target.deleteRule(index);\n        setRule(target, index, rule);\n      }\n\n      buildStyleSheet();\n    }\n\n    return {\n      modifySheet: modifySheet,\n      shouldRebuildStyle: shouldRebuildStyle\n    };\n  }\n\n  var STYLE_SELECTOR = 'style, link[rel*=\"stylesheet\" i]:not([disabled])';\n\n  function shouldManageStyle(element) {\n    return (element instanceof HTMLStyleElement || element instanceof SVGStyleElement || element instanceof HTMLLinkElement && element.rel && element.rel.toLowerCase().includes('stylesheet') && !element.disabled && (isFirefox ? !element.href.startsWith('moz-extension://') : true)) && !element.classList.contains('darkreader') && element.media.toLowerCase() !== 'print' && !element.classList.contains('stylus');\n  }\n\n  function getManageableStyles(node, results, deep) {\n    if (results === void 0) {\n      results = [];\n    }\n\n    if (deep === void 0) {\n      deep = true;\n    }\n\n    if (shouldManageStyle(node)) {\n      results.push(node);\n    } else if (node instanceof Element || isShadowDomSupported && node instanceof ShadowRoot || node === document) {\n      forEach(node.querySelectorAll(STYLE_SELECTOR), function (style) {\n        return getManageableStyles(style, results, false);\n      });\n\n      if (deep) {\n        iterateShadowHosts(node, function (host) {\n          return getManageableStyles(host.shadowRoot, results, false);\n        });\n      }\n    }\n\n    return results;\n  }\n\n  var syncStyleSet = new WeakSet();\n  var corsStyleSet = new WeakSet();\n  var canOptimizeUsingProxy$1 = false;\n\n  if (typeof document !== 'undefined') {\n    document.addEventListener('__darkreader__inlineScriptsAllowed', function () {\n      canOptimizeUsingProxy$1 = true;\n    });\n  }\n\n  var loadingLinkCounter = 0;\n  var rejectorsForLoadingLinks = new Map();\n\n  function cleanLoadingLinks() {\n    rejectorsForLoadingLinks.clear();\n  }\n\n  function manageStyle(element, _a) {\n    var update = _a.update,\n        loadingStart = _a.loadingStart,\n        loadingEnd = _a.loadingEnd;\n    var prevStyles = [];\n    var next = element;\n\n    while ((next = next.nextElementSibling) && next.matches('.darkreader')) {\n      prevStyles.push(next);\n    }\n\n    var corsCopy = prevStyles.find(function (el) {\n      return el.matches('.darkreader--cors') && !corsStyleSet.has(el);\n    }) || null;\n    var syncStyle = prevStyles.find(function (el) {\n      return el.matches('.darkreader--sync') && !syncStyleSet.has(el);\n    }) || null;\n    var corsCopyPositionWatcher = null;\n    var syncStylePositionWatcher = null;\n    var cancelAsyncOperations = false;\n    var isOverrideEmpty = true;\n    var sheetModifier = createStyleSheetModifier();\n    var observer = new MutationObserver(function () {\n      update();\n    });\n    var observerOptions = {\n      attributes: true,\n      childList: true,\n      subtree: true,\n      characterData: true\n    };\n\n    function containsCSSImport() {\n      return element instanceof HTMLStyleElement && element.textContent.trim().match(cssImportRegex);\n    }\n\n    function hasImports(cssRules, checkCrossOrigin) {\n      var result = false;\n\n      if (cssRules) {\n        var rule = void 0;\n\n        cssRulesLoop: for (var i = 0, len = cssRules.length; i < len; i++) {\n          rule = cssRules[i];\n\n          if (rule.href) {\n            if (checkCrossOrigin) {\n              if (rule.href.startsWith('http') && !rule.href.startsWith(location.origin)) {\n                result = true;\n                break cssRulesLoop;\n              }\n            } else {\n              result = true;\n              break cssRulesLoop;\n            }\n          }\n        }\n      }\n\n      return result;\n    }\n\n    function getRulesSync() {\n      if (corsCopy) {\n        logInfo('[getRulesSync] Using cors-copy.');\n        return corsCopy.sheet.cssRules;\n      }\n\n      if (containsCSSImport()) {\n        logInfo('[getRulesSync] CSSImport detected.');\n        return null;\n      }\n\n      var cssRules = safeGetSheetRules();\n\n      if (element instanceof HTMLLinkElement && !isRelativeHrefOnAbsolutePath(element.href) && hasImports(cssRules, false)) {\n        logInfo('[getRulesSync] CSSImportRule detected on non-local href.');\n        return null;\n      }\n\n      if (hasImports(cssRules, true)) {\n        logInfo('[getRulesSync] Cross-Origin CSSImportRule detected.');\n        return null;\n      }\n\n      logInfo('[getRulesSync] Using cssRules.');\n      !cssRules && logWarn('[getRulesSync] cssRules is null, trying again.');\n      return cssRules;\n    }\n\n    function insertStyle() {\n      if (corsCopy) {\n        if (element.nextSibling !== corsCopy) {\n          element.parentNode.insertBefore(corsCopy, element.nextSibling);\n        }\n\n        if (corsCopy.nextSibling !== syncStyle) {\n          element.parentNode.insertBefore(syncStyle, corsCopy.nextSibling);\n        }\n      } else if (element.nextSibling !== syncStyle) {\n        element.parentNode.insertBefore(syncStyle, element.nextSibling);\n      }\n    }\n\n    function createSyncStyle() {\n      syncStyle = element instanceof SVGStyleElement ? document.createElementNS('http://www.w3.org/2000/svg', 'style') : document.createElement('style');\n      syncStyle.classList.add('darkreader');\n      syncStyle.classList.add('darkreader--sync');\n      syncStyle.media = 'screen';\n\n      if (!isChromium && element.title) {\n        syncStyle.title = element.title;\n      }\n\n      syncStyleSet.add(syncStyle);\n    }\n\n    var isLoadingRules = false;\n    var wasLoadingError = false;\n    var loadingLinkId = ++loadingLinkCounter;\n\n    function getRulesAsync() {\n      return __awaiter(this, void 0, void 0, function () {\n        var cssText, cssBasePath, _a, cssRules, accessError, err_1, fullCSSText, err_2;\n\n        var _b;\n\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              if (!(element instanceof HTMLLinkElement)) return [3, 7];\n              _a = __read(getRulesOrError(), 2), cssRules = _a[0], accessError = _a[1];\n\n              if (accessError) {\n                logWarn(accessError);\n              }\n\n              if (!(!cssRules && !accessError && !isSafari || isSafari && !element.sheet || isStillLoadingError(accessError))) return [3, 5];\n              _c.label = 1;\n\n            case 1:\n              _c.trys.push([1, 3,, 4]);\n\n              logInfo(\"Linkelement \" + loadingLinkId + \" is not loaded yet and thus will be await for\", element);\n              return [4, linkLoading(element, loadingLinkId)];\n\n            case 2:\n              _c.sent();\n\n              return [3, 4];\n\n            case 3:\n              err_1 = _c.sent();\n              logWarn(err_1);\n              wasLoadingError = true;\n              return [3, 4];\n\n            case 4:\n              if (cancelAsyncOperations) {\n                return [2, null];\n              }\n\n              _b = __read(getRulesOrError(), 2), cssRules = _b[0], accessError = _b[1];\n\n              if (accessError) {\n                logWarn(accessError);\n              }\n\n              _c.label = 5;\n\n            case 5:\n              if (cssRules) {\n                if (!hasImports(cssRules, false)) {\n                  return [2, cssRules];\n                }\n              }\n\n              return [4, loadText(element.href)];\n\n            case 6:\n              cssText = _c.sent();\n              cssBasePath = getCSSBaseBath(element.href);\n\n              if (cancelAsyncOperations) {\n                return [2, null];\n              }\n\n              return [3, 8];\n\n            case 7:\n              if (containsCSSImport()) {\n                cssText = element.textContent.trim();\n                cssBasePath = getCSSBaseBath(location.href);\n              } else {\n                return [2, null];\n              }\n\n              _c.label = 8;\n\n            case 8:\n              if (!cssText) return [3, 13];\n              _c.label = 9;\n\n            case 9:\n              _c.trys.push([9, 11,, 12]);\n\n              return [4, replaceCSSImports(cssText, cssBasePath)];\n\n            case 10:\n              fullCSSText = _c.sent();\n              corsCopy = createCORSCopy(element, fullCSSText);\n              return [3, 12];\n\n            case 11:\n              err_2 = _c.sent();\n              logWarn(err_2);\n              return [3, 12];\n\n            case 12:\n              if (corsCopy) {\n                corsCopyPositionWatcher = watchForNodePosition(corsCopy, 'prev-sibling');\n                return [2, corsCopy.sheet.cssRules];\n              }\n\n              _c.label = 13;\n\n            case 13:\n              return [2, null];\n          }\n        });\n      });\n    }\n\n    function details(options) {\n      var rules = getRulesSync();\n\n      if (!rules) {\n        if (options.secondRound) {\n          logWarn('Detected dead-lock at details(), returning early to prevent it.');\n          return null;\n        }\n\n        if (isLoadingRules || wasLoadingError) {\n          return null;\n        }\n\n        isLoadingRules = true;\n        loadingStart();\n        getRulesAsync().then(function (results) {\n          isLoadingRules = false;\n          loadingEnd();\n\n          if (results) {\n            update();\n          }\n        }).catch(function (err) {\n          logWarn(err);\n          isLoadingRules = false;\n          loadingEnd();\n        });\n        return null;\n      }\n\n      return {\n        rules: rules\n      };\n    }\n\n    var forceRenderStyle = false;\n\n    function render(theme, ignoreImageAnalysis) {\n      var rules = getRulesSync();\n\n      if (!rules) {\n        return;\n      }\n\n      cancelAsyncOperations = false;\n\n      function removeCSSRulesFromSheet(sheet) {\n        try {\n          if (sheet.replaceSync) {\n            sheet.replaceSync('');\n            return;\n          }\n        } catch (err) {\n          logWarn('Could not use fastpath for removing rules from stylesheet', err);\n        }\n\n        for (var i = sheet.cssRules.length - 1; i >= 0; i--) {\n          sheet.deleteRule(i);\n        }\n      }\n\n      function prepareOverridesSheet() {\n        if (!syncStyle) {\n          createSyncStyle();\n        }\n\n        syncStylePositionWatcher && syncStylePositionWatcher.stop();\n        insertStyle();\n\n        if (syncStyle.sheet == null) {\n          syncStyle.textContent = '';\n        }\n\n        var sheet = syncStyle.sheet;\n        removeCSSRulesFromSheet(sheet);\n\n        if (syncStylePositionWatcher) {\n          syncStylePositionWatcher.run();\n        } else {\n          syncStylePositionWatcher = watchForNodePosition(syncStyle, 'prev-sibling', function () {\n            forceRenderStyle = true;\n            buildOverrides();\n          });\n        }\n\n        return syncStyle.sheet;\n      }\n\n      function buildOverrides() {\n        var force = forceRenderStyle;\n        forceRenderStyle = false;\n        sheetModifier.modifySheet({\n          prepareSheet: prepareOverridesSheet,\n          sourceCSSRules: rules,\n          theme: theme,\n          ignoreImageAnalysis: ignoreImageAnalysis,\n          force: force,\n          isAsyncCancelled: function () {\n            return cancelAsyncOperations;\n          }\n        });\n        isOverrideEmpty = syncStyle.sheet.cssRules.length === 0;\n\n        if (sheetModifier.shouldRebuildStyle()) {\n          addReadyStateCompleteListener(function () {\n            return update();\n          });\n        }\n      }\n\n      buildOverrides();\n    }\n\n    function getRulesOrError() {\n      try {\n        if (element.sheet == null) {\n          return [null, null];\n        }\n\n        return [element.sheet.cssRules, null];\n      } catch (err) {\n        return [null, err];\n      }\n    }\n\n    function isStillLoadingError(error) {\n      return error && error.message && error.message.includes('loading');\n    }\n\n    function safeGetSheetRules() {\n      var _a = __read(getRulesOrError(), 2),\n          cssRules = _a[0],\n          err = _a[1];\n\n      if (err) {\n        logWarn(err);\n        return null;\n      }\n\n      return cssRules;\n    }\n\n    function watchForSheetChanges() {\n      watchForSheetChangesUsingProxy();\n\n      if (!isThunderbird && !(canOptimizeUsingProxy$1 && element.sheet)) {\n        watchForSheetChangesUsingRAF();\n      }\n    }\n\n    var rulesChangeKey = null;\n    var rulesCheckFrameId = null;\n\n    function getRulesChangeKey() {\n      var rules = safeGetSheetRules();\n      return rules ? rules.length : null;\n    }\n\n    function didRulesKeyChange() {\n      return getRulesChangeKey() !== rulesChangeKey;\n    }\n\n    function watchForSheetChangesUsingRAF() {\n      rulesChangeKey = getRulesChangeKey();\n      stopWatchingForSheetChangesUsingRAF();\n\n      var checkForUpdate = function () {\n        if (didRulesKeyChange()) {\n          rulesChangeKey = getRulesChangeKey();\n          update();\n        }\n\n        if (canOptimizeUsingProxy$1 && element.sheet) {\n          stopWatchingForSheetChangesUsingRAF();\n          return;\n        }\n\n        rulesCheckFrameId = requestAnimationFrame(checkForUpdate);\n      };\n\n      checkForUpdate();\n    }\n\n    function stopWatchingForSheetChangesUsingRAF() {\n      cancelAnimationFrame(rulesCheckFrameId);\n    }\n\n    var areSheetChangesPending = false;\n\n    function onSheetChange() {\n      canOptimizeUsingProxy$1 = true;\n      stopWatchingForSheetChangesUsingRAF();\n\n      if (areSheetChangesPending) {\n        return;\n      }\n\n      function handleSheetChanges() {\n        areSheetChangesPending = false;\n\n        if (cancelAsyncOperations) {\n          return;\n        }\n\n        update();\n      }\n\n      areSheetChangesPending = true;\n\n      if (typeof queueMicrotask === 'function') {\n        queueMicrotask(handleSheetChanges);\n      } else {\n        requestAnimationFrame(handleSheetChanges);\n      }\n    }\n\n    function watchForSheetChangesUsingProxy() {\n      element.addEventListener('__darkreader__updateSheet', onSheetChange);\n    }\n\n    function stopWatchingForSheetChangesUsingProxy() {\n      element.removeEventListener('__darkreader__updateSheet', onSheetChange);\n    }\n\n    function stopWatchingForSheetChanges() {\n      stopWatchingForSheetChangesUsingProxy();\n      stopWatchingForSheetChangesUsingRAF();\n    }\n\n    function pause() {\n      observer.disconnect();\n      cancelAsyncOperations = true;\n      corsCopyPositionWatcher && corsCopyPositionWatcher.stop();\n      syncStylePositionWatcher && syncStylePositionWatcher.stop();\n      stopWatchingForSheetChanges();\n    }\n\n    function destroy() {\n      pause();\n      removeNode(corsCopy);\n      removeNode(syncStyle);\n      loadingEnd();\n\n      if (rejectorsForLoadingLinks.has(loadingLinkId)) {\n        var reject = rejectorsForLoadingLinks.get(loadingLinkId);\n        rejectorsForLoadingLinks.delete(loadingLinkId);\n        reject && reject();\n      }\n    }\n\n    function watch() {\n      observer.observe(element, observerOptions);\n\n      if (element instanceof HTMLStyleElement) {\n        watchForSheetChanges();\n      }\n    }\n\n    var maxMoveCount = 10;\n    var moveCount = 0;\n\n    function restore() {\n      if (!syncStyle) {\n        return;\n      }\n\n      moveCount++;\n\n      if (moveCount > maxMoveCount) {\n        logWarn('Style sheet was moved multiple times', element);\n        return;\n      }\n\n      logWarn('Restore style', syncStyle, element);\n      insertStyle();\n      corsCopyPositionWatcher && corsCopyPositionWatcher.skip();\n      syncStylePositionWatcher && syncStylePositionWatcher.skip();\n\n      if (!isOverrideEmpty) {\n        forceRenderStyle = true;\n        update();\n      }\n    }\n\n    return {\n      details: details,\n      render: render,\n      pause: pause,\n      destroy: destroy,\n      watch: watch,\n      restore: restore\n    };\n  }\n\n  function linkLoading(link, loadingId) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2, new Promise(function (resolve, reject) {\n          var cleanUp = function () {\n            link.removeEventListener('load', onLoad);\n            link.removeEventListener('error', onError);\n            rejectorsForLoadingLinks.delete(loadingId);\n          };\n\n          var onLoad = function () {\n            cleanUp();\n            logInfo(\"Linkelement \" + loadingId + \" has been loaded\");\n            resolve();\n          };\n\n          var onError = function () {\n            cleanUp();\n            reject(\"Linkelement \" + loadingId + \" couldn't be loaded. \" + link.href);\n          };\n\n          rejectorsForLoadingLinks.set(loadingId, function () {\n            cleanUp();\n            reject();\n          });\n          link.addEventListener('load', onLoad);\n          link.addEventListener('error', onError);\n\n          if (!link.href) {\n            onError();\n          }\n        })];\n      });\n    });\n  }\n\n  function getCSSImportURL(importDeclaration) {\n    return getCSSURLValue(importDeclaration.substring(7).trim().replace(/;$/, '').replace(/screen$/, ''));\n  }\n\n  function loadText(url) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!url.startsWith('data:')) return [3, 3];\n            return [4, fetch(url)];\n\n          case 1:\n            return [4, _a.sent().text()];\n\n          case 2:\n            return [2, _a.sent()];\n\n          case 3:\n            return [4, bgFetch({\n              url: url,\n              responseType: 'text',\n              mimeType: 'text/css',\n              origin: window.location.origin\n            })];\n\n          case 4:\n            return [2, _a.sent()];\n        }\n      });\n    });\n  }\n\n  function replaceCSSImports(cssText, basePath, cache) {\n    if (cache === void 0) {\n      cache = new Map();\n    }\n\n    return __awaiter(this, void 0, void 0, function () {\n      var importMatches, importMatches_1, importMatches_1_1, match, importURL, absoluteURL, importedCSS, err_3, e_1_1;\n\n      var e_1, _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            cssText = removeCSSComments(cssText);\n            cssText = replaceCSSFontFace(cssText);\n            cssText = replaceCSSRelativeURLsWithAbsolute(cssText, basePath);\n            importMatches = getMatches(cssImportRegex, cssText);\n            _b.label = 1;\n\n          case 1:\n            _b.trys.push([1, 10, 11, 12]);\n\n            importMatches_1 = __values(importMatches), importMatches_1_1 = importMatches_1.next();\n            _b.label = 2;\n\n          case 2:\n            if (!!importMatches_1_1.done) return [3, 9];\n            match = importMatches_1_1.value;\n            importURL = getCSSImportURL(match);\n            absoluteURL = getAbsoluteURL(basePath, importURL);\n            importedCSS = void 0;\n            if (!cache.has(absoluteURL)) return [3, 3];\n            importedCSS = cache.get(absoluteURL);\n            return [3, 7];\n\n          case 3:\n            _b.trys.push([3, 6,, 7]);\n\n            return [4, loadText(absoluteURL)];\n\n          case 4:\n            importedCSS = _b.sent();\n            cache.set(absoluteURL, importedCSS);\n            return [4, replaceCSSImports(importedCSS, getCSSBaseBath(absoluteURL), cache)];\n\n          case 5:\n            importedCSS = _b.sent();\n            return [3, 7];\n\n          case 6:\n            err_3 = _b.sent();\n            logWarn(err_3);\n            importedCSS = '';\n            return [3, 7];\n\n          case 7:\n            cssText = cssText.split(match).join(importedCSS);\n            _b.label = 8;\n\n          case 8:\n            importMatches_1_1 = importMatches_1.next();\n            return [3, 2];\n\n          case 9:\n            return [3, 12];\n\n          case 10:\n            e_1_1 = _b.sent();\n            e_1 = {\n              error: e_1_1\n            };\n            return [3, 12];\n\n          case 11:\n            try {\n              if (importMatches_1_1 && !importMatches_1_1.done && (_a = importMatches_1.return)) _a.call(importMatches_1);\n            } finally {\n              if (e_1) throw e_1.error;\n            }\n\n            return [7];\n\n          case 12:\n            cssText = cssText.trim();\n            return [2, cssText];\n        }\n      });\n    });\n  }\n\n  function createCORSCopy(srcElement, cssText) {\n    if (!cssText) {\n      return null;\n    }\n\n    var cors = document.createElement('style');\n    cors.classList.add('darkreader');\n    cors.classList.add('darkreader--cors');\n    cors.media = 'screen';\n    cors.textContent = cssText;\n    srcElement.parentNode.insertBefore(cors, srcElement.nextSibling);\n    cors.sheet.disabled = true;\n    corsStyleSet.add(cors);\n    return cors;\n  }\n\n  var observers = [];\n  var observedRoots;\n  var undefinedGroups = new Map();\n  var elementsDefinitionCallback;\n\n  function collectUndefinedElements(root) {\n    if (!isDefinedSelectorSupported) {\n      return;\n    }\n\n    forEach(root.querySelectorAll(':not(:defined)'), function (el) {\n      var tag = el.tagName.toLowerCase();\n\n      if (!tag.includes('-')) {\n        var extendedTag = el.getAttribute('is');\n\n        if (extendedTag) {\n          tag = extendedTag;\n        } else {\n          return;\n        }\n      }\n\n      if (!undefinedGroups.has(tag)) {\n        undefinedGroups.set(tag, new Set());\n        customElementsWhenDefined(tag).then(function () {\n          if (elementsDefinitionCallback) {\n            var elements = undefinedGroups.get(tag);\n            undefinedGroups.delete(tag);\n            elementsDefinitionCallback(Array.from(elements));\n          }\n        });\n      }\n\n      undefinedGroups.get(tag).add(el);\n    });\n  }\n\n  var canOptimizeUsingProxy = false;\n\n  if (typeof document !== 'undefined') {\n    document.addEventListener('__darkreader__inlineScriptsAllowed', function () {\n      canOptimizeUsingProxy = true;\n    });\n  }\n\n  var resolvers = new Map();\n\n  function handleIsDefined(e) {\n    canOptimizeUsingProxy = true;\n\n    if (resolvers.has(e.detail.tag)) {\n      var resolve = resolvers.get(e.detail.tag);\n      resolve();\n    }\n  }\n\n  function customElementsWhenDefined(tag) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2, new Promise(function (resolve) {\n          if (window.customElements && typeof customElements.whenDefined === 'function') {\n            customElements.whenDefined(tag).then(function () {\n              return resolve();\n            });\n          } else if (canOptimizeUsingProxy) {\n            resolvers.set(tag, resolve);\n            document.dispatchEvent(new CustomEvent('__darkreader__addUndefinedResolver', {\n              detail: {\n                tag: tag\n              }\n            }));\n          } else {\n            var checkIfDefined_1 = function () {\n              var elements = undefinedGroups.get(tag);\n\n              if (elements && elements.size > 0) {\n                if (elements.values().next().value.matches(':defined')) {\n                  resolve();\n                } else {\n                  requestAnimationFrame(checkIfDefined_1);\n                }\n              }\n            };\n\n            requestAnimationFrame(checkIfDefined_1);\n          }\n        })];\n      });\n    });\n  }\n\n  function watchWhenCustomElementsDefined(callback) {\n    elementsDefinitionCallback = callback;\n  }\n\n  function unsubscribeFromDefineCustomElements() {\n    elementsDefinitionCallback = null;\n    undefinedGroups.clear();\n    document.removeEventListener('__darkreader__isDefined', handleIsDefined);\n  }\n\n  function watchForStyleChanges(currentStyles, update, shadowRootDiscovered) {\n    stopWatchingForStyleChanges();\n    var prevStyles = new Set(currentStyles);\n    var prevStyleSiblings = new WeakMap();\n    var nextStyleSiblings = new WeakMap();\n\n    function saveStylePosition(style) {\n      prevStyleSiblings.set(style, style.previousElementSibling);\n      nextStyleSiblings.set(style, style.nextElementSibling);\n    }\n\n    function forgetStylePosition(style) {\n      prevStyleSiblings.delete(style);\n      nextStyleSiblings.delete(style);\n    }\n\n    function didStylePositionChange(style) {\n      return style.previousElementSibling !== prevStyleSiblings.get(style) || style.nextElementSibling !== nextStyleSiblings.get(style);\n    }\n\n    currentStyles.forEach(saveStylePosition);\n\n    function handleStyleOperations(operations) {\n      var createdStyles = operations.createdStyles,\n          removedStyles = operations.removedStyles,\n          movedStyles = operations.movedStyles;\n      createdStyles.forEach(function (s) {\n        return saveStylePosition(s);\n      });\n      movedStyles.forEach(function (s) {\n        return saveStylePosition(s);\n      });\n      removedStyles.forEach(function (s) {\n        return forgetStylePosition(s);\n      });\n      createdStyles.forEach(function (s) {\n        return prevStyles.add(s);\n      });\n      removedStyles.forEach(function (s) {\n        return prevStyles.delete(s);\n      });\n\n      if (createdStyles.size + removedStyles.size + movedStyles.size > 0) {\n        update({\n          created: Array.from(createdStyles),\n          removed: Array.from(removedStyles),\n          moved: Array.from(movedStyles),\n          updated: []\n        });\n      }\n    }\n\n    function handleMinorTreeMutations(_a) {\n      var additions = _a.additions,\n          moves = _a.moves,\n          deletions = _a.deletions;\n      var createdStyles = new Set();\n      var removedStyles = new Set();\n      var movedStyles = new Set();\n      additions.forEach(function (node) {\n        return getManageableStyles(node).forEach(function (style) {\n          return createdStyles.add(style);\n        });\n      });\n      deletions.forEach(function (node) {\n        return getManageableStyles(node).forEach(function (style) {\n          return removedStyles.add(style);\n        });\n      });\n      moves.forEach(function (node) {\n        return getManageableStyles(node).forEach(function (style) {\n          return movedStyles.add(style);\n        });\n      });\n      handleStyleOperations({\n        createdStyles: createdStyles,\n        removedStyles: removedStyles,\n        movedStyles: movedStyles\n      });\n      additions.forEach(function (n) {\n        iterateShadowHosts(n, subscribeForShadowRootChanges);\n        collectUndefinedElements(n);\n      });\n    }\n\n    function handleHugeTreeMutations(root) {\n      var styles = new Set(getManageableStyles(root));\n      var createdStyles = new Set();\n      var removedStyles = new Set();\n      var movedStyles = new Set();\n      styles.forEach(function (s) {\n        if (!prevStyles.has(s)) {\n          createdStyles.add(s);\n        }\n      });\n      prevStyles.forEach(function (s) {\n        if (!styles.has(s)) {\n          removedStyles.add(s);\n        }\n      });\n      styles.forEach(function (s) {\n        if (!createdStyles.has(s) && !removedStyles.has(s) && didStylePositionChange(s)) {\n          movedStyles.add(s);\n        }\n      });\n      handleStyleOperations({\n        createdStyles: createdStyles,\n        removedStyles: removedStyles,\n        movedStyles: movedStyles\n      });\n      iterateShadowHosts(root, subscribeForShadowRootChanges);\n      collectUndefinedElements(root);\n    }\n\n    function handleAttributeMutations(mutations) {\n      var updatedStyles = new Set();\n      var removedStyles = new Set();\n      mutations.forEach(function (m) {\n        var target = m.target;\n\n        if (target.isConnected) {\n          if (shouldManageStyle(target)) {\n            updatedStyles.add(target);\n          } else if (target instanceof HTMLLinkElement && target.disabled) {\n            removedStyles.add(target);\n          }\n        }\n      });\n\n      if (updatedStyles.size + removedStyles.size > 0) {\n        update({\n          updated: Array.from(updatedStyles),\n          created: [],\n          removed: Array.from(removedStyles),\n          moved: []\n        });\n      }\n    }\n\n    function observe(root) {\n      var treeObserver = createOptimizedTreeObserver(root, {\n        onMinorMutations: handleMinorTreeMutations,\n        onHugeMutations: handleHugeTreeMutations\n      });\n      var attrObserver = new MutationObserver(handleAttributeMutations);\n      attrObserver.observe(root, {\n        attributes: true,\n        attributeFilter: ['rel', 'disabled', 'media'],\n        subtree: true\n      });\n      observers.push(treeObserver, attrObserver);\n      observedRoots.add(root);\n    }\n\n    function subscribeForShadowRootChanges(node) {\n      var shadowRoot = node.shadowRoot;\n\n      if (shadowRoot == null || observedRoots.has(shadowRoot)) {\n        return;\n      }\n\n      observe(shadowRoot);\n      shadowRootDiscovered(shadowRoot);\n    }\n\n    observe(document);\n    iterateShadowHosts(document.documentElement, subscribeForShadowRootChanges);\n    watchWhenCustomElementsDefined(function (hosts) {\n      var newStyles = [];\n      hosts.forEach(function (host) {\n        return push(newStyles, getManageableStyles(host.shadowRoot));\n      });\n      update({\n        created: newStyles,\n        updated: [],\n        removed: [],\n        moved: []\n      });\n      hosts.forEach(function (host) {\n        var shadowRoot = host.shadowRoot;\n\n        if (shadowRoot == null) {\n          return;\n        }\n\n        subscribeForShadowRootChanges(host);\n        iterateShadowHosts(shadowRoot, subscribeForShadowRootChanges);\n        collectUndefinedElements(shadowRoot);\n      });\n    });\n    document.addEventListener('__darkreader__isDefined', handleIsDefined);\n    collectUndefinedElements(document);\n  }\n\n  function resetObservers() {\n    observers.forEach(function (o) {\n      return o.disconnect();\n    });\n    observers.splice(0, observers.length);\n    observedRoots = new WeakSet();\n  }\n\n  function stopWatchingForStyleChanges() {\n    resetObservers();\n    unsubscribeFromDefineCustomElements();\n  }\n\n  function hexify(number) {\n    return (number < 16 ? '0' : '') + number.toString(16);\n  }\n\n  function generateUID() {\n    if (typeof crypto === 'undefined') return 'xxx-xxxx';\n\n    if ('randomUUID' in crypto) {\n      var uuid = crypto.randomUUID();\n      return uuid.substring(0, 8) + uuid.substring(9, 13) + uuid.substring(14, 18) + uuid.substring(19, 23) + uuid.substring(24);\n    }\n\n    return Array.from(crypto.getRandomValues(new Uint8Array(16))).map(function (x) {\n      return hexify(x);\n    }).join('');\n  }\n\n  var adoptedStyleOverrides = new WeakMap();\n  var overrideList = new WeakSet();\n\n  function createAdoptedStyleSheetOverride(node) {\n    var cancelAsyncOperations = false;\n\n    function injectSheet(sheet, override) {\n      var newSheets = __spreadArray([], __read(node.adoptedStyleSheets), false);\n\n      var sheetIndex = newSheets.indexOf(sheet);\n      var existingIndex = newSheets.indexOf(override);\n\n      if (sheetIndex === existingIndex - 1) {\n        return;\n      }\n\n      if (existingIndex >= 0) {\n        newSheets.splice(existingIndex, 1);\n      }\n\n      newSheets.splice(sheetIndex + 1, 0, override);\n      node.adoptedStyleSheets = newSheets;\n    }\n\n    function destroy() {\n      cancelAsyncOperations = true;\n\n      var newSheets = __spreadArray([], __read(node.adoptedStyleSheets), false);\n\n      node.adoptedStyleSheets.forEach(function (adoptedStyleSheet) {\n        if (overrideList.has(adoptedStyleSheet)) {\n          var existingIndex = newSheets.indexOf(adoptedStyleSheet);\n\n          if (existingIndex >= 0) {\n            newSheets.splice(existingIndex, 1);\n          }\n\n          adoptedStyleOverrides.delete(adoptedStyleSheet);\n          overrideList.delete(adoptedStyleSheet);\n        }\n      });\n      node.adoptedStyleSheets = newSheets;\n    }\n\n    function render(theme, ignoreImageAnalysis) {\n      node.adoptedStyleSheets.forEach(function (sheet) {\n        if (overrideList.has(sheet)) {\n          return;\n        }\n\n        var rules = sheet.rules;\n        var override = new CSSStyleSheet();\n\n        function prepareOverridesSheet() {\n          for (var i = override.cssRules.length - 1; i >= 0; i--) {\n            override.deleteRule(i);\n          }\n\n          injectSheet(sheet, override);\n          adoptedStyleOverrides.set(sheet, override);\n          overrideList.add(override);\n          return override;\n        }\n\n        var sheetModifier = createStyleSheetModifier();\n        sheetModifier.modifySheet({\n          prepareSheet: prepareOverridesSheet,\n          sourceCSSRules: rules,\n          theme: theme,\n          ignoreImageAnalysis: ignoreImageAnalysis,\n          force: false,\n          isAsyncCancelled: function () {\n            return cancelAsyncOperations;\n          }\n        });\n      });\n    }\n\n    return {\n      render: render,\n      destroy: destroy\n    };\n  }\n\n  function injectProxy(enableStyleSheetsProxy) {\n    document.dispatchEvent(new CustomEvent('__darkreader__inlineScriptsAllowed'));\n    var addRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'addRule');\n    var insertRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'insertRule');\n    var deleteRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'deleteRule');\n    var removeRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'removeRule');\n    var documentStyleSheetsDescriptor = enableStyleSheetsProxy ? Object.getOwnPropertyDescriptor(Document.prototype, 'styleSheets') : null;\n    var shouldWrapHTMLElement = location.hostname.endsWith('baidu.com');\n    var getElementsByTagNameDescriptor = shouldWrapHTMLElement ? Object.getOwnPropertyDescriptor(Element.prototype, 'getElementsByTagName') : null;\n\n    var cleanUp = function () {\n      Object.defineProperty(CSSStyleSheet.prototype, 'addRule', addRuleDescriptor);\n      Object.defineProperty(CSSStyleSheet.prototype, 'insertRule', insertRuleDescriptor);\n      Object.defineProperty(CSSStyleSheet.prototype, 'deleteRule', deleteRuleDescriptor);\n      Object.defineProperty(CSSStyleSheet.prototype, 'removeRule', removeRuleDescriptor);\n      document.removeEventListener('__darkreader__cleanUp', cleanUp);\n      document.removeEventListener('__darkreader__addUndefinedResolver', addUndefinedResolver);\n\n      if (enableStyleSheetsProxy) {\n        Object.defineProperty(Document.prototype, 'styleSheets', documentStyleSheetsDescriptor);\n      }\n\n      if (shouldWrapHTMLElement) {\n        Object.defineProperty(Element.prototype, 'getElementsByTagName', getElementsByTagNameDescriptor);\n      }\n    };\n\n    var addUndefinedResolver = function (e) {\n      customElements.whenDefined(e.detail.tag).then(function () {\n        document.dispatchEvent(new CustomEvent('__darkreader__isDefined', {\n          detail: {\n            tag: e.detail.tag\n          }\n        }));\n      });\n    };\n\n    document.addEventListener('__darkreader__cleanUp', cleanUp);\n    document.addEventListener('__darkreader__addUndefinedResolver', addUndefinedResolver);\n    var updateSheetEvent = new Event('__darkreader__updateSheet');\n\n    function proxyAddRule(selector, style, index) {\n      addRuleDescriptor.value.call(this, selector, style, index);\n\n      if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\n        this.ownerNode.dispatchEvent(updateSheetEvent);\n      }\n\n      return -1;\n    }\n\n    function proxyInsertRule(rule, index) {\n      var returnValue = insertRuleDescriptor.value.call(this, rule, index);\n\n      if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\n        this.ownerNode.dispatchEvent(updateSheetEvent);\n      }\n\n      return returnValue;\n    }\n\n    function proxyDeleteRule(index) {\n      deleteRuleDescriptor.value.call(this, index);\n\n      if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\n        this.ownerNode.dispatchEvent(updateSheetEvent);\n      }\n    }\n\n    function proxyRemoveRule(index) {\n      removeRuleDescriptor.value.call(this, index);\n\n      if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\n        this.ownerNode.dispatchEvent(updateSheetEvent);\n      }\n    }\n\n    function proxyDocumentStyleSheets() {\n      var docSheets = documentStyleSheetsDescriptor.get.call(this);\n\n      var filtered = __spreadArray([], __read(docSheets), false).filter(function (styleSheet) {\n        return !styleSheet.ownerNode.classList.contains('darkreader');\n      });\n\n      return Object.setPrototypeOf(filtered, StyleSheetList.prototype);\n    }\n\n    function proxyGetElementsByTagName(tagName) {\n      var _this = this;\n\n      if (tagName !== 'style') {\n        return getElementsByTagNameDescriptor.value.call(this, tagName);\n      }\n\n      var getCurrentElementValue = function () {\n        var elements = getElementsByTagNameDescriptor.value.call(_this, tagName);\n        return Object.setPrototypeOf(__spreadArray([], __read(elements), false).filter(function (element) {\n          return !element.classList.contains('darkreader');\n        }), NodeList.prototype);\n      };\n\n      var elements = getCurrentElementValue();\n      var NodeListBehavior = {\n        get: function (_, property) {\n          return getCurrentElementValue()[Number(property)];\n        }\n      };\n      elements = new Proxy(elements, NodeListBehavior);\n      return elements;\n    }\n\n    Object.defineProperty(CSSStyleSheet.prototype, 'addRule', Object.assign({}, addRuleDescriptor, {\n      value: proxyAddRule\n    }));\n    Object.defineProperty(CSSStyleSheet.prototype, 'insertRule', Object.assign({}, insertRuleDescriptor, {\n      value: proxyInsertRule\n    }));\n    Object.defineProperty(CSSStyleSheet.prototype, 'deleteRule', Object.assign({}, deleteRuleDescriptor, {\n      value: proxyDeleteRule\n    }));\n    Object.defineProperty(CSSStyleSheet.prototype, 'removeRule', Object.assign({}, removeRuleDescriptor, {\n      value: proxyRemoveRule\n    }));\n\n    if (enableStyleSheetsProxy) {\n      Object.defineProperty(Document.prototype, 'styleSheets', Object.assign({}, documentStyleSheetsDescriptor, {\n        get: proxyDocumentStyleSheets\n      }));\n    }\n\n    if (shouldWrapHTMLElement) {\n      Object.defineProperty(Element.prototype, 'getElementsByTagName', Object.assign({}, getElementsByTagNameDescriptor, {\n        value: proxyGetElementsByTagName\n      }));\n    }\n  }\n\n  var INSTANCE_ID = generateUID();\n  var styleManagers = new Map();\n  var adoptedStyleManagers = [];\n  var filter = null;\n  var fixes = null;\n  var isIFrame$1 = null;\n  var ignoredImageAnalysisSelectors = null;\n  var ignoredInlineSelectors = null;\n\n  function createOrUpdateStyle(className, root) {\n    if (root === void 0) {\n      root = document.head || document;\n    }\n\n    var element = root.querySelector(\".\" + className);\n\n    if (!element) {\n      element = document.createElement('style');\n      element.classList.add('darkreader');\n      element.classList.add(className);\n      element.media = 'screen';\n      element.textContent = '';\n    }\n\n    return element;\n  }\n\n  function createOrUpdateScript(className, root) {\n    if (root === void 0) {\n      root = document.head || document;\n    }\n\n    var element = root.querySelector(\".\" + className);\n\n    if (!element) {\n      element = document.createElement('script');\n      element.classList.add('darkreader');\n      element.classList.add(className);\n    }\n\n    return element;\n  }\n\n  var nodePositionWatchers = new Map();\n\n  function setupNodePositionWatcher(node, alias) {\n    nodePositionWatchers.has(alias) && nodePositionWatchers.get(alias).stop();\n    nodePositionWatchers.set(alias, watchForNodePosition(node, 'parent'));\n  }\n\n  function stopStylePositionWatchers() {\n    forEach(nodePositionWatchers.values(), function (watcher) {\n      return watcher.stop();\n    });\n    nodePositionWatchers.clear();\n  }\n\n  function createStaticStyleOverrides() {\n    var fallbackStyle = createOrUpdateStyle('darkreader--fallback', document);\n    fallbackStyle.textContent = getModifiedFallbackStyle(filter, {\n      strict: true\n    });\n    document.head.insertBefore(fallbackStyle, document.head.firstChild);\n    setupNodePositionWatcher(fallbackStyle, 'fallback');\n    var userAgentStyle = createOrUpdateStyle('darkreader--user-agent');\n    userAgentStyle.textContent = getModifiedUserAgentStyle(filter, isIFrame$1, filter.styleSystemControls);\n    document.head.insertBefore(userAgentStyle, fallbackStyle.nextSibling);\n    setupNodePositionWatcher(userAgentStyle, 'user-agent');\n    var textStyle = createOrUpdateStyle('darkreader--text');\n\n    if (filter.useFont || filter.textStroke > 0) {\n      textStyle.textContent = createTextStyle(filter);\n    } else {\n      textStyle.textContent = '';\n    }\n\n    document.head.insertBefore(textStyle, fallbackStyle.nextSibling);\n    setupNodePositionWatcher(textStyle, 'text');\n    var invertStyle = createOrUpdateStyle('darkreader--invert');\n\n    if (fixes && Array.isArray(fixes.invert) && fixes.invert.length > 0) {\n      invertStyle.textContent = [fixes.invert.join(', ') + \" {\", \"    filter: \" + getCSSFilterValue(__assign(__assign({}, filter), {\n        contrast: filter.mode === 0 ? filter.contrast : clamp(filter.contrast - 10, 0, 100)\n      })) + \" !important;\", '}'].join('\\n');\n    } else {\n      invertStyle.textContent = '';\n    }\n\n    document.head.insertBefore(invertStyle, textStyle.nextSibling);\n    setupNodePositionWatcher(invertStyle, 'invert');\n    var inlineStyle = createOrUpdateStyle('darkreader--inline');\n    inlineStyle.textContent = getInlineOverrideStyle();\n    document.head.insertBefore(inlineStyle, invertStyle.nextSibling);\n    setupNodePositionWatcher(inlineStyle, 'inline');\n    var overrideStyle = createOrUpdateStyle('darkreader--override');\n    overrideStyle.textContent = fixes && fixes.css ? replaceCSSTemplates(fixes.css) : '';\n    document.head.appendChild(overrideStyle);\n    setupNodePositionWatcher(overrideStyle, 'override');\n    var variableStyle = createOrUpdateStyle('darkreader--variables');\n    var selectionColors = getSelectionColor(filter);\n    var darkSchemeBackgroundColor = filter.darkSchemeBackgroundColor,\n        darkSchemeTextColor = filter.darkSchemeTextColor,\n        lightSchemeBackgroundColor = filter.lightSchemeBackgroundColor,\n        lightSchemeTextColor = filter.lightSchemeTextColor,\n        mode = filter.mode;\n    var schemeBackgroundColor = mode === 0 ? lightSchemeBackgroundColor : darkSchemeBackgroundColor;\n    var schemeTextColor = mode === 0 ? lightSchemeTextColor : darkSchemeTextColor;\n    schemeBackgroundColor = modifyBackgroundColor(parse(schemeBackgroundColor), filter);\n    schemeTextColor = modifyForegroundColor(parse(schemeTextColor), filter);\n    variableStyle.textContent = [\":root {\", \"   --darkreader-neutral-background: \" + schemeBackgroundColor + \";\", \"   --darkreader-neutral-text: \" + schemeTextColor + \";\", \"   --darkreader-selection-background: \" + selectionColors.backgroundColorSelection + \";\", \"   --darkreader-selection-text: \" + selectionColors.foregroundColorSelection + \";\", \"}\"].join('\\n');\n    document.head.insertBefore(variableStyle, inlineStyle.nextSibling);\n    setupNodePositionWatcher(variableStyle, 'variables');\n    var rootVarsStyle = createOrUpdateStyle('darkreader--root-vars');\n    document.head.insertBefore(rootVarsStyle, variableStyle.nextSibling);\n    var proxyScript = createOrUpdateScript('darkreader--proxy');\n    proxyScript.append(\"(\" + injectProxy + \")(!\" + (fixes && fixes.disableStyleSheetsProxy) + \")\");\n    document.head.insertBefore(proxyScript, rootVarsStyle.nextSibling);\n    proxyScript.remove();\n  }\n\n  var shadowRootsWithOverrides = new Set();\n\n  function createShadowStaticStyleOverrides(root) {\n    var inlineStyle = createOrUpdateStyle('darkreader--inline', root);\n    inlineStyle.textContent = getInlineOverrideStyle();\n    root.insertBefore(inlineStyle, root.firstChild);\n    var overrideStyle = createOrUpdateStyle('darkreader--override', root);\n    overrideStyle.textContent = fixes && fixes.css ? replaceCSSTemplates(fixes.css) : '';\n    root.insertBefore(overrideStyle, inlineStyle.nextSibling);\n    var invertStyle = createOrUpdateStyle('darkreader--invert', root);\n\n    if (fixes && Array.isArray(fixes.invert) && fixes.invert.length > 0) {\n      invertStyle.textContent = [fixes.invert.join(', ') + \" {\", \"    filter: \" + getCSSFilterValue(__assign(__assign({}, filter), {\n        contrast: filter.mode === 0 ? filter.contrast : clamp(filter.contrast - 10, 0, 100)\n      })) + \" !important;\", '}'].join('\\n');\n    } else {\n      invertStyle.textContent = '';\n    }\n\n    root.insertBefore(invertStyle, overrideStyle.nextSibling);\n    shadowRootsWithOverrides.add(root);\n  }\n\n  function replaceCSSTemplates($cssText) {\n    return $cssText.replace(/\\${(.+?)}/g, function (_, $color) {\n      var color = tryParseColor($color);\n\n      if (color) {\n        return modifyColor(color, filter);\n      }\n\n      logWarn(\"Couldn't parse CSSTemplate's color.\");\n      return $color;\n    });\n  }\n\n  function cleanFallbackStyle() {\n    var fallback = document.querySelector('.darkreader--fallback');\n\n    if (fallback) {\n      fallback.textContent = '';\n    }\n  }\n\n  function createDynamicStyleOverrides() {\n    cancelRendering();\n    var allStyles = getManageableStyles(document);\n    var newManagers = allStyles.filter(function (style) {\n      return !styleManagers.has(style);\n    }).map(function (style) {\n      return createManager(style);\n    });\n    newManagers.map(function (manager) {\n      return manager.details({\n        secondRound: false\n      });\n    }).filter(function (detail) {\n      return detail && detail.rules.length > 0;\n    }).forEach(function (detail) {\n      variablesStore.addRulesForMatching(detail.rules);\n    });\n    variablesStore.matchVariablesAndDependants();\n    variablesStore.setOnRootVariableChange(function () {\n      variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\n    });\n    variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\n    styleManagers.forEach(function (manager) {\n      return manager.render(filter, ignoredImageAnalysisSelectors);\n    });\n\n    if (loadingStyles.size === 0) {\n      cleanFallbackStyle();\n    }\n\n    newManagers.forEach(function (manager) {\n      return manager.watch();\n    });\n    var inlineStyleElements = toArray(document.querySelectorAll(INLINE_STYLE_SELECTOR));\n    iterateShadowHosts(document.documentElement, function (host) {\n      createShadowStaticStyleOverrides(host.shadowRoot);\n      var elements = host.shadowRoot.querySelectorAll(INLINE_STYLE_SELECTOR);\n\n      if (elements.length > 0) {\n        push(inlineStyleElements, elements);\n      }\n    });\n    inlineStyleElements.forEach(function (el) {\n      return overrideInlineStyle(el, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors);\n    });\n    handleAdoptedStyleSheets(document);\n  }\n\n  var loadingStylesCounter = 0;\n  var loadingStyles = new Set();\n\n  function createManager(element) {\n    var loadingStyleId = ++loadingStylesCounter;\n    logInfo(\"New manager for element, with loadingStyleID \" + loadingStyleId, element);\n\n    function loadingStart() {\n      if (!isDOMReady() || !didDocumentShowUp) {\n        loadingStyles.add(loadingStyleId);\n        logInfo(\"Current amount of styles loading: \" + loadingStyles.size);\n        var fallbackStyle = document.querySelector('.darkreader--fallback');\n\n        if (!fallbackStyle.textContent) {\n          fallbackStyle.textContent = getModifiedFallbackStyle(filter, {\n            strict: false\n          });\n        }\n      }\n    }\n\n    function loadingEnd() {\n      loadingStyles.delete(loadingStyleId);\n      logInfo(\"Removed loadingStyle \" + loadingStyleId + \", now awaiting: \" + loadingStyles.size);\n      logInfo(\"To-do to be loaded\", loadingStyles);\n\n      if (loadingStyles.size === 0 && isDOMReady()) {\n        cleanFallbackStyle();\n      }\n    }\n\n    function update() {\n      var details = manager.details({\n        secondRound: true\n      });\n\n      if (!details) {\n        return;\n      }\n\n      variablesStore.addRulesForMatching(details.rules);\n      variablesStore.matchVariablesAndDependants();\n      manager.render(filter, ignoredImageAnalysisSelectors);\n    }\n\n    var manager = manageStyle(element, {\n      update: update,\n      loadingStart: loadingStart,\n      loadingEnd: loadingEnd\n    });\n    styleManagers.set(element, manager);\n    return manager;\n  }\n\n  function removeManager(element) {\n    var manager = styleManagers.get(element);\n\n    if (manager) {\n      manager.destroy();\n      styleManagers.delete(element);\n    }\n  }\n\n  var throttledRenderAllStyles = throttle(function (callback) {\n    styleManagers.forEach(function (manager) {\n      return manager.render(filter, ignoredImageAnalysisSelectors);\n    });\n    adoptedStyleManagers.forEach(function (manager) {\n      return manager.render(filter, ignoredImageAnalysisSelectors);\n    });\n    callback && callback();\n  });\n\n  var cancelRendering = function () {\n    throttledRenderAllStyles.cancel();\n  };\n\n  function onDOMReady() {\n    if (loadingStyles.size === 0) {\n      cleanFallbackStyle();\n      return;\n    }\n\n    logWarn(\"DOM is ready, but still have styles being loaded.\", loadingStyles);\n  }\n\n  var documentVisibilityListener = null;\n  var didDocumentShowUp = typeof document !== 'undefined' && !document.hidden;\n\n  function watchForDocumentVisibility(callback) {\n    var alreadyWatching = Boolean(documentVisibilityListener);\n\n    documentVisibilityListener = function () {\n      if (!document.hidden) {\n        stopWatchingForDocumentVisibility();\n        callback();\n        didDocumentShowUp = true;\n      }\n    };\n\n    if (!alreadyWatching) {\n      document.addEventListener('visibilitychange', documentVisibilityListener);\n    }\n  }\n\n  function stopWatchingForDocumentVisibility() {\n    document.removeEventListener('visibilitychange', documentVisibilityListener);\n    documentVisibilityListener = null;\n  }\n\n  function createThemeAndWatchForUpdates() {\n    createStaticStyleOverrides();\n\n    function runDynamicStyle() {\n      createDynamicStyleOverrides();\n      watchForUpdates();\n    }\n\n    if (document.hidden) {\n      watchForDocumentVisibility(runDynamicStyle);\n    } else {\n      runDynamicStyle();\n    }\n\n    changeMetaThemeColorWhenAvailable(filter);\n  }\n\n  function handleAdoptedStyleSheets(node) {\n    if (Array.isArray(node.adoptedStyleSheets)) {\n      if (node.adoptedStyleSheets.length > 0) {\n        var newManger = createAdoptedStyleSheetOverride(node);\n        adoptedStyleManagers.push(newManger);\n        newManger.render(filter, ignoredImageAnalysisSelectors);\n      }\n    }\n  }\n\n  function watchForUpdates() {\n    var managedStyles = Array.from(styleManagers.keys());\n    watchForStyleChanges(managedStyles, function (_a) {\n      var created = _a.created,\n          updated = _a.updated,\n          removed = _a.removed,\n          moved = _a.moved;\n      var stylesToRemove = removed;\n      var stylesToManage = created.concat(updated).concat(moved).filter(function (style) {\n        return !styleManagers.has(style);\n      });\n      var stylesToRestore = moved.filter(function (style) {\n        return styleManagers.has(style);\n      });\n      logInfo(\"Styles to be removed:\", stylesToRemove);\n      stylesToRemove.forEach(function (style) {\n        return removeManager(style);\n      });\n      var newManagers = stylesToManage.map(function (style) {\n        return createManager(style);\n      });\n      newManagers.map(function (manager) {\n        return manager.details({\n          secondRound: false\n        });\n      }).filter(function (detail) {\n        return detail && detail.rules.length > 0;\n      }).forEach(function (detail) {\n        variablesStore.addRulesForMatching(detail.rules);\n      });\n      variablesStore.matchVariablesAndDependants();\n      newManagers.forEach(function (manager) {\n        return manager.render(filter, ignoredImageAnalysisSelectors);\n      });\n      newManagers.forEach(function (manager) {\n        return manager.watch();\n      });\n      stylesToRestore.forEach(function (style) {\n        return styleManagers.get(style).restore();\n      });\n    }, function (shadowRoot) {\n      createShadowStaticStyleOverrides(shadowRoot);\n      handleAdoptedStyleSheets(shadowRoot);\n    });\n    watchForInlineStyles(function (element) {\n      overrideInlineStyle(element, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors);\n\n      if (element === document.documentElement) {\n        var styleAttr = element.getAttribute('style');\n\n        if (styleAttr.includes('--')) {\n          variablesStore.matchVariablesAndDependants();\n          variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\n        }\n      }\n    }, function (root) {\n      createShadowStaticStyleOverrides(root);\n      var inlineStyleElements = root.querySelectorAll(INLINE_STYLE_SELECTOR);\n\n      if (inlineStyleElements.length > 0) {\n        forEach(inlineStyleElements, function (el) {\n          return overrideInlineStyle(el, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors);\n        });\n      }\n    });\n    addDOMReadyListener(onDOMReady);\n  }\n\n  function stopWatchingForUpdates() {\n    styleManagers.forEach(function (manager) {\n      return manager.pause();\n    });\n    stopStylePositionWatchers();\n    stopWatchingForStyleChanges();\n    stopWatchingForInlineStyles();\n    removeDOMReadyListener(onDOMReady);\n    cleanReadyStateCompleteListeners();\n  }\n\n  function createDarkReaderInstanceMarker() {\n    var metaElement = document.createElement('meta');\n    metaElement.name = 'darkreader';\n    metaElement.content = INSTANCE_ID;\n    document.head.appendChild(metaElement);\n  }\n\n  function isAnotherDarkReaderInstanceActive() {\n    var meta = document.querySelector('meta[name=\"darkreader\"]');\n\n    if (meta) {\n      if (meta.content !== INSTANCE_ID) {\n        return true;\n      }\n\n      return false;\n    }\n\n    createDarkReaderInstanceMarker();\n    return false;\n  }\n\n  function createOrUpdateDynamicTheme(filterConfig, dynamicThemeFixes, iframe) {\n    filter = filterConfig;\n    fixes = dynamicThemeFixes;\n\n    if (fixes) {\n      ignoredImageAnalysisSelectors = Array.isArray(fixes.ignoreImageAnalysis) ? fixes.ignoreImageAnalysis : [];\n      ignoredInlineSelectors = Array.isArray(fixes.ignoreInlineStyle) ? fixes.ignoreInlineStyle : [];\n    } else {\n      ignoredImageAnalysisSelectors = [];\n      ignoredInlineSelectors = [];\n    }\n\n    isIFrame$1 = iframe;\n\n    if (document.head) {\n      if (isAnotherDarkReaderInstanceActive()) {\n        return;\n      }\n\n      document.documentElement.setAttribute('data-darkreader-mode', 'dynamic');\n      document.documentElement.setAttribute('data-darkreader-scheme', filter.mode ? 'dark' : 'dimmed');\n      createThemeAndWatchForUpdates();\n    } else {\n      if (!isFirefox) {\n        var fallbackStyle = createOrUpdateStyle('darkreader--fallback');\n        document.documentElement.appendChild(fallbackStyle);\n        fallbackStyle.textContent = getModifiedFallbackStyle(filter, {\n          strict: true\n        });\n      }\n\n      var headObserver_1 = new MutationObserver(function () {\n        if (document.head) {\n          headObserver_1.disconnect();\n\n          if (isAnotherDarkReaderInstanceActive()) {\n            removeDynamicTheme();\n            return;\n          }\n\n          createThemeAndWatchForUpdates();\n        }\n      });\n      headObserver_1.observe(document, {\n        childList: true,\n        subtree: true\n      });\n    }\n  }\n\n  function removeProxy() {\n    document.dispatchEvent(new CustomEvent('__darkreader__cleanUp'));\n    removeNode(document.head.querySelector('.darkreader--proxy'));\n  }\n\n  function removeDynamicTheme() {\n    document.documentElement.removeAttribute(\"data-darkreader-mode\");\n    document.documentElement.removeAttribute(\"data-darkreader-scheme\");\n    cleanDynamicThemeCache();\n    removeNode(document.querySelector('.darkreader--fallback'));\n\n    if (document.head) {\n      restoreMetaThemeColor();\n      removeNode(document.head.querySelector('.darkreader--user-agent'));\n      removeNode(document.head.querySelector('.darkreader--text'));\n      removeNode(document.head.querySelector('.darkreader--invert'));\n      removeNode(document.head.querySelector('.darkreader--inline'));\n      removeNode(document.head.querySelector('.darkreader--override'));\n      removeNode(document.head.querySelector('.darkreader--variables'));\n      removeNode(document.head.querySelector('.darkreader--root-vars'));\n      removeNode(document.head.querySelector('meta[name=\"darkreader\"]'));\n      removeProxy();\n    }\n\n    shadowRootsWithOverrides.forEach(function (root) {\n      removeNode(root.querySelector('.darkreader--inline'));\n      removeNode(root.querySelector('.darkreader--override'));\n    });\n    shadowRootsWithOverrides.clear();\n    forEach(styleManagers.keys(), function (el) {\n      return removeManager(el);\n    });\n    loadingStyles.clear();\n    cleanLoadingLinks();\n    forEach(document.querySelectorAll('.darkreader'), removeNode);\n    adoptedStyleManagers.forEach(function (manager) {\n      manager.destroy();\n    });\n    adoptedStyleManagers.splice(0);\n  }\n\n  function cleanDynamicThemeCache() {\n    variablesStore.clear();\n    parsedURLCache.clear();\n    stopWatchingForDocumentVisibility();\n    cancelRendering();\n    stopWatchingForUpdates();\n    cleanModificationCache();\n  }\n\n  var blobRegex = /url\\(\\\"(blob\\:.*?)\\\"\\)/g;\n\n  function replaceBlobs(text) {\n    return __awaiter(this, void 0, void 0, function () {\n      var promises, data;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            promises = [];\n            getMatches(blobRegex, text, 1).forEach(function (url) {\n              var promise = loadAsDataURL(url);\n              promises.push(promise);\n            });\n            return [4, Promise.all(promises)];\n\n          case 1:\n            data = _a.sent();\n            return [2, text.replace(blobRegex, function () {\n              return \"url(\\\"\" + data.shift() + \"\\\")\";\n            })];\n        }\n      });\n    });\n  }\n\n  var banner = \"/*\\n                        _______\\n                       /       \\\\\\n                      .==.    .==.\\n                     ((  ))==((  ))\\n                    / \\\"==\\\"    \\\"==\\\"\\\\\\n                   /____|| || ||___\\\\\\n       ________     ____    ________  ___    ___\\n       |  ___  \\\\   /    \\\\   |  ___  \\\\ |  |  /  /\\n       |  |  \\\\  \\\\ /  /\\\\  \\\\  |  |  \\\\  \\\\|  |_/  /\\n       |  |   )  /  /__\\\\  \\\\ |  |__/  /|  ___  \\\\\\n       |  |__/  /  ______  \\\\|  ____  \\\\|  |  \\\\  \\\\\\n_______|_______/__/ ____ \\\\__\\\\__|___\\\\__\\\\__|___\\\\__\\\\____\\n|  ___  \\\\ |  ____/ /    \\\\   |  ___  \\\\ |  ____|  ___  \\\\\\n|  |  \\\\  \\\\|  |___ /  /\\\\  \\\\  |  |  \\\\  \\\\|  |___|  |  \\\\  \\\\\\n|  |__/  /|  ____/  /__\\\\  \\\\ |  |   )  |  ____|  |__/  /\\n|  ____  \\\\|  |__/  ______  \\\\|  |__/  /|  |___|  ____  \\\\\\n|__|   \\\\__\\\\____/__/      \\\\__\\\\_______/ |______|__|   \\\\__\\\\\\n                https://darkreader.org\\n*/\\n\\n/*! Dark reader generated CSS | Licensed under MIT https://github.com/darkreader/darkreader/blob/master/LICENSE */\\n\";\n\n  function collectCSS() {\n    return __awaiter(this, void 0, void 0, function () {\n      function addStaticCSS(selector, comment) {\n        var staticStyle = document.querySelector(selector);\n\n        if (staticStyle && staticStyle.textContent) {\n          css.push(\"/* \" + comment + \" */\");\n          css.push(staticStyle.textContent);\n          css.push('');\n        }\n      }\n\n      var css, modifiedCSS, formattedCSS, _a, _b;\n\n      return __generator(this, function (_c) {\n        switch (_c.label) {\n          case 0:\n            css = [banner];\n            addStaticCSS('.darkreader--fallback', 'Fallback Style');\n            addStaticCSS('.darkreader--user-agent', 'User-Agent Style');\n            addStaticCSS('.darkreader--text', 'Text Style');\n            addStaticCSS('.darkreader--invert', 'Invert Style');\n            addStaticCSS('.darkreader--variables', 'Variables Style');\n            modifiedCSS = [];\n            document.querySelectorAll('.darkreader--sync').forEach(function (element) {\n              forEach(element.sheet.cssRules, function (rule) {\n                rule && rule.cssText && modifiedCSS.push(rule.cssText);\n              });\n            });\n            if (!modifiedCSS.length) return [3, 2];\n            formattedCSS = formatCSS(modifiedCSS.join('\\n'));\n            css.push('/* Modified CSS */');\n            _b = (_a = css).push;\n            return [4, replaceBlobs(formattedCSS)];\n\n          case 1:\n            _b.apply(_a, [_c.sent()]);\n\n            css.push('');\n            _c.label = 2;\n\n          case 2:\n            addStaticCSS('.darkreader--override', 'Override Style');\n            return [2, css.join('\\n')];\n        }\n      });\n    });\n  }\n\n  var isDarkReaderEnabled = false;\n\n  var isIFrame = function () {\n    if (typeof window === 'undefined') return false;\n\n    try {\n      return window.self !== window.top;\n    } catch (err) {\n      console.warn(err);\n      return true;\n    }\n  }();\n\n  function enable(themeOptions, fixes) {\n    if (themeOptions === void 0) {\n      themeOptions = {};\n    }\n\n    if (fixes === void 0) {\n      fixes = null;\n    }\n\n    var theme = __assign(__assign({}, DEFAULT_THEME), themeOptions);\n\n    if (theme.engine !== ThemeEngines.dynamicTheme) {\n      throw new Error('Theme engine is not supported.');\n    }\n\n    createOrUpdateDynamicTheme(theme, fixes, isIFrame);\n    isDarkReaderEnabled = true;\n  }\n\n  function isEnabled() {\n    return isDarkReaderEnabled;\n  }\n\n  function disable() {\n    removeDynamicTheme();\n    isDarkReaderEnabled = false;\n  }\n\n  var store = {\n    themeOptions: null,\n    fixes: null\n  };\n\n  function handleColorScheme() {\n    var darkScheme = matchMedia('(prefers-color-scheme: dark)');\n\n    if (darkScheme.matches) {\n      enable(store.themeOptions, store.fixes);\n    } else {\n      disable();\n    }\n  }\n\n  function auto(themeOptions, fixes) {\n    if (themeOptions === void 0) {\n      themeOptions = {};\n    }\n\n    if (fixes === void 0) {\n      fixes = null;\n    }\n\n    var darkScheme = matchMedia('(prefers-color-scheme: dark)');\n\n    if (themeOptions) {\n      store = {\n        themeOptions: themeOptions,\n        fixes: fixes\n      };\n      handleColorScheme();\n\n      if (isMatchMediaChangeEventListenerSupported) {\n        darkScheme.addEventListener('change', handleColorScheme);\n      } else {\n        darkScheme.addListener(handleColorScheme);\n      }\n    } else {\n      if (isMatchMediaChangeEventListenerSupported) {\n        darkScheme.removeEventListener('change', handleColorScheme);\n      } else {\n        darkScheme.removeListener(handleColorScheme);\n      }\n\n      disable();\n    }\n  }\n\n  function exportGeneratedCSS() {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4, collectCSS()];\n\n          case 1:\n            return [2, _a.sent()];\n        }\n      });\n    });\n  }\n\n  var setFetchMethod = setFetchMethod$1;\n  exports.auto = auto;\n  exports.disable = disable;\n  exports.enable = enable;\n  exports.exportGeneratedCSS = exportGeneratedCSS;\n  exports.isEnabled = isEnabled;\n  exports.setFetchMethod = setFetchMethod;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","map":{"version":3,"names":["global","factory","exports","module","define","amd","globalThis","self","DarkReader","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","v","op","TypeError","pop","push","__values","o","m","__read","r","ar","error","__spreadArray","to","from","pack","l","Array","slice","concat","MessageType","UI_GET_DATA","UI_GET_ACTIVE_TAB_INFO","UI_SUBSCRIBE_TO_CHANGES","UI_UNSUBSCRIBE_FROM_CHANGES","UI_CHANGE_SETTINGS","UI_SET_THEME","UI_SET_SHORTCUT","UI_TOGGLE_URL","UI_MARK_NEWS_AS_READ","UI_LOAD_CONFIG","UI_APPLY_DEV_DYNAMIC_THEME_FIXES","UI_RESET_DEV_DYNAMIC_THEME_FIXES","UI_APPLY_DEV_INVERSION_FIXES","UI_RESET_DEV_INVERSION_FIXES","UI_APPLY_DEV_STATIC_THEMES","UI_RESET_DEV_STATIC_THEMES","UI_SAVE_FILE","UI_REQUEST_EXPORT_CSS","BG_CHANGES","BG_ADD_CSS_FILTER","BG_ADD_STATIC_THEME","BG_ADD_SVG_FILTER","BG_ADD_DYNAMIC_THEME","BG_EXPORT_CSS","BG_UNSUPPORTED_SENDER","BG_CLEAN_UP","BG_RELOAD","BG_FETCH_RESPONSE","BG_UI_UPDATE","BG_CSS_UPDATE","CS_COLOR_SCHEME_CHANGE","CS_FRAME_CONNECT","CS_FRAME_FORGET","CS_FRAME_FREEZE","CS_FRAME_RESUME","CS_EXPORT_CSS_RESPONSE","CS_FETCH","userAgent","navigator","toLowerCase","platform","isChromium","includes","isThunderbird","isFirefox","isSafari","isWindows","startsWith","isMacOS","isShadowDomSupported","ShadowRoot","isMatchMediaChangeEventListenerSupported","MediaQueryList","addEventListener","match","isDefinedSelectorSupported","document","querySelector","err","chrome","runtime","getManifest","manifest_version","getOKResponse","url","mimeType","origin","response","_a","fetch","cache","credentials","referrer","endsWith","headers","get","Error","ok","status","statusText","loadAsDataURL","readResponseAsDataURL","blob","dataURL","reader","FileReader","onloadend","readAsDataURL","throwCORSError","join","fetcher","setFetchMethod$1","callFetchMethod","initChrome","window","messageListeners","Set","sendMessage","args","_i","id_1","responseType","text_1","error_1","_b","type","id","data","text","forEach","cb","console","addMessageListener","callback","add","nativeSendMessage_1","onMessage","addListener","nativeAddListener_1","ThemeEngines","cssFilter","svgFilter","staticTheme","dynamicTheme","DEFAULT_COLORS","darkScheme","background","lightScheme","DEFAULT_THEME","mode","brightness","contrast","grayscale","sepia","useFont","fontFamily","textStroke","engine","stylesheet","darkSchemeBackgroundColor","darkSchemeTextColor","lightSchemeBackgroundColor","lightSchemeTextColor","scrollbarColor","selectionColor","styleSystemControls","lightColorScheme","darkColorScheme","isArrayLike","items","e_1","len","items_1","items_1_1","item","e_1_1","return","array","addition","a","toArray","results","logInfo","logWarn","throttle","pending","frameId","lastArgs","throttled","requestAnimationFrame","cancel","cancelAnimationFrame","createAsyncTasksQueue","tasks","runTasks","task","shift","splice","getDuration","time","duration","seconds","minutes","hours","days","removeNode","node","parentNode","removeChild","watchForNodePosition","onRestore","Function","MAX_ATTEMPTS_COUNT","RETRY_TIMEOUT","ATTEMPTS_INTERVAL","prevSibling","previousSibling","parent","attempts","start","timeoutId","restore","now","Date","setTimeout","stop","updateParent","insertBefore","nextSibling","firstChild","observer","takeRecords","MutationObserver","run","observe","childList","clearTimeout","disconnect","skip","iterateShadowHosts","root","walker","createTreeWalker","NodeFilter","SHOW_ELEMENT","acceptNode","shadowRoot","FILTER_SKIP","FILTER_ACCEPT","currentNode","nextNode","isDOMReady","readyState","readyStateListeners","addDOMReadyListener","listener","removeDOMReadyListener","delete","isReadyStateComplete","readyStateCompleteListeners","addReadyStateCompleteListener","cleanReadyStateCompleteListeners","clear","onReadyStateChange_1","removeEventListener","HUGE_MUTATIONS_COUNT","isHugeMutation","mutations","addedNodesCount","addedNodes","getElementsTreeOperations","additions","deletions","moves","Element","isConnected","removedNodes","duplicateAdditions","duplicateDeletions","has","parentElement","optimizedTreeObservers","Map","optimizedTreeCallbacks","WeakMap","createOptimizedTreeObserver","callbacks","observerCallbacks","domReadyListener","hadHugeMutationsBefore_1","subscribedForReadyState_1","onHugeMutations","elementsOperations_1","onMinorMutations","subtree","set","size","anchor","parsedURLCache","fixBaseURL","$url","createElement","href","parseURL","$base","key","parsedURL_1","URL","parsedURL","getAbsoluteURL","$relative","test","location","protocol","b","isRelativeHrefOnAbsolutePath","hostname","port","pathname","iterateCSSRules","rules","iterate","onMediaRuleError","rule","selectorText","styleSheet","cssRules","media","isScreenOrAllOrQuery","some","isPrintOrSpeech","conditionText","CSS","supports","shorthandVarDependantProperties","shorthandVarDepPropRegexps","map","prop","regexp","RegExp","iterateCSSDeclarations","style","property","getPropertyValue","trim","cssText","val","cssURLRegex","cssImportRegex","getCSSURLValue","cssURL","replace","getCSSBaseBath","replaceCSSRelativeURLsWithAbsolute","$css","cssBasePath","pathValue","cssCommentsRegex","removeCSSComments","fontFaceRegex","replaceCSSFontFace","hslToRGB","h","_c","x","Math","round","r_1","b_1","g_1","c","abs","_d","rgbToHSL","r255","g255","b255","max","min","toFixed","digits","fixed","dot","indexOf","zerosMatch","index","substring","rgbToString","rgb","rgbToHexString","toString","hslToString","hsl","rgbMatch","hslMatch","hexMatch","parse","$color","parseRGB","parseHSL","parseHex","knownColors","getColorByName","systemColors","getSystemColor","getNumbers","numbers","prevPos","isMining","startIndex","getNumbersFromString","str","range","units","raw","unitsList","entries","unit","find","u","parseFloat","rgbRange","rgbUnits","$rgb","hslRange","hslUnits","PI","$hsl","$hex","parseInt","isCharDigit","char","getAmountOfDigits","number","floor","log10","lowerCalcExpression","color","searchIndex","replaceBetweenIndices","end","replacement","getNumber","resultNumber","Number","lenDigits","possibleType","firstNumber","operation","secondNumber","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","ActiveBorder","ActiveCaption","AppWorkspace","Background","ButtonFace","ButtonHighlight","ButtonShadow","ButtonText","CaptionText","GrayText","Highlight","HighlightText","InactiveBorder","InactiveCaption","InactiveCaptionText","InfoBackground","InfoText","Menu","MenuText","Scrollbar","ThreeDDarkShadow","ThreeDFace","ThreeDHighlight","ThreeDLightShadow","ThreeDShadow","Window","WindowFrame","WindowText","scale","inLow","inHigh","outLow","outHigh","clamp","multiplyMatrices","m1","m2","j","len2","sum","k","len3","getMatches","regex","input","group","matches","exec","formatCSS","trimLeft","getIndent","depth","repeat","emptyRuleRegexp","css","split","formatted","line","getParenthesesRange","searchStartIndex","firstOpenIndex","openIndex","closingIndex","createFilterMatrix","config","Matrix","identity","invertNHue","applyColorMatrix","matrix","getBgPole","theme","isDarkScheme","getFgPole","colorModificationCache","colorParseCache$1","parseToHSLWithCache","clearColorModificationCache","rgbCacheKeys","themeCacheKeys$1","getCacheId","resultId","modifyColorWithCache","modifyHSL","poleColor","anotherPoleColor","fnCache","pole","anotherPole","modified","rf","gf","bf","noopHSL","modifyColor","modifyLightSchemeColor","poleBg","poleFg","modifyLightModeHSL","isDark","isNeutral","isBlue","hx","sx","lx","MAX_BG_LIGHTNESS","modifyBgHSL","lx_1","hx_1","hx_2","isYellow","isCloserToGreen","modifyBackgroundColor","MIN_FG_LIGHTNESS","modifyBlueFgHue","hue","modifyFgHSL","isLight","lx_2","hx_3","hx_4","hx_5","lx_3","modifyForegroundColor","modifyBorderHSL","modifyBorderColor","modifyShadowColor","filter","modifyGradientColor","createTextStyle","lines","FilterMode","getCSSFilterValue","filters","dark","toSVGMatrix","getSVGFilterMatrixValue","counter","resolvers$1","rejectors","bgFetch","request","AsyncQueue","queue","timerId","frameDuration","addToQueue","entry","startQueue","stopQueue","_this","imageManager","getImageDetails","image_1","error_2","getImageDataURL","urlToImage","src","width","naturalWidth","height","naturalHeight","analyzeImage","image","Image","onload","onerror","MAX_ANALIZE_PIXELS_COUNT","canvas","context","createCanvas","maxWidth","maxHeight","getContext","imageSmoothingEnabled","removeCanvas","MAX_IMAGE_SIZE","currentSrc","isTransparent","isLarge","isTooLarge","naturalPixelsCount","sqrt","ceil","clearRect","drawImage","imageData","getImageData","d","TRANSPARENT_ALPHA_THRESHOLD","DARK_LIGHTNESS_THRESHOLD","LIGHT_LIGHTNESS_THRESHOLD","transparentPixelsCount","darkPixelsCount","lightPixelsCount","totalPixelsCount","opaquePixelsCount","DARK_IMAGE_THRESHOLD","LIGHT_IMAGE_THRESHOLD","TRANSPARENT_IMAGE_THRESHOLD","LARGE_IMAGE_PIXELS_COUNT","getFilteredImageDataURL","svg","btoa","cleanImageProcessingCache","getPriority","ruleStyle","Boolean","getPropertyPriority","getModifiableCSSDeclaration","variablesStore","ignoreImageSelectors","isCancelled","modifier","getVariableModifier","important","sourceValue","getVariableDependantModifier","getColorModifier","getBgImageModifier","getShadowModifier","getModifiedUserAgentStyle","isIFrame","getModifiedScrollbarStyle","getModifiedSelectionStyle","getSelectionColor","backgroundColorSelection","foregroundColorSelection","modifiedSelectionColor","selection","colorTrack","colorIcons","colorThumb","colorThumbHover","colorThumbActive","colorCorner","hsl_1","lighten","lighter","darken","darker","getModifiedFallbackStyle","strict","isMicrosoft","unparsableColors","colorParseCache","parseColorWithCache","tryParseColor","rgb_1","gradientRegex","imageDetailsCache","awaitingForImageLoading","shouldIgnoreImage","selectors","ruleSelectors","_loop_1","ignoredSelector","state_1","gradients","urls","getIndices","valueIndex","matches_1","sort","getGradientModifier_1","gradient","content","partsRegex","colorStopRegex","parts","part","space","lastIndexOf","colorStopMatch","modify","getURLModifier_1","urlValue","parentStyleSheet","baseURL","ownerNode","baseURI","absoluteValue","imageDetails","awaiters_1","err_1","bgImageValue","getBgImageValue_1","inverted","dimmed","filtered","modifiers_1","index_1","matchStart","prefixStart","matchEnd","all","asyncResults","getShadowModifierWithInfo","index_2","colorMatches_1","notParsed_1","modifiers_2","prefixIndex","matchIndex","matchesLength","unparseableMatchesLength","shadowModifier","ignoredImgSelectors","getModifierForVariable","varName","getModifierForVarDependant","cleanModificationCache","VAR_TYPE_BGCOLOR","VAR_TYPE_TEXTCOLOR","VAR_TYPE_BORDERCOLOR","VAR_TYPE_BGIMG","VariablesStore","varTypes","rulesQueue","definedVars","varRefs","unknownColorVars","unknownBgVars","undefinedVars","initialVarTypes","changedTypeVars","typeChangeSubscriptions","unstableVarValues","isVarType","typeNum","addRulesForMatching","matchVariablesAndDependants","collectRootVariables","collectVariablesAndVarDep","collectRootVarDependants","refs","resolveVariableType","hasColor","findVarRef","ref","itarateVarRefs","options","getDeclarations","declarations","addModifiedValue","varNameWrapper","colorModifier","modifiedValue","isVarDependant","isConstructedColorVar","insertVarValues","replaceCSSVariablesNames","fallback","wrapBgColorVariableName","tryModifyBgColor","wrapTextColorVariableName","tryModifyTextColor","wrapBorderColorVariableName","tryModifyBorderColor","wrapBgImgVariableName","bgModifier","onTypeChange","decs","subscribeForVarTypeChange","removeListeners","unsubscribeFromVariableTypeChanges","isBg_1","isText_1","unknownVars","variableReplaced","modifiedShadow","firstUnknownVar","values","newValue","rootStore","ruleList","isVariable","inspectVariable","inspectVarDependant","documentElement","initialType","currentType","newType","iterateVarDeps","isBgColor","varDeps","iterateVarDependencies","stack","refs_1","refs_1_1","found","setOnRootVariableChange","onRootVariableDefined","putRootVars","styleElement","e_2","sheet","deleteRule","cssLines","declarations_1","declarations_1_1","e_2_1","insertRule","getVariableRange","searchStart","getVariablesMatches","ranges","replaceVariablesMatches","replacer","matchesCount","inputLength","replacements","getVariableNameAndFallback","commaIndex","name","nameReplacer","fallbackReplacer","matchReplacer","newName","newFallback","rawValueRegex","parseRawValue","splitted","resultInRGB_1","substr","isRaw","handleRawValue","modifyFunction","newColor","outputColor","outputInRGB","source","varValues","containsUnresolvedVar","varValue","inserted","replaced","overrides","customProp","cssProp","dataAttr","overridesList","normalizedPropList","INLINE_STYLE_ATTRS","INLINE_STYLE_SELECTOR","attr","getInlineOverrideStyle","getInlineStyleElements","Document","querySelectorAll","treeObservers","attrObservers","watchForInlineStyles","elementStyleDidChange","shadowRootDiscovered","deepWatchForInlineStyles","host","discoveredNodes","WeakSet","discoverNodes","el","treeObserver","added","attemptCount","handleAttributeMutations","attributeName","target","attrObserver","attributeCache","attributes","attributeFilter","stopWatchingForInlineStyles","inlineStyleCache","filterProps","getInlineStyleCacheKey","getAttribute","shouldIgnoreInlineStyle","element","ingnoredSelector","overrideInlineStyle","ignoreInlineSelectors","cacheKey","unsetProps","keys","setCustomProp","targetCSSProp","modifierCSSProp","cssVal","mod","setProperty","hasAttribute","setAttribute","removeAttribute","rel","SVGElement","SMALL_SVG_LIMIT_1","value_1","SVGTextElement","handleSVGElement","getBoundingClientRect","isBg","SVGLineElement","overridenProp","fill","metaThemeColorName","metaThemeColorSelector","srcMetaThemeColor","changeMetaThemeColor","meta","changeMetaThemeColorWhenAvailable","loop","HTMLMetaElement","head","restoreMetaThemeColor","themeCacheKeys","getThemeKey","asyncQueue","createStyleSheetModifier","renderId","rulesTextCache","rulesModCache","varTypeChangeCleaners","prevFilterKey","hasNonLoadedLink","wasRebuilt","shouldRebuildStyle","modifySheet","sourceCSSRules","ignoreImageAnalysis","force","prepareSheet","isAsyncCancelled","rulesChanged","notFoundCacheKeys","themeKey","themeChanged","modRules","textDiffersFromPrev","parentRule","CSSMediaRule","mediaText","modDecs","modRule","selector","setRule","getDeclarationText","dec","cssRulesText","ruleText","asyncDeclarations","varDeclarations","asyncDeclarationCounter","varDeclarationCounter","rootReadyGroup","isGroup","groupRefs","getGroup","parentGroup","readyStyleRule","readyDeclarations","handleAsyncDeclaration","asyncKey","asyncDeclaration","currentRenderId","asyncValue","rebuildAsyncRule","handleVarDeclarations","varDecs","varKey","initialIndex","oldDecs","tempDec","readyDec","newDecs","readyVarDecs","rebuildVarRule","buildStyleSheet","createTarget","iterateReadyRules","styleIterator","STYLE_SELECTOR","shouldManageStyle","HTMLStyleElement","SVGStyleElement","HTMLLinkElement","disabled","classList","contains","getManageableStyles","deep","syncStyleSet","corsStyleSet","canOptimizeUsingProxy$1","loadingLinkCounter","rejectorsForLoadingLinks","cleanLoadingLinks","manageStyle","update","loadingStart","loadingEnd","prevStyles","nextElementSibling","corsCopy","syncStyle","corsCopyPositionWatcher","syncStylePositionWatcher","cancelAsyncOperations","isOverrideEmpty","sheetModifier","observerOptions","characterData","containsCSSImport","textContent","hasImports","checkCrossOrigin","cssRulesLoop","getRulesSync","safeGetSheetRules","insertStyle","createSyncStyle","createElementNS","title","isLoadingRules","wasLoadingError","loadingLinkId","getRulesAsync","accessError","fullCSSText","err_2","getRulesOrError","isStillLoadingError","linkLoading","loadText","replaceCSSImports","createCORSCopy","details","secondRound","catch","forceRenderStyle","render","removeCSSRulesFromSheet","replaceSync","prepareOverridesSheet","buildOverrides","message","watchForSheetChanges","watchForSheetChangesUsingProxy","watchForSheetChangesUsingRAF","rulesChangeKey","rulesCheckFrameId","getRulesChangeKey","didRulesKeyChange","stopWatchingForSheetChangesUsingRAF","checkForUpdate","areSheetChangesPending","onSheetChange","handleSheetChanges","queueMicrotask","stopWatchingForSheetChangesUsingProxy","stopWatchingForSheetChanges","pause","destroy","watch","maxMoveCount","moveCount","link","loadingId","cleanUp","onLoad","onError","getCSSImportURL","importDeclaration","basePath","importMatches","importMatches_1","importMatches_1_1","importURL","absoluteURL","importedCSS","err_3","srcElement","cors","observers","observedRoots","undefinedGroups","elementsDefinitionCallback","collectUndefinedElements","tag","tagName","extendedTag","customElementsWhenDefined","elements","canOptimizeUsingProxy","resolvers","handleIsDefined","detail","customElements","whenDefined","dispatchEvent","CustomEvent","checkIfDefined_1","watchWhenCustomElementsDefined","unsubscribeFromDefineCustomElements","watchForStyleChanges","currentStyles","stopWatchingForStyleChanges","prevStyleSiblings","nextStyleSiblings","saveStylePosition","previousElementSibling","forgetStylePosition","didStylePositionChange","handleStyleOperations","operations","createdStyles","removedStyles","movedStyles","created","removed","moved","updated","handleMinorTreeMutations","subscribeForShadowRootChanges","handleHugeTreeMutations","styles","updatedStyles","hosts","newStyles","resetObservers","hexify","generateUID","crypto","uuid","randomUUID","getRandomValues","Uint8Array","adoptedStyleOverrides","overrideList","createAdoptedStyleSheetOverride","injectSheet","override","newSheets","adoptedStyleSheets","sheetIndex","existingIndex","adoptedStyleSheet","CSSStyleSheet","injectProxy","enableStyleSheetsProxy","addRuleDescriptor","getOwnPropertyDescriptor","insertRuleDescriptor","deleteRuleDescriptor","removeRuleDescriptor","documentStyleSheetsDescriptor","shouldWrapHTMLElement","getElementsByTagNameDescriptor","defineProperty","addUndefinedResolver","updateSheetEvent","Event","proxyAddRule","proxyInsertRule","returnValue","proxyDeleteRule","proxyRemoveRule","proxyDocumentStyleSheets","docSheets","setPrototypeOf","StyleSheetList","proxyGetElementsByTagName","getCurrentElementValue","NodeList","NodeListBehavior","Proxy","INSTANCE_ID","styleManagers","adoptedStyleManagers","fixes","isIFrame$1","ignoredImageAnalysisSelectors","ignoredInlineSelectors","createOrUpdateStyle","className","createOrUpdateScript","nodePositionWatchers","setupNodePositionWatcher","alias","stopStylePositionWatchers","watcher","createStaticStyleOverrides","fallbackStyle","userAgentStyle","textStyle","invertStyle","isArray","invert","inlineStyle","overrideStyle","replaceCSSTemplates","appendChild","variableStyle","selectionColors","schemeBackgroundColor","schemeTextColor","rootVarsStyle","proxyScript","append","disableStyleSheetsProxy","remove","shadowRootsWithOverrides","createShadowStaticStyleOverrides","$cssText","cleanFallbackStyle","createDynamicStyleOverrides","cancelRendering","allStyles","newManagers","createManager","manager","loadingStyles","inlineStyleElements","handleAdoptedStyleSheets","loadingStylesCounter","loadingStyleId","didDocumentShowUp","removeManager","throttledRenderAllStyles","onDOMReady","documentVisibilityListener","hidden","watchForDocumentVisibility","alreadyWatching","stopWatchingForDocumentVisibility","createThemeAndWatchForUpdates","runDynamicStyle","watchForUpdates","newManger","managedStyles","stylesToRemove","stylesToManage","stylesToRestore","styleAttr","stopWatchingForUpdates","createDarkReaderInstanceMarker","metaElement","isAnotherDarkReaderInstanceActive","createOrUpdateDynamicTheme","filterConfig","dynamicThemeFixes","iframe","ignoreInlineStyle","headObserver_1","removeDynamicTheme","removeProxy","cleanDynamicThemeCache","blobRegex","replaceBlobs","promises","promise","banner","collectCSS","addStaticCSS","comment","staticStyle","modifiedCSS","formattedCSS","isDarkReaderEnabled","top","warn","enable","themeOptions","isEnabled","disable","store","handleColorScheme","matchMedia","auto","removeListener","exportGeneratedCSS","setFetchMethod"],"sources":["D:/Canh Long/Documents/Nam4_Ky 2/Chuyn  Mng/Web/device-management-admin-main/node_modules/@umijs/ssr-darkreader/darkreader.js"],"sourcesContent":["/**\n * Dark Reader v4.9.45\n * https://darkreader.org/\n */\n\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n    typeof define === 'function' && define.amd ? define(['exports'], factory) :\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.DarkReader = {}));\n})(this, (function (exports) { 'use strict';\n\n    /*! *****************************************************************************\r\n    Copyright (c) Microsoft Corporation.\r\n\r\n    Permission to use, copy, modify, and/or distribute this software for any\r\n    purpose with or without fee is hereby granted.\r\n\r\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\n    PERFORMANCE OF THIS SOFTWARE.\r\n    ***************************************************************************** */\r\n\r\n    var __assign = function() {\r\n        __assign = Object.assign || function __assign(t) {\r\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n                s = arguments[i];\r\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n            }\r\n            return t;\r\n        };\r\n        return __assign.apply(this, arguments);\r\n    };\r\n\r\n    function __awaiter(thisArg, _arguments, P, generator) {\r\n        function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n        return new (P || (P = Promise))(function (resolve, reject) {\r\n            function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n            function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n            function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n        });\r\n    }\r\n\r\n    function __generator(thisArg, body) {\r\n        var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n        return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n        function verb(n) { return function (v) { return step([n, v]); }; }\r\n        function step(op) {\r\n            if (f) throw new TypeError(\"Generator is already executing.\");\r\n            while (_) try {\r\n                if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n                if (y = 0, t) op = [op[0] & 2, t.value];\r\n                switch (op[0]) {\r\n                    case 0: case 1: t = op; break;\r\n                    case 4: _.label++; return { value: op[1], done: false };\r\n                    case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                    case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                    default:\r\n                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                        if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                        if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                        if (t[2]) _.ops.pop();\r\n                        _.trys.pop(); continue;\r\n                }\r\n                op = body.call(thisArg, _);\r\n            } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n            if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n        }\r\n    }\r\n\r\n    function __values(o) {\r\n        var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n        if (m) return m.call(o);\r\n        if (o && typeof o.length === \"number\") return {\r\n            next: function () {\r\n                if (o && i >= o.length) o = void 0;\r\n                return { value: o && o[i++], done: !o };\r\n            }\r\n        };\r\n        throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n    }\r\n\r\n    function __read(o, n) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n        if (!m) return o;\r\n        var i = m.call(o), r, ar = [], e;\r\n        try {\r\n            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n        }\r\n        catch (error) { e = { error: error }; }\r\n        finally {\r\n            try {\r\n                if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n            }\r\n            finally { if (e) throw e.error; }\r\n        }\r\n        return ar;\r\n    }\r\n\r\n    function __spreadArray(to, from, pack) {\r\n        if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n            if (ar || !(i in from)) {\r\n                if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n                ar[i] = from[i];\r\n            }\r\n        }\r\n        return to.concat(ar || Array.prototype.slice.call(from));\r\n    }\n\n    var MessageType = {\r\n        UI_GET_DATA: 'ui-get-data',\r\n        UI_GET_ACTIVE_TAB_INFO: 'ui-get-active-tab-info',\r\n        UI_SUBSCRIBE_TO_CHANGES: 'ui-subscribe-to-changes',\r\n        UI_UNSUBSCRIBE_FROM_CHANGES: 'ui-unsubscribe-from-changes',\r\n        UI_CHANGE_SETTINGS: 'ui-change-settings',\r\n        UI_SET_THEME: 'ui-set-theme',\r\n        UI_SET_SHORTCUT: 'ui-set-shortcut',\r\n        UI_TOGGLE_URL: 'ui-toggle-url',\r\n        UI_MARK_NEWS_AS_READ: 'ui-mark-news-as-read',\r\n        UI_LOAD_CONFIG: 'ui-load-config',\r\n        UI_APPLY_DEV_DYNAMIC_THEME_FIXES: 'ui-apply-dev-dynamic-theme-fixes',\r\n        UI_RESET_DEV_DYNAMIC_THEME_FIXES: 'ui-reset-dev-dynamic-theme-fixes',\r\n        UI_APPLY_DEV_INVERSION_FIXES: 'ui-apply-dev-inversion-fixes',\r\n        UI_RESET_DEV_INVERSION_FIXES: 'ui-reset-dev-inversion-fixes',\r\n        UI_APPLY_DEV_STATIC_THEMES: 'ui-apply-dev-static-themes',\r\n        UI_RESET_DEV_STATIC_THEMES: 'ui-reset-dev-static-themes',\r\n        UI_SAVE_FILE: 'ui-save-file',\r\n        UI_REQUEST_EXPORT_CSS: 'ui-request-export-css',\r\n        BG_CHANGES: 'bg-changes',\r\n        BG_ADD_CSS_FILTER: 'bg-add-css-filter',\r\n        BG_ADD_STATIC_THEME: 'bg-add-static-theme',\r\n        BG_ADD_SVG_FILTER: 'bg-add-svg-filter',\r\n        BG_ADD_DYNAMIC_THEME: 'bg-add-dynamic-theme',\r\n        BG_EXPORT_CSS: 'bg-export-css',\r\n        BG_UNSUPPORTED_SENDER: 'bg-unsupported-sender',\r\n        BG_CLEAN_UP: 'bg-clean-up',\r\n        BG_RELOAD: 'bg-reload',\r\n        BG_FETCH_RESPONSE: 'bg-fetch-response',\r\n        BG_UI_UPDATE: 'bg-ui-update',\r\n        BG_CSS_UPDATE: 'bg-css-update',\r\n        CS_COLOR_SCHEME_CHANGE: 'cs-color-scheme-change',\r\n        CS_FRAME_CONNECT: 'cs-frame-connect',\r\n        CS_FRAME_FORGET: 'cs-frame-forget',\r\n        CS_FRAME_FREEZE: 'cs-frame-freeze',\r\n        CS_FRAME_RESUME: 'cs-frame-resume',\r\n        CS_EXPORT_CSS_RESPONSE: 'cs-export-css-response',\r\n        CS_FETCH: 'cs-fetch',\r\n    };\n\n    var userAgent = typeof navigator === 'undefined' ? 'some useragent' : navigator.userAgent.toLowerCase();\r\n    var platform = typeof navigator === 'undefined' ? 'some platform' : navigator.platform.toLowerCase();\r\n    var isChromium = userAgent.includes('chrome') || userAgent.includes('chromium');\r\n    var isThunderbird = userAgent.includes('thunderbird');\r\n    var isFirefox = userAgent.includes('firefox') || userAgent.includes('librewolf') || isThunderbird;\r\n    userAgent.includes('vivaldi');\r\n    userAgent.includes('yabrowser');\r\n    userAgent.includes('opr') || userAgent.includes('opera');\r\n    userAgent.includes('edg');\r\n    var isSafari = userAgent.includes('safari') && !isChromium;\r\n    var isWindows = platform.startsWith('win');\r\n    var isMacOS = platform.startsWith('mac');\r\n    userAgent.includes('mobile');\r\n    var isShadowDomSupported = typeof ShadowRoot === 'function';\r\n    var isMatchMediaChangeEventListenerSupported = (typeof MediaQueryList === 'function' &&\r\n        typeof MediaQueryList.prototype.addEventListener === 'function');\r\n    ((function () {\r\n        var m = userAgent.match(/chrom[e|ium]\\/([^ ]+)/);\r\n        if (m && m[1]) {\r\n            return m[1];\r\n        }\r\n        return '';\r\n    }))();\r\n    var isDefinedSelectorSupported = (function () {\r\n        try {\r\n            document.querySelector(':defined');\r\n            return true;\r\n        }\r\n        catch (err) {\r\n            return false;\r\n        }\r\n    })();\r\n    typeof globalThis !== 'undefined' && globalThis.chrome && globalThis.chrome.runtime && globalThis.chrome.runtime.getManifest && globalThis.chrome.runtime.getManifest().manifest_version === 3;\n\n    function getOKResponse(url, mimeType, origin) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var response;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, fetch(url, {\r\n                            cache: 'force-cache',\r\n                            credentials: 'omit',\r\n                            referrer: origin\r\n                        })];\r\n                    case 1:\r\n                        response = _a.sent();\r\n                        if (isFirefox && mimeType === 'text/css' && url.startsWith('moz-extension://') && url.endsWith('.css')) {\r\n                            return [2, response];\r\n                        }\r\n                        if (mimeType && !response.headers.get('Content-Type').startsWith(mimeType)) {\r\n                            throw new Error(\"Mime type mismatch when loading \" + url);\r\n                        }\r\n                        if (!response.ok) {\r\n                            throw new Error(\"Unable to load \" + url + \" \" + response.status + \" \" + response.statusText);\r\n                        }\r\n                        return [2, response];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function loadAsDataURL(url, mimeType) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var response;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, getOKResponse(url, mimeType)];\r\n                    case 1:\r\n                        response = _a.sent();\r\n                        return [4, readResponseAsDataURL(response)];\r\n                    case 2: return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function readResponseAsDataURL(response) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var blob, dataURL;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, response.blob()];\r\n                    case 1:\r\n                        blob = _a.sent();\r\n                        return [4, (new Promise(function (resolve) {\r\n                                var reader = new FileReader();\r\n                                reader.onloadend = function () { return resolve(reader.result); };\r\n                                reader.readAsDataURL(blob);\r\n                            }))];\r\n                    case 2:\r\n                        dataURL = _a.sent();\r\n                        return [2, dataURL];\r\n                }\r\n            });\r\n        });\r\n    }\n\n    var throwCORSError = function (url) { return __awaiter(void 0, void 0, void 0, function () {\r\n        return __generator(this, function (_a) {\r\n            return [2, Promise.reject(new Error([\r\n                    'Embedded Dark Reader cannot access a cross-origin resource',\r\n                    url,\r\n                    'Overview your URLs and CORS policies or use',\r\n                    '`DarkReader.setFetchMethod(fetch: (url) => Promise<Response>))`.',\r\n                    'See if using `DarkReader.setFetchMethod(window.fetch)`',\r\n                    'before `DarkReader.enable()` works.'\r\n                ].join(' ')))];\r\n        });\r\n    }); };\r\n    var fetcher = throwCORSError;\r\n    function setFetchMethod$1(fetch) {\r\n        if (fetch) {\r\n            fetcher = fetch;\r\n        }\r\n        else {\r\n            fetcher = throwCORSError;\r\n        }\r\n    }\r\n    function callFetchMethod(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, fetcher(url)];\r\n                    case 1: return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\n\n    function initChrome() {\r\n        if (typeof chrome === 'undefined')\r\n            return;\r\n        if (typeof window !== 'undefined' && !window.chrome) {\r\n            window.chrome = {};\r\n        }\r\n        if (typeof chrome !== 'undefined' && !chrome.runtime) {\r\n            chrome.runtime = {};\r\n        }\r\n        var messageListeners = new Set();\r\n        function sendMessage() {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var id_1, _a, url, responseType, response, text_1, error_1;\r\n                return __generator(this, function (_b) {\r\n                    switch (_b.label) {\r\n                        case 0:\r\n                            if (!(args[0] && args[0].type === MessageType.CS_FETCH)) return [3, 8];\r\n                            id_1 = args[0].id;\r\n                            _b.label = 1;\r\n                        case 1:\r\n                            _b.trys.push([1, 7, , 8]);\r\n                            _a = args[0].data, url = _a.url, responseType = _a.responseType;\r\n                            return [4, callFetchMethod(url)];\r\n                        case 2:\r\n                            response = _b.sent();\r\n                            if (!(responseType === 'data-url')) return [3, 4];\r\n                            return [4, readResponseAsDataURL(response)];\r\n                        case 3:\r\n                            text_1 = _b.sent();\r\n                            return [3, 6];\r\n                        case 4: return [4, response.text()];\r\n                        case 5:\r\n                            text_1 = _b.sent();\r\n                            _b.label = 6;\r\n                        case 6:\r\n                            messageListeners.forEach(function (cb) { return cb({ type: MessageType.BG_FETCH_RESPONSE, data: text_1, error: null, id: id_1 }); });\r\n                            return [3, 8];\r\n                        case 7:\r\n                            error_1 = _b.sent();\r\n                            console.error(error_1);\r\n                            messageListeners.forEach(function (cb) { return cb({ type: MessageType.BG_FETCH_RESPONSE, data: null, error: error_1, id: id_1 }); });\r\n                            return [3, 8];\r\n                        case 8: return [2];\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        function addMessageListener(callback) {\r\n            messageListeners.add(callback);\r\n        }\r\n        if (typeof chrome.runtime.sendMessage === 'function') {\r\n            var nativeSendMessage_1 = chrome.runtime.sendMessage;\r\n            chrome.runtime.sendMessage = function () {\r\n                var args = [];\r\n                for (var _i = 0; _i < arguments.length; _i++) {\r\n                    args[_i] = arguments[_i];\r\n                }\r\n                sendMessage.apply(void 0, __spreadArray([], __read(args), false));\r\n                nativeSendMessage_1.apply(chrome.runtime, args);\r\n            };\r\n        }\r\n        else {\r\n            chrome.runtime.sendMessage = sendMessage;\r\n        }\r\n        if (!chrome.runtime.onMessage) {\r\n            chrome.runtime.onMessage = {};\r\n        }\r\n        if (typeof chrome.runtime.onMessage.addListener === 'function') {\r\n            var nativeAddListener_1 = chrome.runtime.onMessage.addListener;\r\n            chrome.runtime.onMessage.addListener = function () {\r\n                var args = [];\r\n                for (var _i = 0; _i < arguments.length; _i++) {\r\n                    args[_i] = arguments[_i];\r\n                }\r\n                addMessageListener(args[0]);\r\n                nativeAddListener_1.apply(chrome.runtime.onMessage, args);\r\n            };\r\n        }\r\n        else {\r\n            chrome.runtime.onMessage.addListener = function () {\r\n                var args = [];\r\n                for (var _i = 0; _i < arguments.length; _i++) {\r\n                    args[_i] = arguments[_i];\r\n                }\r\n                return addMessageListener(args[0]);\r\n            };\r\n        }\r\n    }\r\n    initChrome();\n\n    var ThemeEngines = {\r\n        cssFilter: 'cssFilter',\r\n        svgFilter: 'svgFilter',\r\n        staticTheme: 'staticTheme',\r\n        dynamicTheme: 'dynamicTheme',\r\n    };\n\n    var DEFAULT_COLORS = {\r\n        darkScheme: {\r\n            background: '#181a1b',\r\n            text: '#e8e6e3',\r\n        },\r\n        lightScheme: {\r\n            background: '#dcdad7',\r\n            text: '#181a1b',\r\n        },\r\n    };\r\n    var DEFAULT_THEME = {\r\n        mode: 1,\r\n        brightness: 100,\r\n        contrast: 100,\r\n        grayscale: 0,\r\n        sepia: 0,\r\n        useFont: false,\r\n        fontFamily: isMacOS ? 'Helvetica Neue' : isWindows ? 'Segoe UI' : 'Open Sans',\r\n        textStroke: 0,\r\n        engine: ThemeEngines.dynamicTheme,\r\n        stylesheet: '',\r\n        darkSchemeBackgroundColor: DEFAULT_COLORS.darkScheme.background,\r\n        darkSchemeTextColor: DEFAULT_COLORS.darkScheme.text,\r\n        lightSchemeBackgroundColor: DEFAULT_COLORS.lightScheme.background,\r\n        lightSchemeTextColor: DEFAULT_COLORS.lightScheme.text,\r\n        scrollbarColor: isMacOS ? '' : 'auto',\r\n        selectionColor: 'auto',\r\n        styleSystemControls: true,\r\n        lightColorScheme: 'Default',\r\n        darkColorScheme: 'Default',\r\n    };\n\n    function isArrayLike(items) {\r\n        return items.length != null;\r\n    }\r\n    function forEach(items, iterator) {\r\n        var e_1, _a;\r\n        if (isArrayLike(items)) {\r\n            for (var i = 0, len = items.length; i < len; i++) {\r\n                iterator(items[i]);\r\n            }\r\n        }\r\n        else {\r\n            try {\r\n                for (var items_1 = __values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {\r\n                    var item = items_1_1.value;\r\n                    iterator(item);\r\n                }\r\n            }\r\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n            finally {\r\n                try {\r\n                    if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);\r\n                }\r\n                finally { if (e_1) throw e_1.error; }\r\n            }\r\n        }\r\n    }\r\n    function push(array, addition) {\r\n        forEach(addition, function (a) { return array.push(a); });\r\n    }\r\n    function toArray(items) {\r\n        var results = [];\r\n        for (var i = 0, len = items.length; i < len; i++) {\r\n            results.push(items[i]);\r\n        }\r\n        return results;\r\n    }\n\n    function logInfo() {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n    }\r\n    function logWarn() {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n    }\n\n    function throttle(callback) {\r\n        var pending = false;\r\n        var frameId = null;\r\n        var lastArgs;\r\n        var throttled = (function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            lastArgs = args;\r\n            if (frameId) {\r\n                pending = true;\r\n            }\r\n            else {\r\n                callback.apply(void 0, __spreadArray([], __read(lastArgs), false));\r\n                frameId = requestAnimationFrame(function () {\r\n                    frameId = null;\r\n                    if (pending) {\r\n                        callback.apply(void 0, __spreadArray([], __read(lastArgs), false));\r\n                        pending = false;\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        var cancel = function () {\r\n            cancelAnimationFrame(frameId);\r\n            pending = false;\r\n            frameId = null;\r\n        };\r\n        return Object.assign(throttled, { cancel: cancel });\r\n    }\r\n    function createAsyncTasksQueue() {\r\n        var tasks = [];\r\n        var frameId = null;\r\n        function runTasks() {\r\n            var task;\r\n            while ((task = tasks.shift())) {\r\n                task();\r\n            }\r\n            frameId = null;\r\n        }\r\n        function add(task) {\r\n            tasks.push(task);\r\n            if (!frameId) {\r\n                frameId = requestAnimationFrame(runTasks);\r\n            }\r\n        }\r\n        function cancel() {\r\n            tasks.splice(0);\r\n            cancelAnimationFrame(frameId);\r\n            frameId = null;\r\n        }\r\n        return { add: add, cancel: cancel };\r\n    }\n\n    function getDuration(time) {\r\n        var duration = 0;\r\n        if (time.seconds) {\r\n            duration += time.seconds * 1000;\r\n        }\r\n        if (time.minutes) {\r\n            duration += time.minutes * 60 * 1000;\r\n        }\r\n        if (time.hours) {\r\n            duration += time.hours * 60 * 60 * 1000;\r\n        }\r\n        if (time.days) {\r\n            duration += time.days * 24 * 60 * 60 * 1000;\r\n        }\r\n        return duration;\r\n    }\n\n    function removeNode(node) {\r\n        node && node.parentNode && node.parentNode.removeChild(node);\r\n    }\r\n    function watchForNodePosition(node, mode, onRestore) {\r\n        if (onRestore === void 0) { onRestore = Function.prototype; }\r\n        var MAX_ATTEMPTS_COUNT = 10;\r\n        var RETRY_TIMEOUT = getDuration({ seconds: 2 });\r\n        var ATTEMPTS_INTERVAL = getDuration({ seconds: 10 });\r\n        var prevSibling = node.previousSibling;\r\n        var parent = node.parentNode;\r\n        if (!parent) {\r\n            throw new Error('Unable to watch for node position: parent element not found');\r\n        }\r\n        if (mode === 'prev-sibling' && !prevSibling) {\r\n            throw new Error('Unable to watch for node position: there is no previous sibling');\r\n        }\r\n        var attempts = 0;\r\n        var start = null;\r\n        var timeoutId = null;\r\n        var restore = throttle(function () {\r\n            if (timeoutId) {\r\n                return;\r\n            }\r\n            attempts++;\r\n            var now = Date.now();\r\n            if (start == null) {\r\n                start = now;\r\n            }\r\n            else if (attempts >= MAX_ATTEMPTS_COUNT) {\r\n                if (now - start < ATTEMPTS_INTERVAL) {\r\n                    logWarn(\"Node position watcher paused: retry in \" + RETRY_TIMEOUT + \"ms\", node, prevSibling);\r\n                    timeoutId = setTimeout(function () {\r\n                        start = null;\r\n                        attempts = 0;\r\n                        timeoutId = null;\r\n                        restore();\r\n                    }, RETRY_TIMEOUT);\r\n                    return;\r\n                }\r\n                start = now;\r\n                attempts = 1;\r\n            }\r\n            if (mode === 'parent') {\r\n                if (prevSibling && prevSibling.parentNode !== parent) {\r\n                    logWarn('Unable to restore node position: sibling parent changed', node, prevSibling, parent);\r\n                    stop();\r\n                    return;\r\n                }\r\n            }\r\n            if (mode === 'prev-sibling') {\r\n                if (prevSibling.parentNode == null) {\r\n                    logWarn('Unable to restore node position: sibling was removed', node, prevSibling, parent);\r\n                    stop();\r\n                    return;\r\n                }\r\n                if (prevSibling.parentNode !== parent) {\r\n                    logWarn('Style was moved to another parent', node, prevSibling, parent);\r\n                    updateParent(prevSibling.parentNode);\r\n                }\r\n            }\r\n            logWarn('Restoring node position', node, prevSibling, parent);\r\n            parent.insertBefore(node, prevSibling ? prevSibling.nextSibling : parent.firstChild);\r\n            observer.takeRecords();\r\n            onRestore && onRestore();\r\n        });\r\n        var observer = new MutationObserver(function () {\r\n            if ((mode === 'parent' && node.parentNode !== parent) ||\r\n                (mode === 'prev-sibling' && node.previousSibling !== prevSibling)) {\r\n                restore();\r\n            }\r\n        });\r\n        var run = function () {\r\n            observer.observe(parent, { childList: true });\r\n        };\r\n        var stop = function () {\r\n            clearTimeout(timeoutId);\r\n            observer.disconnect();\r\n            restore.cancel();\r\n        };\r\n        var skip = function () {\r\n            observer.takeRecords();\r\n        };\r\n        var updateParent = function (parentNode) {\r\n            parent = parentNode;\r\n            stop();\r\n            run();\r\n        };\r\n        run();\r\n        return { run: run, stop: stop, skip: skip };\r\n    }\r\n    function iterateShadowHosts(root, iterator) {\r\n        if (root == null) {\r\n            return;\r\n        }\r\n        var walker = document.createTreeWalker(root, NodeFilter.SHOW_ELEMENT, {\r\n            acceptNode: function (node) {\r\n                return node.shadowRoot == null ? NodeFilter.FILTER_SKIP : NodeFilter.FILTER_ACCEPT;\r\n            }\r\n        });\r\n        for (var node = (root.shadowRoot ? walker.currentNode : walker.nextNode()); node != null; node = walker.nextNode()) {\r\n            iterator(node);\r\n            iterateShadowHosts(node.shadowRoot, iterator);\r\n        }\r\n    }\r\n    function isDOMReady() {\r\n        if (typeof document === 'undefined')\r\n            return false;\r\n        return document.readyState === 'complete' || document.readyState === 'interactive';\r\n    }\r\n    var readyStateListeners = new Set();\r\n    function addDOMReadyListener(listener) {\r\n        readyStateListeners.add(listener);\r\n    }\r\n    function removeDOMReadyListener(listener) {\r\n        readyStateListeners.delete(listener);\r\n    }\r\n    function isReadyStateComplete() {\r\n        return document.readyState === 'complete';\r\n    }\r\n    var readyStateCompleteListeners = new Set();\r\n    function addReadyStateCompleteListener(listener) {\r\n        readyStateCompleteListeners.add(listener);\r\n    }\r\n    function cleanReadyStateCompleteListeners() {\r\n        readyStateCompleteListeners.clear();\r\n    }\r\n    if (!isDOMReady()) {\r\n        var onReadyStateChange_1 = function () {\r\n            if (isDOMReady()) {\r\n                readyStateListeners.forEach(function (listener) { return listener(); });\r\n                readyStateListeners.clear();\r\n                if (isReadyStateComplete()) {\r\n                    document.removeEventListener('readystatechange', onReadyStateChange_1);\r\n                    readyStateCompleteListeners.forEach(function (listener) { return listener(); });\r\n                    readyStateCompleteListeners.clear();\r\n                }\r\n            }\r\n        };\r\n        if (typeof document !== 'undefined') {\r\n            document.addEventListener('readystatechange', onReadyStateChange_1);\r\n        }\r\n    }\r\n    var HUGE_MUTATIONS_COUNT = 1000;\r\n    function isHugeMutation(mutations) {\r\n        if (mutations.length > HUGE_MUTATIONS_COUNT) {\r\n            return true;\r\n        }\r\n        var addedNodesCount = 0;\r\n        for (var i = 0; i < mutations.length; i++) {\r\n            addedNodesCount += mutations[i].addedNodes.length;\r\n            if (addedNodesCount > HUGE_MUTATIONS_COUNT) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    function getElementsTreeOperations(mutations) {\r\n        var additions = new Set();\r\n        var deletions = new Set();\r\n        var moves = new Set();\r\n        mutations.forEach(function (m) {\r\n            forEach(m.addedNodes, function (n) {\r\n                if (n instanceof Element && n.isConnected) {\r\n                    additions.add(n);\r\n                }\r\n            });\r\n            forEach(m.removedNodes, function (n) {\r\n                if (n instanceof Element) {\r\n                    if (n.isConnected) {\r\n                        moves.add(n);\r\n                        additions.delete(n);\r\n                    }\r\n                    else {\r\n                        deletions.add(n);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n        var duplicateAdditions = [];\r\n        var duplicateDeletions = [];\r\n        additions.forEach(function (node) {\r\n            if (additions.has(node.parentElement)) {\r\n                duplicateAdditions.push(node);\r\n            }\r\n        });\r\n        deletions.forEach(function (node) {\r\n            if (deletions.has(node.parentElement)) {\r\n                duplicateDeletions.push(node);\r\n            }\r\n        });\r\n        duplicateAdditions.forEach(function (node) { return additions.delete(node); });\r\n        duplicateDeletions.forEach(function (node) { return deletions.delete(node); });\r\n        return { additions: additions, moves: moves, deletions: deletions };\r\n    }\r\n    var optimizedTreeObservers = new Map();\r\n    var optimizedTreeCallbacks = new WeakMap();\r\n    function createOptimizedTreeObserver(root, callbacks) {\r\n        var observer;\r\n        var observerCallbacks;\r\n        var domReadyListener;\r\n        if (optimizedTreeObservers.has(root)) {\r\n            observer = optimizedTreeObservers.get(root);\r\n            observerCallbacks = optimizedTreeCallbacks.get(observer);\r\n        }\r\n        else {\r\n            var hadHugeMutationsBefore_1 = false;\r\n            var subscribedForReadyState_1 = false;\r\n            observer = new MutationObserver(function (mutations) {\r\n                if (isHugeMutation(mutations)) {\r\n                    if (!hadHugeMutationsBefore_1 || isDOMReady()) {\r\n                        observerCallbacks.forEach(function (_a) {\r\n                            var onHugeMutations = _a.onHugeMutations;\r\n                            return onHugeMutations(root);\r\n                        });\r\n                    }\r\n                    else if (!subscribedForReadyState_1) {\r\n                        domReadyListener = function () { return observerCallbacks.forEach(function (_a) {\r\n                            var onHugeMutations = _a.onHugeMutations;\r\n                            return onHugeMutations(root);\r\n                        }); };\r\n                        addDOMReadyListener(domReadyListener);\r\n                        subscribedForReadyState_1 = true;\r\n                    }\r\n                    hadHugeMutationsBefore_1 = true;\r\n                }\r\n                else {\r\n                    var elementsOperations_1 = getElementsTreeOperations(mutations);\r\n                    observerCallbacks.forEach(function (_a) {\r\n                        var onMinorMutations = _a.onMinorMutations;\r\n                        return onMinorMutations(elementsOperations_1);\r\n                    });\r\n                }\r\n            });\r\n            observer.observe(root, { childList: true, subtree: true });\r\n            optimizedTreeObservers.set(root, observer);\r\n            observerCallbacks = new Set();\r\n            optimizedTreeCallbacks.set(observer, observerCallbacks);\r\n        }\r\n        observerCallbacks.add(callbacks);\r\n        return {\r\n            disconnect: function () {\r\n                observerCallbacks.delete(callbacks);\r\n                if (domReadyListener) {\r\n                    removeDOMReadyListener(domReadyListener);\r\n                }\r\n                if (observerCallbacks.size === 0) {\r\n                    observer.disconnect();\r\n                    optimizedTreeCallbacks.delete(observer);\r\n                    optimizedTreeObservers.delete(root);\r\n                }\r\n            },\r\n        };\r\n    }\n\n    var anchor;\r\n    var parsedURLCache = new Map();\r\n    function fixBaseURL($url) {\r\n        if (!anchor) {\r\n            anchor = document.createElement('a');\r\n        }\r\n        anchor.href = $url;\r\n        return anchor.href;\r\n    }\r\n    function parseURL($url, $base) {\r\n        if ($base === void 0) { $base = null; }\r\n        var key = \"\" + $url + ($base ? \";\" + $base : '');\r\n        if (parsedURLCache.has(key)) {\r\n            return parsedURLCache.get(key);\r\n        }\r\n        if ($base) {\r\n            var parsedURL_1 = new URL($url, fixBaseURL($base));\r\n            parsedURLCache.set(key, parsedURL_1);\r\n            return parsedURL_1;\r\n        }\r\n        var parsedURL = new URL(fixBaseURL($url));\r\n        parsedURLCache.set($url, parsedURL);\r\n        return parsedURL;\r\n    }\r\n    function getAbsoluteURL($base, $relative) {\r\n        if ($relative.match(/^data\\\\?\\:/)) {\r\n            return $relative;\r\n        }\r\n        if (/^\\/\\//.test($relative)) {\r\n            return \"\" + location.protocol + $relative;\r\n        }\r\n        var b = parseURL($base);\r\n        var a = parseURL($relative, b.href);\r\n        return a.href;\r\n    }\r\n    function isRelativeHrefOnAbsolutePath(href) {\r\n        if (href.startsWith('data:')) {\r\n            return true;\r\n        }\r\n        var url = parseURL(href);\r\n        if (url.protocol !== location.protocol) {\r\n            return false;\r\n        }\r\n        if (url.hostname !== location.hostname) {\r\n            return false;\r\n        }\r\n        if (url.port !== location.port) {\r\n            return false;\r\n        }\r\n        return url.pathname === location.pathname;\r\n    }\n\n    function iterateCSSRules(rules, iterate, onMediaRuleError) {\r\n        forEach(rules, function (rule) {\r\n            if (rule.selectorText) {\r\n                iterate(rule);\r\n            }\r\n            else if (rule.href) {\r\n                try {\r\n                    iterateCSSRules(rule.styleSheet.cssRules, iterate, onMediaRuleError);\r\n                }\r\n                catch (err) {\r\n                    logInfo(\"Found a non-loaded link.\");\r\n                    onMediaRuleError && onMediaRuleError();\r\n                }\r\n            }\r\n            else if (rule.media) {\r\n                var media = Array.from(rule.media);\r\n                var isScreenOrAllOrQuery = media.some(function (m) { return m.startsWith('screen') || m.startsWith('all') || m.startsWith('('); });\r\n                var isPrintOrSpeech = media.some(function (m) { return m.startsWith('print') || m.startsWith('speech'); });\r\n                if (isScreenOrAllOrQuery || !isPrintOrSpeech) {\r\n                    iterateCSSRules(rule.cssRules, iterate, onMediaRuleError);\r\n                }\r\n            }\r\n            else if (rule.conditionText) {\r\n                if (CSS.supports(rule.conditionText)) {\r\n                    iterateCSSRules(rule.cssRules, iterate, onMediaRuleError);\r\n                }\r\n            }\r\n            else {\r\n                logWarn(\"CSSRule type not supported\", rule);\r\n            }\r\n        });\r\n    }\r\n    var shorthandVarDependantProperties = [\r\n        'background',\r\n        'border',\r\n        'border-color',\r\n        'border-bottom',\r\n        'border-left',\r\n        'border-right',\r\n        'border-top',\r\n        'outline',\r\n        'outline-color',\r\n    ];\r\n    var shorthandVarDepPropRegexps = isSafari ? shorthandVarDependantProperties.map(function (prop) {\r\n        var regexp = new RegExp(prop + \":\\\\s*(.*?)\\\\s*;\");\r\n        return [prop, regexp];\r\n    }) : null;\r\n    function iterateCSSDeclarations(style, iterate) {\r\n        forEach(style, function (property) {\r\n            var value = style.getPropertyValue(property).trim();\r\n            if (!value) {\r\n                return;\r\n            }\r\n            iterate(property, value);\r\n        });\r\n        var cssText = style.cssText;\r\n        if (cssText.includes('var(')) {\r\n            if (isSafari) {\r\n                shorthandVarDepPropRegexps.forEach(function (_a) {\r\n                    var _b = __read(_a, 2), prop = _b[0], regexp = _b[1];\r\n                    var match = cssText.match(regexp);\r\n                    if (match && match[1]) {\r\n                        var val = match[1].trim();\r\n                        iterate(prop, val);\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                shorthandVarDependantProperties.forEach(function (prop) {\r\n                    var val = style.getPropertyValue(prop);\r\n                    if (val && val.includes('var(')) {\r\n                        iterate(prop, val);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n    var cssURLRegex = /url\\((('.+?')|(\".+?\")|([^\\)]*?))\\)/g;\r\n    var cssImportRegex = /@import\\s*(url\\()?(('.+?')|(\".+?\")|([^\\)]*?))\\)? ?(screen)?;?/g;\r\n    function getCSSURLValue(cssURL) {\r\n        return cssURL.replace(/^url\\((.*)\\)$/, '$1').trim().replace(/^\"(.*)\"$/, '$1').replace(/^'(.*)'$/, '$1');\r\n    }\r\n    function getCSSBaseBath(url) {\r\n        var cssURL = parseURL(url);\r\n        return \"\" + cssURL.origin + cssURL.pathname.replace(/\\?.*$/, '').replace(/(\\/)([^\\/]+)$/i, '$1');\r\n    }\r\n    function replaceCSSRelativeURLsWithAbsolute($css, cssBasePath) {\r\n        return $css.replace(cssURLRegex, function (match) {\r\n            var pathValue = getCSSURLValue(match);\r\n            try {\r\n                return \"url(\\\"\" + getAbsoluteURL(cssBasePath, pathValue) + \"\\\")\";\r\n            }\r\n            catch (err) {\r\n                logWarn('Not able to replace relative URL with Absolute URL, skipping');\r\n                return match;\r\n            }\r\n        });\r\n    }\r\n    var cssCommentsRegex = /\\/\\*[\\s\\S]*?\\*\\//g;\r\n    function removeCSSComments($css) {\r\n        return $css.replace(cssCommentsRegex, '');\r\n    }\r\n    var fontFaceRegex = /@font-face\\s*{[^}]*}/g;\r\n    function replaceCSSFontFace($css) {\r\n        return $css.replace(fontFaceRegex, '');\r\n    }\n\n    function hslToRGB(_a) {\r\n        var h = _a.h, s = _a.s, l = _a.l, _b = _a.a, a = _b === void 0 ? 1 : _b;\r\n        if (s === 0) {\r\n            var _c = __read([l, l, l].map(function (x) { return Math.round(x * 255); }), 3), r_1 = _c[0], b_1 = _c[1], g_1 = _c[2];\r\n            return { r: r_1, g: g_1, b: b_1, a: a };\r\n        }\r\n        var c = (1 - Math.abs(2 * l - 1)) * s;\r\n        var x = c * (1 - Math.abs((h / 60) % 2 - 1));\r\n        var m = l - c / 2;\r\n        var _d = __read((h < 60 ? [c, x, 0] :\r\n            h < 120 ? [x, c, 0] :\r\n                h < 180 ? [0, c, x] :\r\n                    h < 240 ? [0, x, c] :\r\n                        h < 300 ? [x, 0, c] :\r\n                            [c, 0, x]).map(function (n) { return Math.round((n + m) * 255); }), 3), r = _d[0], g = _d[1], b = _d[2];\r\n        return { r: r, g: g, b: b, a: a };\r\n    }\r\n    function rgbToHSL(_a) {\r\n        var r255 = _a.r, g255 = _a.g, b255 = _a.b, _b = _a.a, a = _b === void 0 ? 1 : _b;\r\n        var r = r255 / 255;\r\n        var g = g255 / 255;\r\n        var b = b255 / 255;\r\n        var max = Math.max(r, g, b);\r\n        var min = Math.min(r, g, b);\r\n        var c = max - min;\r\n        var l = (max + min) / 2;\r\n        if (c === 0) {\r\n            return { h: 0, s: 0, l: l, a: a };\r\n        }\r\n        var h = (max === r ? (((g - b) / c) % 6) :\r\n            max === g ? ((b - r) / c + 2) :\r\n                ((r - g) / c + 4)) * 60;\r\n        if (h < 0) {\r\n            h += 360;\r\n        }\r\n        var s = c / (1 - Math.abs(2 * l - 1));\r\n        return { h: h, s: s, l: l, a: a };\r\n    }\r\n    function toFixed(n, digits) {\r\n        if (digits === void 0) { digits = 0; }\r\n        var fixed = n.toFixed(digits);\r\n        if (digits === 0) {\r\n            return fixed;\r\n        }\r\n        var dot = fixed.indexOf('.');\r\n        if (dot >= 0) {\r\n            var zerosMatch = fixed.match(/0+$/);\r\n            if (zerosMatch) {\r\n                if (zerosMatch.index === dot + 1) {\r\n                    return fixed.substring(0, dot);\r\n                }\r\n                return fixed.substring(0, zerosMatch.index);\r\n            }\r\n        }\r\n        return fixed;\r\n    }\r\n    function rgbToString(rgb) {\r\n        var r = rgb.r, g = rgb.g, b = rgb.b, a = rgb.a;\r\n        if (a != null && a < 1) {\r\n            return \"rgba(\" + toFixed(r) + \", \" + toFixed(g) + \", \" + toFixed(b) + \", \" + toFixed(a, 2) + \")\";\r\n        }\r\n        return \"rgb(\" + toFixed(r) + \", \" + toFixed(g) + \", \" + toFixed(b) + \")\";\r\n    }\r\n    function rgbToHexString(_a) {\r\n        var r = _a.r, g = _a.g, b = _a.b, a = _a.a;\r\n        return \"#\" + (a != null && a < 1 ? [r, g, b, Math.round(a * 255)] : [r, g, b]).map(function (x) {\r\n            return \"\" + (x < 16 ? '0' : '') + x.toString(16);\r\n        }).join('');\r\n    }\r\n    function hslToString(hsl) {\r\n        var h = hsl.h, s = hsl.s, l = hsl.l, a = hsl.a;\r\n        if (a != null && a < 1) {\r\n            return \"hsla(\" + toFixed(h) + \", \" + toFixed(s * 100) + \"%, \" + toFixed(l * 100) + \"%, \" + toFixed(a, 2) + \")\";\r\n        }\r\n        return \"hsl(\" + toFixed(h) + \", \" + toFixed(s * 100) + \"%, \" + toFixed(l * 100) + \"%)\";\r\n    }\r\n    var rgbMatch = /^rgba?\\([^\\(\\)]+\\)$/;\r\n    var hslMatch = /^hsla?\\([^\\(\\)]+\\)$/;\r\n    var hexMatch = /^#[0-9a-f]+$/i;\r\n    function parse($color) {\r\n        var c = $color.trim().toLowerCase();\r\n        if (c.match(rgbMatch)) {\r\n            return parseRGB(c);\r\n        }\r\n        if (c.match(hslMatch)) {\r\n            return parseHSL(c);\r\n        }\r\n        if (c.match(hexMatch)) {\r\n            return parseHex(c);\r\n        }\r\n        if (knownColors.has(c)) {\r\n            return getColorByName(c);\r\n        }\r\n        if (systemColors.has(c)) {\r\n            return getSystemColor(c);\r\n        }\r\n        if ($color === 'transparent') {\r\n            return { r: 0, g: 0, b: 0, a: 0 };\r\n        }\r\n        throw new Error(\"Unable to parse \" + $color);\r\n    }\r\n    function getNumbers($color) {\r\n        var numbers = [];\r\n        var prevPos = 0;\r\n        var isMining = false;\r\n        var startIndex = $color.indexOf('(');\r\n        $color = $color.substring(startIndex + 1, $color.length - 1);\r\n        for (var i = 0; i < $color.length; i++) {\r\n            var c = $color[i];\r\n            if (c >= '0' && c <= '9' || c === '.' || c === '+' || c === '-') {\r\n                isMining = true;\r\n            }\r\n            else if (isMining && (c === ' ' || c === ',')) {\r\n                numbers.push($color.substring(prevPos, i));\r\n                isMining = false;\r\n                prevPos = i + 1;\r\n            }\r\n            else if (!isMining) {\r\n                prevPos = i + 1;\r\n            }\r\n        }\r\n        if (isMining) {\r\n            numbers.push($color.substring(prevPos, $color.length));\r\n        }\r\n        return numbers;\r\n    }\r\n    function getNumbersFromString(str, range, units) {\r\n        var raw = getNumbers(str);\r\n        var unitsList = Object.entries(units);\r\n        var numbers = raw.map(function (r) { return r.trim(); }).map(function (r, i) {\r\n            var n;\r\n            var unit = unitsList.find(function (_a) {\r\n                var _b = __read(_a, 1), u = _b[0];\r\n                return r.endsWith(u);\r\n            });\r\n            if (unit) {\r\n                n = parseFloat(r.substring(0, r.length - unit[0].length)) / unit[1] * range[i];\r\n            }\r\n            else {\r\n                n = parseFloat(r);\r\n            }\r\n            if (range[i] > 1) {\r\n                return Math.round(n);\r\n            }\r\n            return n;\r\n        });\r\n        return numbers;\r\n    }\r\n    var rgbRange = [255, 255, 255, 1];\r\n    var rgbUnits = { '%': 100 };\r\n    function parseRGB($rgb) {\r\n        var _a = __read(getNumbersFromString($rgb, rgbRange, rgbUnits), 4), r = _a[0], g = _a[1], b = _a[2], _b = _a[3], a = _b === void 0 ? 1 : _b;\r\n        return { r: r, g: g, b: b, a: a };\r\n    }\r\n    var hslRange = [360, 1, 1, 1];\r\n    var hslUnits = { '%': 100, 'deg': 360, 'rad': 2 * Math.PI, 'turn': 1 };\r\n    function parseHSL($hsl) {\r\n        var _a = __read(getNumbersFromString($hsl, hslRange, hslUnits), 4), h = _a[0], s = _a[1], l = _a[2], _b = _a[3], a = _b === void 0 ? 1 : _b;\r\n        return hslToRGB({ h: h, s: s, l: l, a: a });\r\n    }\r\n    function parseHex($hex) {\r\n        var h = $hex.substring(1);\r\n        switch (h.length) {\r\n            case 3:\r\n            case 4: {\r\n                var _a = __read([0, 1, 2].map(function (i) { return parseInt(\"\" + h[i] + h[i], 16); }), 3), r = _a[0], g = _a[1], b = _a[2];\r\n                var a = h.length === 3 ? 1 : (parseInt(\"\" + h[3] + h[3], 16) / 255);\r\n                return { r: r, g: g, b: b, a: a };\r\n            }\r\n            case 6:\r\n            case 8: {\r\n                var _b = __read([0, 2, 4].map(function (i) { return parseInt(h.substring(i, i + 2), 16); }), 3), r = _b[0], g = _b[1], b = _b[2];\r\n                var a = h.length === 6 ? 1 : (parseInt(h.substring(6, 8), 16) / 255);\r\n                return { r: r, g: g, b: b, a: a };\r\n            }\r\n        }\r\n        throw new Error(\"Unable to parse \" + $hex);\r\n    }\r\n    function getColorByName($color) {\r\n        var n = knownColors.get($color);\r\n        return {\r\n            r: (n >> 16) & 255,\r\n            g: (n >> 8) & 255,\r\n            b: (n >> 0) & 255,\r\n            a: 1\r\n        };\r\n    }\r\n    function getSystemColor($color) {\r\n        var n = systemColors.get($color);\r\n        return {\r\n            r: (n >> 16) & 255,\r\n            g: (n >> 8) & 255,\r\n            b: (n >> 0) & 255,\r\n            a: 1\r\n        };\r\n    }\r\n    var isCharDigit = function (char) { return char >= '0' && char <= '9'; };\r\n    var getAmountOfDigits = function (number) { return Math.floor(Math.log10(number)) + 1; };\r\n    function lowerCalcExpression(color) {\r\n        var searchIndex = 0;\r\n        var replaceBetweenIndices = function (start, end, replacement) {\r\n            color = color.substring(0, start) + replacement + color.substring(end);\r\n        };\r\n        var getNumber = function () {\r\n            var resultNumber = 0;\r\n            for (var i = 1; i < 4; i++) {\r\n                var char = color[searchIndex + i];\r\n                if (char === ' ') {\r\n                    break;\r\n                }\r\n                if (isCharDigit(char)) {\r\n                    resultNumber *= 10;\r\n                    resultNumber += Number(char);\r\n                }\r\n                else {\r\n                    break;\r\n                }\r\n            }\r\n            var lenDigits = getAmountOfDigits(resultNumber);\r\n            searchIndex += lenDigits;\r\n            var possibleType = color[searchIndex + 1];\r\n            if (possibleType !== '%') {\r\n                return;\r\n            }\r\n            searchIndex++;\r\n            return resultNumber;\r\n        };\r\n        while ((searchIndex = color.indexOf('calc(')) !== 0) {\r\n            var startIndex = searchIndex;\r\n            searchIndex += 4;\r\n            var firstNumber = getNumber();\r\n            if (!firstNumber) {\r\n                break;\r\n            }\r\n            if (color[searchIndex + 1] !== ' ') {\r\n                break;\r\n            }\r\n            searchIndex++;\r\n            var operation = color[searchIndex + 1];\r\n            if (operation !== '+' && operation !== '-') {\r\n                break;\r\n            }\r\n            searchIndex++;\r\n            if (color[searchIndex + 1] !== ' ') {\r\n                break;\r\n            }\r\n            searchIndex++;\r\n            var secondNumber = getNumber();\r\n            if (!secondNumber) {\r\n                break;\r\n            }\r\n            var replacement = void 0;\r\n            if (operation === '+') {\r\n                replacement = firstNumber + secondNumber + \"%\";\r\n            }\r\n            else {\r\n                replacement = firstNumber - secondNumber + \"%\";\r\n            }\r\n            replaceBetweenIndices(startIndex, searchIndex + 2, replacement);\r\n        }\r\n        return color;\r\n    }\r\n    var knownColors = new Map(Object.entries({\r\n        aliceblue: 0xf0f8ff,\r\n        antiquewhite: 0xfaebd7,\r\n        aqua: 0x00ffff,\r\n        aquamarine: 0x7fffd4,\r\n        azure: 0xf0ffff,\r\n        beige: 0xf5f5dc,\r\n        bisque: 0xffe4c4,\r\n        black: 0x000000,\r\n        blanchedalmond: 0xffebcd,\r\n        blue: 0x0000ff,\r\n        blueviolet: 0x8a2be2,\r\n        brown: 0xa52a2a,\r\n        burlywood: 0xdeb887,\r\n        cadetblue: 0x5f9ea0,\r\n        chartreuse: 0x7fff00,\r\n        chocolate: 0xd2691e,\r\n        coral: 0xff7f50,\r\n        cornflowerblue: 0x6495ed,\r\n        cornsilk: 0xfff8dc,\r\n        crimson: 0xdc143c,\r\n        cyan: 0x00ffff,\r\n        darkblue: 0x00008b,\r\n        darkcyan: 0x008b8b,\r\n        darkgoldenrod: 0xb8860b,\r\n        darkgray: 0xa9a9a9,\r\n        darkgrey: 0xa9a9a9,\r\n        darkgreen: 0x006400,\r\n        darkkhaki: 0xbdb76b,\r\n        darkmagenta: 0x8b008b,\r\n        darkolivegreen: 0x556b2f,\r\n        darkorange: 0xff8c00,\r\n        darkorchid: 0x9932cc,\r\n        darkred: 0x8b0000,\r\n        darksalmon: 0xe9967a,\r\n        darkseagreen: 0x8fbc8f,\r\n        darkslateblue: 0x483d8b,\r\n        darkslategray: 0x2f4f4f,\r\n        darkslategrey: 0x2f4f4f,\r\n        darkturquoise: 0x00ced1,\r\n        darkviolet: 0x9400d3,\r\n        deeppink: 0xff1493,\r\n        deepskyblue: 0x00bfff,\r\n        dimgray: 0x696969,\r\n        dimgrey: 0x696969,\r\n        dodgerblue: 0x1e90ff,\r\n        firebrick: 0xb22222,\r\n        floralwhite: 0xfffaf0,\r\n        forestgreen: 0x228b22,\r\n        fuchsia: 0xff00ff,\r\n        gainsboro: 0xdcdcdc,\r\n        ghostwhite: 0xf8f8ff,\r\n        gold: 0xffd700,\r\n        goldenrod: 0xdaa520,\r\n        gray: 0x808080,\r\n        grey: 0x808080,\r\n        green: 0x008000,\r\n        greenyellow: 0xadff2f,\r\n        honeydew: 0xf0fff0,\r\n        hotpink: 0xff69b4,\r\n        indianred: 0xcd5c5c,\r\n        indigo: 0x4b0082,\r\n        ivory: 0xfffff0,\r\n        khaki: 0xf0e68c,\r\n        lavender: 0xe6e6fa,\r\n        lavenderblush: 0xfff0f5,\r\n        lawngreen: 0x7cfc00,\r\n        lemonchiffon: 0xfffacd,\r\n        lightblue: 0xadd8e6,\r\n        lightcoral: 0xf08080,\r\n        lightcyan: 0xe0ffff,\r\n        lightgoldenrodyellow: 0xfafad2,\r\n        lightgray: 0xd3d3d3,\r\n        lightgrey: 0xd3d3d3,\r\n        lightgreen: 0x90ee90,\r\n        lightpink: 0xffb6c1,\r\n        lightsalmon: 0xffa07a,\r\n        lightseagreen: 0x20b2aa,\r\n        lightskyblue: 0x87cefa,\r\n        lightslategray: 0x778899,\r\n        lightslategrey: 0x778899,\r\n        lightsteelblue: 0xb0c4de,\r\n        lightyellow: 0xffffe0,\r\n        lime: 0x00ff00,\r\n        limegreen: 0x32cd32,\r\n        linen: 0xfaf0e6,\r\n        magenta: 0xff00ff,\r\n        maroon: 0x800000,\r\n        mediumaquamarine: 0x66cdaa,\r\n        mediumblue: 0x0000cd,\r\n        mediumorchid: 0xba55d3,\r\n        mediumpurple: 0x9370db,\r\n        mediumseagreen: 0x3cb371,\r\n        mediumslateblue: 0x7b68ee,\r\n        mediumspringgreen: 0x00fa9a,\r\n        mediumturquoise: 0x48d1cc,\r\n        mediumvioletred: 0xc71585,\r\n        midnightblue: 0x191970,\r\n        mintcream: 0xf5fffa,\r\n        mistyrose: 0xffe4e1,\r\n        moccasin: 0xffe4b5,\r\n        navajowhite: 0xffdead,\r\n        navy: 0x000080,\r\n        oldlace: 0xfdf5e6,\r\n        olive: 0x808000,\r\n        olivedrab: 0x6b8e23,\r\n        orange: 0xffa500,\r\n        orangered: 0xff4500,\r\n        orchid: 0xda70d6,\r\n        palegoldenrod: 0xeee8aa,\r\n        palegreen: 0x98fb98,\r\n        paleturquoise: 0xafeeee,\r\n        palevioletred: 0xdb7093,\r\n        papayawhip: 0xffefd5,\r\n        peachpuff: 0xffdab9,\r\n        peru: 0xcd853f,\r\n        pink: 0xffc0cb,\r\n        plum: 0xdda0dd,\r\n        powderblue: 0xb0e0e6,\r\n        purple: 0x800080,\r\n        rebeccapurple: 0x663399,\r\n        red: 0xff0000,\r\n        rosybrown: 0xbc8f8f,\r\n        royalblue: 0x4169e1,\r\n        saddlebrown: 0x8b4513,\r\n        salmon: 0xfa8072,\r\n        sandybrown: 0xf4a460,\r\n        seagreen: 0x2e8b57,\r\n        seashell: 0xfff5ee,\r\n        sienna: 0xa0522d,\r\n        silver: 0xc0c0c0,\r\n        skyblue: 0x87ceeb,\r\n        slateblue: 0x6a5acd,\r\n        slategray: 0x708090,\r\n        slategrey: 0x708090,\r\n        snow: 0xfffafa,\r\n        springgreen: 0x00ff7f,\r\n        steelblue: 0x4682b4,\r\n        tan: 0xd2b48c,\r\n        teal: 0x008080,\r\n        thistle: 0xd8bfd8,\r\n        tomato: 0xff6347,\r\n        turquoise: 0x40e0d0,\r\n        violet: 0xee82ee,\r\n        wheat: 0xf5deb3,\r\n        white: 0xffffff,\r\n        whitesmoke: 0xf5f5f5,\r\n        yellow: 0xffff00,\r\n        yellowgreen: 0x9acd32,\r\n    }));\r\n    var systemColors = new Map(Object.entries({\r\n        ActiveBorder: 0x3b99fc,\r\n        ActiveCaption: 0x000000,\r\n        AppWorkspace: 0xaaaaaa,\r\n        Background: 0x6363ce,\r\n        ButtonFace: 0xffffff,\r\n        ButtonHighlight: 0xe9e9e9,\r\n        ButtonShadow: 0x9fa09f,\r\n        ButtonText: 0x000000,\r\n        CaptionText: 0x000000,\r\n        GrayText: 0x7f7f7f,\r\n        Highlight: 0xb2d7ff,\r\n        HighlightText: 0x000000,\r\n        InactiveBorder: 0xffffff,\r\n        InactiveCaption: 0xffffff,\r\n        InactiveCaptionText: 0x000000,\r\n        InfoBackground: 0xfbfcc5,\r\n        InfoText: 0x000000,\r\n        Menu: 0xf6f6f6,\r\n        MenuText: 0xffffff,\r\n        Scrollbar: 0xaaaaaa,\r\n        ThreeDDarkShadow: 0x000000,\r\n        ThreeDFace: 0xc0c0c0,\r\n        ThreeDHighlight: 0xffffff,\r\n        ThreeDLightShadow: 0xffffff,\r\n        ThreeDShadow: 0x000000,\r\n        Window: 0xececec,\r\n        WindowFrame: 0xaaaaaa,\r\n        WindowText: 0x000000,\r\n        '-webkit-focus-ring-color': 0xe59700\r\n    }).map(function (_a) {\r\n        var _b = __read(_a, 2), key = _b[0], value = _b[1];\r\n        return [key.toLowerCase(), value];\r\n    }));\n\n    function scale(x, inLow, inHigh, outLow, outHigh) {\r\n        return (x - inLow) * (outHigh - outLow) / (inHigh - inLow) + outLow;\r\n    }\r\n    function clamp(x, min, max) {\r\n        return Math.min(max, Math.max(min, x));\r\n    }\r\n    function multiplyMatrices(m1, m2) {\r\n        var result = [];\r\n        for (var i = 0, len = m1.length; i < len; i++) {\r\n            result[i] = [];\r\n            for (var j = 0, len2 = m2[0].length; j < len2; j++) {\r\n                var sum = 0;\r\n                for (var k = 0, len3 = m1[0].length; k < len3; k++) {\r\n                    sum += m1[i][k] * m2[k][j];\r\n                }\r\n                result[i][j] = sum;\r\n            }\r\n        }\r\n        return result;\r\n    }\n\n    function getMatches(regex, input, group) {\r\n        if (group === void 0) { group = 0; }\r\n        var matches = [];\r\n        var m;\r\n        while ((m = regex.exec(input))) {\r\n            matches.push(m[group]);\r\n        }\r\n        return matches;\r\n    }\r\n    function formatCSS(text) {\r\n        function trimLeft(text) {\r\n            return text.replace(/^\\s+/, '');\r\n        }\r\n        function getIndent(depth) {\r\n            if (depth === 0) {\r\n                return '';\r\n            }\r\n            return ' '.repeat(4 * depth);\r\n        }\r\n        if (text.length < 50000) {\r\n            var emptyRuleRegexp = /[^{}]+{\\s*}/;\r\n            while (emptyRuleRegexp.test(text)) {\r\n                text = text.replace(emptyRuleRegexp, '');\r\n            }\r\n        }\r\n        var css = (text\r\n            .replace(/\\s{2,}/g, ' ')\r\n            .replace(/\\{/g, '{\\n')\r\n            .replace(/\\}/g, '\\n}\\n')\r\n            .replace(/\\;(?![^\\(|\\\"]*(\\)|\\\"))/g, ';\\n')\r\n            .replace(/\\,(?![^\\(|\\\"]*(\\)|\\\"))/g, ',\\n')\r\n            .replace(/\\n\\s*\\n/g, '\\n')\r\n            .split('\\n'));\r\n        var depth = 0;\r\n        var formatted = [];\r\n        for (var x = 0, len = css.length; x < len; x++) {\r\n            var line = css[x] + \"\\n\";\r\n            if (line.includes('{')) {\r\n                formatted.push(getIndent(depth++) + trimLeft(line));\r\n            }\r\n            else if (line.includes('\\}')) {\r\n                formatted.push(getIndent(--depth) + trimLeft(line));\r\n            }\r\n            else {\r\n                formatted.push(getIndent(depth) + trimLeft(line));\r\n            }\r\n        }\r\n        return formatted.join('').trim();\r\n    }\r\n    function getParenthesesRange(input, searchStartIndex) {\r\n        if (searchStartIndex === void 0) { searchStartIndex = 0; }\r\n        var length = input.length;\r\n        var depth = 0;\r\n        var firstOpenIndex = -1;\r\n        for (var i = searchStartIndex; i < length; i++) {\r\n            if (depth === 0) {\r\n                var openIndex = input.indexOf('(', i);\r\n                if (openIndex < 0) {\r\n                    break;\r\n                }\r\n                firstOpenIndex = openIndex;\r\n                depth++;\r\n                i = openIndex;\r\n            }\r\n            else {\r\n                var closingIndex = input.indexOf(')', i);\r\n                if (closingIndex < 0) {\r\n                    break;\r\n                }\r\n                var openIndex = input.indexOf('(', i);\r\n                if (openIndex < 0 || closingIndex < openIndex) {\r\n                    depth--;\r\n                    if (depth === 0) {\r\n                        return { start: firstOpenIndex, end: closingIndex + 1 };\r\n                    }\r\n                    i = closingIndex;\r\n                }\r\n                else {\r\n                    depth++;\r\n                    i = openIndex;\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }\n\n    function createFilterMatrix(config) {\r\n        var m = Matrix.identity();\r\n        if (config.sepia !== 0) {\r\n            m = multiplyMatrices(m, Matrix.sepia(config.sepia / 100));\r\n        }\r\n        if (config.grayscale !== 0) {\r\n            m = multiplyMatrices(m, Matrix.grayscale(config.grayscale / 100));\r\n        }\r\n        if (config.contrast !== 100) {\r\n            m = multiplyMatrices(m, Matrix.contrast(config.contrast / 100));\r\n        }\r\n        if (config.brightness !== 100) {\r\n            m = multiplyMatrices(m, Matrix.brightness(config.brightness / 100));\r\n        }\r\n        if (config.mode === 1) {\r\n            m = multiplyMatrices(m, Matrix.invertNHue());\r\n        }\r\n        return m;\r\n    }\r\n    function applyColorMatrix(_a, matrix) {\r\n        var _b = __read(_a, 3), r = _b[0], g = _b[1], b = _b[2];\r\n        var rgb = [[r / 255], [g / 255], [b / 255], [1], [1]];\r\n        var result = multiplyMatrices(matrix, rgb);\r\n        return [0, 1, 2].map(function (i) { return clamp(Math.round(result[i][0] * 255), 0, 255); });\r\n    }\r\n    var Matrix = {\r\n        identity: function () {\r\n            return [\r\n                [1, 0, 0, 0, 0],\r\n                [0, 1, 0, 0, 0],\r\n                [0, 0, 1, 0, 0],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        invertNHue: function () {\r\n            return [\r\n                [0.333, -0.667, -0.667, 0, 1],\r\n                [-0.667, 0.333, -0.667, 0, 1],\r\n                [-0.667, -0.667, 0.333, 0, 1],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        brightness: function (v) {\r\n            return [\r\n                [v, 0, 0, 0, 0],\r\n                [0, v, 0, 0, 0],\r\n                [0, 0, v, 0, 0],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        contrast: function (v) {\r\n            var t = (1 - v) / 2;\r\n            return [\r\n                [v, 0, 0, 0, t],\r\n                [0, v, 0, 0, t],\r\n                [0, 0, v, 0, t],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        sepia: function (v) {\r\n            return [\r\n                [(0.393 + 0.607 * (1 - v)), (0.769 - 0.769 * (1 - v)), (0.189 - 0.189 * (1 - v)), 0, 0],\r\n                [(0.349 - 0.349 * (1 - v)), (0.686 + 0.314 * (1 - v)), (0.168 - 0.168 * (1 - v)), 0, 0],\r\n                [(0.272 - 0.272 * (1 - v)), (0.534 - 0.534 * (1 - v)), (0.131 + 0.869 * (1 - v)), 0, 0],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        grayscale: function (v) {\r\n            return [\r\n                [(0.2126 + 0.7874 * (1 - v)), (0.7152 - 0.7152 * (1 - v)), (0.0722 - 0.0722 * (1 - v)), 0, 0],\r\n                [(0.2126 - 0.2126 * (1 - v)), (0.7152 + 0.2848 * (1 - v)), (0.0722 - 0.0722 * (1 - v)), 0, 0],\r\n                [(0.2126 - 0.2126 * (1 - v)), (0.7152 - 0.7152 * (1 - v)), (0.0722 + 0.9278 * (1 - v)), 0, 0],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n    };\n\n    function getBgPole(theme) {\r\n        var isDarkScheme = theme.mode === 1;\r\n        var prop = isDarkScheme ? 'darkSchemeBackgroundColor' : 'lightSchemeBackgroundColor';\r\n        return theme[prop];\r\n    }\r\n    function getFgPole(theme) {\r\n        var isDarkScheme = theme.mode === 1;\r\n        var prop = isDarkScheme ? 'darkSchemeTextColor' : 'lightSchemeTextColor';\r\n        return theme[prop];\r\n    }\r\n    var colorModificationCache = new Map();\r\n    var colorParseCache$1 = new Map();\r\n    function parseToHSLWithCache(color) {\r\n        if (colorParseCache$1.has(color)) {\r\n            return colorParseCache$1.get(color);\r\n        }\r\n        var rgb = parse(color);\r\n        var hsl = rgbToHSL(rgb);\r\n        colorParseCache$1.set(color, hsl);\r\n        return hsl;\r\n    }\r\n    function clearColorModificationCache() {\r\n        colorModificationCache.clear();\r\n        colorParseCache$1.clear();\r\n    }\r\n    var rgbCacheKeys = ['r', 'g', 'b', 'a'];\r\n    var themeCacheKeys$1 = ['mode', 'brightness', 'contrast', 'grayscale', 'sepia', 'darkSchemeBackgroundColor', 'darkSchemeTextColor', 'lightSchemeBackgroundColor', 'lightSchemeTextColor'];\r\n    function getCacheId(rgb, theme) {\r\n        var resultId = '';\r\n        rgbCacheKeys.forEach(function (key) {\r\n            resultId += rgb[key] + \";\";\r\n        });\r\n        themeCacheKeys$1.forEach(function (key) {\r\n            resultId += theme[key] + \";\";\r\n        });\r\n        return resultId;\r\n    }\r\n    function modifyColorWithCache(rgb, theme, modifyHSL, poleColor, anotherPoleColor) {\r\n        var fnCache;\r\n        if (colorModificationCache.has(modifyHSL)) {\r\n            fnCache = colorModificationCache.get(modifyHSL);\r\n        }\r\n        else {\r\n            fnCache = new Map();\r\n            colorModificationCache.set(modifyHSL, fnCache);\r\n        }\r\n        var id = getCacheId(rgb, theme);\r\n        if (fnCache.has(id)) {\r\n            return fnCache.get(id);\r\n        }\r\n        var hsl = rgbToHSL(rgb);\r\n        var pole = poleColor == null ? null : parseToHSLWithCache(poleColor);\r\n        var anotherPole = anotherPoleColor == null ? null : parseToHSLWithCache(anotherPoleColor);\r\n        var modified = modifyHSL(hsl, pole, anotherPole);\r\n        var _a = hslToRGB(modified), r = _a.r, g = _a.g, b = _a.b, a = _a.a;\r\n        var matrix = createFilterMatrix(theme);\r\n        var _b = __read(applyColorMatrix([r, g, b], matrix), 3), rf = _b[0], gf = _b[1], bf = _b[2];\r\n        var color = (a === 1 ?\r\n            rgbToHexString({ r: rf, g: gf, b: bf }) :\r\n            rgbToString({ r: rf, g: gf, b: bf, a: a }));\r\n        fnCache.set(id, color);\r\n        return color;\r\n    }\r\n    function noopHSL(hsl) {\r\n        return hsl;\r\n    }\r\n    function modifyColor(rgb, theme) {\r\n        return modifyColorWithCache(rgb, theme, noopHSL);\r\n    }\r\n    function modifyLightSchemeColor(rgb, theme) {\r\n        var poleBg = getBgPole(theme);\r\n        var poleFg = getFgPole(theme);\r\n        return modifyColorWithCache(rgb, theme, modifyLightModeHSL, poleFg, poleBg);\r\n    }\r\n    function modifyLightModeHSL(_a, poleFg, poleBg) {\r\n        var h = _a.h, s = _a.s, l = _a.l, a = _a.a;\r\n        var isDark = l < 0.5;\r\n        var isNeutral;\r\n        if (isDark) {\r\n            isNeutral = l < 0.2 || s < 0.12;\r\n        }\r\n        else {\r\n            var isBlue = h > 200 && h < 280;\r\n            isNeutral = s < 0.24 || (l > 0.8 && isBlue);\r\n        }\r\n        var hx = h;\r\n        var sx = l;\r\n        if (isNeutral) {\r\n            if (isDark) {\r\n                hx = poleFg.h;\r\n                sx = poleFg.s;\r\n            }\r\n            else {\r\n                hx = poleBg.h;\r\n                sx = poleBg.s;\r\n            }\r\n        }\r\n        var lx = scale(l, 0, 1, poleFg.l, poleBg.l);\r\n        return { h: hx, s: sx, l: lx, a: a };\r\n    }\r\n    var MAX_BG_LIGHTNESS = 0.4;\r\n    function modifyBgHSL(_a, pole) {\r\n        var h = _a.h, s = _a.s, l = _a.l, a = _a.a;\r\n        var isDark = l < 0.5;\r\n        var isBlue = h > 200 && h < 280;\r\n        var isNeutral = s < 0.12 || (l > 0.8 && isBlue);\r\n        if (isDark) {\r\n            var lx_1 = scale(l, 0, 0.5, 0, MAX_BG_LIGHTNESS);\r\n            if (isNeutral) {\r\n                var hx_1 = pole.h;\r\n                var sx = pole.s;\r\n                return { h: hx_1, s: sx, l: lx_1, a: a };\r\n            }\r\n            return { h: h, s: s, l: lx_1, a: a };\r\n        }\r\n        var lx = scale(l, 0.5, 1, MAX_BG_LIGHTNESS, pole.l);\r\n        if (isNeutral) {\r\n            var hx_2 = pole.h;\r\n            var sx = pole.s;\r\n            return { h: hx_2, s: sx, l: lx, a: a };\r\n        }\r\n        var hx = h;\r\n        var isYellow = h > 60 && h < 180;\r\n        if (isYellow) {\r\n            var isCloserToGreen = h > 120;\r\n            if (isCloserToGreen) {\r\n                hx = scale(h, 120, 180, 135, 180);\r\n            }\r\n            else {\r\n                hx = scale(h, 60, 120, 60, 105);\r\n            }\r\n        }\r\n        return { h: hx, s: s, l: lx, a: a };\r\n    }\r\n    function modifyBackgroundColor(rgb, theme) {\r\n        if (theme.mode === 0) {\r\n            return modifyLightSchemeColor(rgb, theme);\r\n        }\r\n        var pole = getBgPole(theme);\r\n        return modifyColorWithCache(rgb, __assign(__assign({}, theme), { mode: 0 }), modifyBgHSL, pole);\r\n    }\r\n    var MIN_FG_LIGHTNESS = 0.55;\r\n    function modifyBlueFgHue(hue) {\r\n        return scale(hue, 205, 245, 205, 220);\r\n    }\r\n    function modifyFgHSL(_a, pole) {\r\n        var h = _a.h, s = _a.s, l = _a.l, a = _a.a;\r\n        var isLight = l > 0.5;\r\n        var isNeutral = l < 0.2 || s < 0.24;\r\n        var isBlue = !isNeutral && h > 205 && h < 245;\r\n        if (isLight) {\r\n            var lx_2 = scale(l, 0.5, 1, MIN_FG_LIGHTNESS, pole.l);\r\n            if (isNeutral) {\r\n                var hx_3 = pole.h;\r\n                var sx = pole.s;\r\n                return { h: hx_3, s: sx, l: lx_2, a: a };\r\n            }\r\n            var hx_4 = h;\r\n            if (isBlue) {\r\n                hx_4 = modifyBlueFgHue(h);\r\n            }\r\n            return { h: hx_4, s: s, l: lx_2, a: a };\r\n        }\r\n        if (isNeutral) {\r\n            var hx_5 = pole.h;\r\n            var sx = pole.s;\r\n            var lx_3 = scale(l, 0, 0.5, pole.l, MIN_FG_LIGHTNESS);\r\n            return { h: hx_5, s: sx, l: lx_3, a: a };\r\n        }\r\n        var hx = h;\r\n        var lx;\r\n        if (isBlue) {\r\n            hx = modifyBlueFgHue(h);\r\n            lx = scale(l, 0, 0.5, pole.l, Math.min(1, MIN_FG_LIGHTNESS + 0.05));\r\n        }\r\n        else {\r\n            lx = scale(l, 0, 0.5, pole.l, MIN_FG_LIGHTNESS);\r\n        }\r\n        return { h: hx, s: s, l: lx, a: a };\r\n    }\r\n    function modifyForegroundColor(rgb, theme) {\r\n        if (theme.mode === 0) {\r\n            return modifyLightSchemeColor(rgb, theme);\r\n        }\r\n        var pole = getFgPole(theme);\r\n        return modifyColorWithCache(rgb, __assign(__assign({}, theme), { mode: 0 }), modifyFgHSL, pole);\r\n    }\r\n    function modifyBorderHSL(_a, poleFg, poleBg) {\r\n        var h = _a.h, s = _a.s, l = _a.l, a = _a.a;\r\n        var isDark = l < 0.5;\r\n        var isNeutral = l < 0.2 || s < 0.24;\r\n        var hx = h;\r\n        var sx = s;\r\n        if (isNeutral) {\r\n            if (isDark) {\r\n                hx = poleFg.h;\r\n                sx = poleFg.s;\r\n            }\r\n            else {\r\n                hx = poleBg.h;\r\n                sx = poleBg.s;\r\n            }\r\n        }\r\n        var lx = scale(l, 0, 1, 0.5, 0.2);\r\n        return { h: hx, s: sx, l: lx, a: a };\r\n    }\r\n    function modifyBorderColor(rgb, theme) {\r\n        if (theme.mode === 0) {\r\n            return modifyLightSchemeColor(rgb, theme);\r\n        }\r\n        var poleFg = getFgPole(theme);\r\n        var poleBg = getBgPole(theme);\r\n        return modifyColorWithCache(rgb, __assign(__assign({}, theme), { mode: 0 }), modifyBorderHSL, poleFg, poleBg);\r\n    }\r\n    function modifyShadowColor(rgb, filter) {\r\n        return modifyBackgroundColor(rgb, filter);\r\n    }\r\n    function modifyGradientColor(rgb, filter) {\r\n        return modifyBackgroundColor(rgb, filter);\r\n    }\n\n    function createTextStyle(config) {\r\n        var lines = [];\r\n        lines.push('*:not(pre, pre *, code, .far, .fa, .glyphicon, [class*=\"vjs-\"], .fab, .fa-github, .fas, .material-icons, .icofont, .typcn, mu, [class*=\"mu-\"], .glyphicon, .icon) {');\r\n        if (config.useFont && config.fontFamily) {\r\n            lines.push(\"  font-family: \" + config.fontFamily + \" !important;\");\r\n        }\r\n        if (config.textStroke > 0) {\r\n            lines.push(\"  -webkit-text-stroke: \" + config.textStroke + \"px !important;\");\r\n            lines.push(\"  text-stroke: \" + config.textStroke + \"px !important;\");\r\n        }\r\n        lines.push('}');\r\n        return lines.join('\\n');\r\n    }\n\n    var FilterMode;\r\n    (function (FilterMode) {\r\n        FilterMode[FilterMode[\"light\"] = 0] = \"light\";\r\n        FilterMode[FilterMode[\"dark\"] = 1] = \"dark\";\r\n    })(FilterMode || (FilterMode = {}));\r\n    function getCSSFilterValue(config) {\r\n        var filters = [];\r\n        if (config.mode === FilterMode.dark) {\r\n            filters.push('invert(100%) hue-rotate(180deg)');\r\n        }\r\n        if (config.brightness !== 100) {\r\n            filters.push(\"brightness(\" + config.brightness + \"%)\");\r\n        }\r\n        if (config.contrast !== 100) {\r\n            filters.push(\"contrast(\" + config.contrast + \"%)\");\r\n        }\r\n        if (config.grayscale !== 0) {\r\n            filters.push(\"grayscale(\" + config.grayscale + \"%)\");\r\n        }\r\n        if (config.sepia !== 0) {\r\n            filters.push(\"sepia(\" + config.sepia + \"%)\");\r\n        }\r\n        if (filters.length === 0) {\r\n            return null;\r\n        }\r\n        return filters.join(' ');\r\n    }\n\n    function toSVGMatrix(matrix) {\r\n        return matrix.slice(0, 4).map(function (m) { return m.map(function (m) { return m.toFixed(3); }).join(' '); }).join(' ');\r\n    }\r\n    function getSVGFilterMatrixValue(config) {\r\n        return toSVGMatrix(createFilterMatrix(config));\r\n    }\n\n    var counter = 0;\r\n    var resolvers$1 = new Map();\r\n    var rejectors = new Map();\r\n    function bgFetch(request) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve, reject) {\r\n                        var id = ++counter;\r\n                        resolvers$1.set(id, resolve);\r\n                        rejectors.set(id, reject);\r\n                        if (typeof chrome !== 'undefined') {\r\n                            chrome.runtime.sendMessage({ type: MessageType.CS_FETCH, data: request, id: id });\r\n                        }\r\n                    })];\r\n            });\r\n        });\r\n    }\r\n    if (typeof chrome !== 'undefined') {\r\n        chrome.runtime.onMessage.addListener(function (_a) {\r\n            var type = _a.type, data = _a.data, error = _a.error, id = _a.id;\r\n            if (type === MessageType.BG_FETCH_RESPONSE) {\r\n                var resolve = resolvers$1.get(id);\r\n                var reject = rejectors.get(id);\r\n                resolvers$1.delete(id);\r\n                rejectors.delete(id);\r\n                if (error) {\r\n                    reject && reject(error);\r\n                }\r\n                else {\r\n                    resolve && resolve(data);\r\n                }\r\n            }\r\n        });\r\n    }\n\n    var AsyncQueue = (function () {\r\n        function AsyncQueue() {\r\n            this.queue = [];\r\n            this.timerId = null;\r\n            this.frameDuration = 1000 / 60;\r\n        }\r\n        AsyncQueue.prototype.addToQueue = function (entry) {\r\n            this.queue.push(entry);\r\n            this.startQueue();\r\n        };\r\n        AsyncQueue.prototype.stopQueue = function () {\r\n            if (this.timerId !== null) {\r\n                cancelAnimationFrame(this.timerId);\r\n                this.timerId = null;\r\n            }\r\n            this.queue = [];\r\n        };\r\n        AsyncQueue.prototype.startQueue = function () {\r\n            var _this = this;\r\n            if (this.timerId) {\r\n                return;\r\n            }\r\n            this.timerId = requestAnimationFrame(function () {\r\n                _this.timerId = null;\r\n                var start = Date.now();\r\n                var cb;\r\n                while ((cb = _this.queue.shift())) {\r\n                    cb();\r\n                    if (Date.now() - start >= _this.frameDuration) {\r\n                        _this.startQueue();\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n        };\r\n        return AsyncQueue;\r\n    }());\n\n    var imageManager = new AsyncQueue();\r\n    function getImageDetails(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {\r\n                        var dataURL, error_1, image_1, error_2;\r\n                        return __generator(this, function (_a) {\r\n                            switch (_a.label) {\r\n                                case 0:\r\n                                    if (!url.startsWith('data:')) return [3, 1];\r\n                                    dataURL = url;\r\n                                    return [3, 4];\r\n                                case 1:\r\n                                    _a.trys.push([1, 3, , 4]);\r\n                                    return [4, getImageDataURL(url)];\r\n                                case 2:\r\n                                    dataURL = _a.sent();\r\n                                    return [3, 4];\r\n                                case 3:\r\n                                    error_1 = _a.sent();\r\n                                    reject(error_1);\r\n                                    return [2];\r\n                                case 4:\r\n                                    _a.trys.push([4, 6, , 7]);\r\n                                    return [4, urlToImage(dataURL)];\r\n                                case 5:\r\n                                    image_1 = _a.sent();\r\n                                    imageManager.addToQueue(function () {\r\n                                        resolve(__assign({ src: url, dataURL: dataURL, width: image_1.naturalWidth, height: image_1.naturalHeight }, analyzeImage(image_1)));\r\n                                    });\r\n                                    return [3, 7];\r\n                                case 6:\r\n                                    error_2 = _a.sent();\r\n                                    reject(error_2);\r\n                                    return [3, 7];\r\n                                case 7: return [2];\r\n                            }\r\n                        });\r\n                    }); })];\r\n            });\r\n        });\r\n    }\r\n    function getImageDataURL(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var parsedURL;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        parsedURL = new URL(url);\r\n                        if (!(parsedURL.origin === location.origin)) return [3, 2];\r\n                        return [4, loadAsDataURL(url)];\r\n                    case 1: return [2, _a.sent()];\r\n                    case 2: return [4, bgFetch({ url: url, responseType: 'data-url' })];\r\n                    case 3: return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function urlToImage(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve, reject) {\r\n                        var image = new Image();\r\n                        image.onload = function () { return resolve(image); };\r\n                        image.onerror = function () { return reject(\"Unable to load image \" + url); };\r\n                        image.src = url;\r\n                    })];\r\n            });\r\n        });\r\n    }\r\n    var MAX_ANALIZE_PIXELS_COUNT = 32 * 32;\r\n    var canvas;\r\n    var context;\r\n    function createCanvas() {\r\n        var maxWidth = MAX_ANALIZE_PIXELS_COUNT;\r\n        var maxHeight = MAX_ANALIZE_PIXELS_COUNT;\r\n        canvas = document.createElement('canvas');\r\n        canvas.width = maxWidth;\r\n        canvas.height = maxHeight;\r\n        context = canvas.getContext('2d');\r\n        context.imageSmoothingEnabled = false;\r\n    }\r\n    function removeCanvas() {\r\n        canvas = null;\r\n        context = null;\r\n    }\r\n    var MAX_IMAGE_SIZE = 5 * 1024 * 1024;\r\n    function analyzeImage(image) {\r\n        if (!canvas) {\r\n            createCanvas();\r\n        }\r\n        var naturalWidth = image.naturalWidth, naturalHeight = image.naturalHeight;\r\n        if (naturalHeight === 0 || naturalWidth === 0) {\r\n            logWarn(\"logWarn(Image is empty \" + image.currentSrc + \")\");\r\n            return null;\r\n        }\r\n        var size = naturalWidth * naturalHeight * 4;\r\n        if (size > MAX_IMAGE_SIZE) {\r\n            logInfo('Skipped large image analyzing(Larger than 5mb in memory)');\r\n            return {\r\n                isDark: false,\r\n                isLight: false,\r\n                isTransparent: false,\r\n                isLarge: false,\r\n                isTooLarge: true,\r\n            };\r\n        }\r\n        var naturalPixelsCount = naturalWidth * naturalHeight;\r\n        var k = Math.min(1, Math.sqrt(MAX_ANALIZE_PIXELS_COUNT / naturalPixelsCount));\r\n        var width = Math.ceil(naturalWidth * k);\r\n        var height = Math.ceil(naturalHeight * k);\r\n        context.clearRect(0, 0, width, height);\r\n        context.drawImage(image, 0, 0, naturalWidth, naturalHeight, 0, 0, width, height);\r\n        var imageData = context.getImageData(0, 0, width, height);\r\n        var d = imageData.data;\r\n        var TRANSPARENT_ALPHA_THRESHOLD = 0.05;\r\n        var DARK_LIGHTNESS_THRESHOLD = 0.4;\r\n        var LIGHT_LIGHTNESS_THRESHOLD = 0.7;\r\n        var transparentPixelsCount = 0;\r\n        var darkPixelsCount = 0;\r\n        var lightPixelsCount = 0;\r\n        var i, x, y;\r\n        var r, g, b, a;\r\n        var l;\r\n        for (y = 0; y < height; y++) {\r\n            for (x = 0; x < width; x++) {\r\n                i = 4 * (y * width + x);\r\n                r = d[i + 0] / 255;\r\n                g = d[i + 1] / 255;\r\n                b = d[i + 2] / 255;\r\n                a = d[i + 3] / 255;\r\n                if (a < TRANSPARENT_ALPHA_THRESHOLD) {\r\n                    transparentPixelsCount++;\r\n                }\r\n                else {\r\n                    l = 0.2126 * r + 0.7152 * g + 0.0722 * b;\r\n                    if (l < DARK_LIGHTNESS_THRESHOLD) {\r\n                        darkPixelsCount++;\r\n                    }\r\n                    if (l > LIGHT_LIGHTNESS_THRESHOLD) {\r\n                        lightPixelsCount++;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        var totalPixelsCount = width * height;\r\n        var opaquePixelsCount = totalPixelsCount - transparentPixelsCount;\r\n        var DARK_IMAGE_THRESHOLD = 0.7;\r\n        var LIGHT_IMAGE_THRESHOLD = 0.7;\r\n        var TRANSPARENT_IMAGE_THRESHOLD = 0.1;\r\n        var LARGE_IMAGE_PIXELS_COUNT = 800 * 600;\r\n        return {\r\n            isDark: ((darkPixelsCount / opaquePixelsCount) >= DARK_IMAGE_THRESHOLD),\r\n            isLight: ((lightPixelsCount / opaquePixelsCount) >= LIGHT_IMAGE_THRESHOLD),\r\n            isTransparent: ((transparentPixelsCount / totalPixelsCount) >= TRANSPARENT_IMAGE_THRESHOLD),\r\n            isLarge: (naturalPixelsCount >= LARGE_IMAGE_PIXELS_COUNT),\r\n            isTooLarge: false,\r\n        };\r\n    }\r\n    function getFilteredImageDataURL(_a, theme) {\r\n        var dataURL = _a.dataURL, width = _a.width, height = _a.height;\r\n        var matrix = getSVGFilterMatrixValue(theme);\r\n        var svg = [\r\n            \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" width=\\\"\" + width + \"\\\" height=\\\"\" + height + \"\\\">\",\r\n            '<defs>',\r\n            '<filter id=\"darkreader-image-filter\">',\r\n            \"<feColorMatrix type=\\\"matrix\\\" values=\\\"\" + matrix + \"\\\" />\",\r\n            '</filter>',\r\n            '</defs>',\r\n            \"<image width=\\\"\" + width + \"\\\" height=\\\"\" + height + \"\\\" filter=\\\"url(#darkreader-image-filter)\\\" xlink:href=\\\"\" + dataURL + \"\\\" />\",\r\n            '</svg>',\r\n        ].join('');\r\n        return \"data:image/svg+xml;base64,\" + btoa(svg);\r\n    }\r\n    function cleanImageProcessingCache() {\r\n        imageManager && imageManager.stopQueue();\r\n        removeCanvas();\r\n    }\n\n    function getPriority(ruleStyle, property) {\r\n        return Boolean(ruleStyle && ruleStyle.getPropertyPriority(property));\r\n    }\r\n    function getModifiableCSSDeclaration(property, value, rule, variablesStore, ignoreImageSelectors, isCancelled) {\r\n        if (property.startsWith('--')) {\r\n            var modifier = getVariableModifier(variablesStore, property, value, rule, ignoreImageSelectors, isCancelled);\r\n            if (modifier) {\r\n                return { property: property, value: modifier, important: getPriority(rule.style, property), sourceValue: value };\r\n            }\r\n        }\r\n        else if (value.includes('var(')) {\r\n            var modifier = getVariableDependantModifier(variablesStore, property, value);\r\n            if (modifier) {\r\n                return { property: property, value: modifier, important: getPriority(rule.style, property), sourceValue: value };\r\n            }\r\n        }\r\n        else if ((property.includes('color') && property !== '-webkit-print-color-adjust') ||\r\n            property === 'fill' ||\r\n            property === 'stroke' ||\r\n            property === 'stop-color') {\r\n            var modifier = getColorModifier(property, value);\r\n            if (modifier) {\r\n                return { property: property, value: modifier, important: getPriority(rule.style, property), sourceValue: value };\r\n            }\r\n        }\r\n        else if (property === 'background-image' || property === 'list-style-image') {\r\n            var modifier = getBgImageModifier(value, rule, ignoreImageSelectors, isCancelled);\r\n            if (modifier) {\r\n                return { property: property, value: modifier, important: getPriority(rule.style, property), sourceValue: value };\r\n            }\r\n        }\r\n        else if (property.includes('shadow')) {\r\n            var modifier = getShadowModifier(value);\r\n            if (modifier) {\r\n                return { property: property, value: modifier, important: getPriority(rule.style, property), sourceValue: value };\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    function getModifiedUserAgentStyle(theme, isIFrame, styleSystemControls) {\r\n        var lines = [];\r\n        if (!isIFrame) {\r\n            lines.push('html {');\r\n            lines.push(\"    background-color: \" + modifyBackgroundColor({ r: 255, g: 255, b: 255 }, theme) + \" !important;\");\r\n            lines.push('}');\r\n        }\r\n        lines.push(\"\" + (isIFrame ? '' : 'html, body, ') + (styleSystemControls ? 'input, textarea, select, button' : '') + \" {\");\r\n        lines.push(\"    background-color: \" + modifyBackgroundColor({ r: 255, g: 255, b: 255 }, theme) + \";\");\r\n        lines.push('}');\r\n        lines.push(\"html, body, \" + (styleSystemControls ? 'input, textarea, select, button' : '') + \" {\");\r\n        lines.push(\"    border-color: \" + modifyBorderColor({ r: 76, g: 76, b: 76 }, theme) + \";\");\r\n        lines.push(\"    color: \" + modifyForegroundColor({ r: 0, g: 0, b: 0 }, theme) + \";\");\r\n        lines.push('}');\r\n        lines.push('a {');\r\n        lines.push(\"    color: \" + modifyForegroundColor({ r: 0, g: 64, b: 255 }, theme) + \";\");\r\n        lines.push('}');\r\n        lines.push('table {');\r\n        lines.push(\"    border-color: \" + modifyBorderColor({ r: 128, g: 128, b: 128 }, theme) + \";\");\r\n        lines.push('}');\r\n        lines.push('::placeholder {');\r\n        lines.push(\"    color: \" + modifyForegroundColor({ r: 169, g: 169, b: 169 }, theme) + \";\");\r\n        lines.push('}');\r\n        lines.push('input:-webkit-autofill,');\r\n        lines.push('textarea:-webkit-autofill,');\r\n        lines.push('select:-webkit-autofill {');\r\n        lines.push(\"    background-color: \" + modifyBackgroundColor({ r: 250, g: 255, b: 189 }, theme) + \" !important;\");\r\n        lines.push(\"    color: \" + modifyForegroundColor({ r: 0, g: 0, b: 0 }, theme) + \" !important;\");\r\n        lines.push('}');\r\n        if (theme.scrollbarColor) {\r\n            lines.push(getModifiedScrollbarStyle(theme));\r\n        }\r\n        if (theme.selectionColor) {\r\n            lines.push(getModifiedSelectionStyle(theme));\r\n        }\r\n        return lines.join('\\n');\r\n    }\r\n    function getSelectionColor(theme) {\r\n        var backgroundColorSelection;\r\n        var foregroundColorSelection;\r\n        if (theme.selectionColor === 'auto') {\r\n            backgroundColorSelection = modifyBackgroundColor({ r: 0, g: 96, b: 212 }, __assign(__assign({}, theme), { grayscale: 0 }));\r\n            foregroundColorSelection = modifyForegroundColor({ r: 255, g: 255, b: 255 }, __assign(__assign({}, theme), { grayscale: 0 }));\r\n        }\r\n        else {\r\n            var rgb = parse(theme.selectionColor);\r\n            var hsl = rgbToHSL(rgb);\r\n            backgroundColorSelection = theme.selectionColor;\r\n            if (hsl.l < 0.5) {\r\n                foregroundColorSelection = '#FFF';\r\n            }\r\n            else {\r\n                foregroundColorSelection = '#000';\r\n            }\r\n        }\r\n        return { backgroundColorSelection: backgroundColorSelection, foregroundColorSelection: foregroundColorSelection };\r\n    }\r\n    function getModifiedSelectionStyle(theme) {\r\n        var lines = [];\r\n        var modifiedSelectionColor = getSelectionColor(theme);\r\n        var backgroundColorSelection = modifiedSelectionColor.backgroundColorSelection;\r\n        var foregroundColorSelection = modifiedSelectionColor.foregroundColorSelection;\r\n        ['::selection', '::-moz-selection'].forEach(function (selection) {\r\n            lines.push(selection + \" {\");\r\n            lines.push(\"    background-color: \" + backgroundColorSelection + \" !important;\");\r\n            lines.push(\"    color: \" + foregroundColorSelection + \" !important;\");\r\n            lines.push('}');\r\n        });\r\n        return lines.join('\\n');\r\n    }\r\n    function getModifiedScrollbarStyle(theme) {\r\n        var lines = [];\r\n        var colorTrack;\r\n        var colorIcons;\r\n        var colorThumb;\r\n        var colorThumbHover;\r\n        var colorThumbActive;\r\n        var colorCorner;\r\n        if (theme.scrollbarColor === 'auto') {\r\n            colorTrack = modifyBackgroundColor({ r: 241, g: 241, b: 241 }, theme);\r\n            colorIcons = modifyForegroundColor({ r: 96, g: 96, b: 96 }, theme);\r\n            colorThumb = modifyBackgroundColor({ r: 176, g: 176, b: 176 }, theme);\r\n            colorThumbHover = modifyBackgroundColor({ r: 144, g: 144, b: 144 }, theme);\r\n            colorThumbActive = modifyBackgroundColor({ r: 96, g: 96, b: 96 }, theme);\r\n            colorCorner = modifyBackgroundColor({ r: 255, g: 255, b: 255 }, theme);\r\n        }\r\n        else {\r\n            var rgb = parse(theme.scrollbarColor);\r\n            var hsl_1 = rgbToHSL(rgb);\r\n            var isLight = hsl_1.l > 0.5;\r\n            var lighten = function (lighter) { return (__assign(__assign({}, hsl_1), { l: clamp(hsl_1.l + lighter, 0, 1) })); };\r\n            var darken = function (darker) { return (__assign(__assign({}, hsl_1), { l: clamp(hsl_1.l - darker, 0, 1) })); };\r\n            colorTrack = hslToString(darken(0.4));\r\n            colorIcons = hslToString(isLight ? darken(0.4) : lighten(0.4));\r\n            colorThumb = hslToString(hsl_1);\r\n            colorThumbHover = hslToString(lighten(0.1));\r\n            colorThumbActive = hslToString(lighten(0.2));\r\n        }\r\n        lines.push('::-webkit-scrollbar {');\r\n        lines.push(\"    background-color: \" + colorTrack + \";\");\r\n        lines.push(\"    color: \" + colorIcons + \";\");\r\n        lines.push('}');\r\n        lines.push('::-webkit-scrollbar-thumb {');\r\n        lines.push(\"    background-color: \" + colorThumb + \";\");\r\n        lines.push('}');\r\n        lines.push('::-webkit-scrollbar-thumb:hover {');\r\n        lines.push(\"    background-color: \" + colorThumbHover + \";\");\r\n        lines.push('}');\r\n        lines.push('::-webkit-scrollbar-thumb:active {');\r\n        lines.push(\"    background-color: \" + colorThumbActive + \";\");\r\n        lines.push('}');\r\n        lines.push('::-webkit-scrollbar-corner {');\r\n        lines.push(\"    background-color: \" + colorCorner + \";\");\r\n        lines.push('}');\r\n        if (isFirefox) {\r\n            lines.push('* {');\r\n            lines.push(\"    scrollbar-color: \" + colorThumb + \" \" + colorTrack + \";\");\r\n            lines.push('}');\r\n        }\r\n        return lines.join('\\n');\r\n    }\r\n    function getModifiedFallbackStyle(filter, _a) {\r\n        var strict = _a.strict;\r\n        var lines = [];\r\n        var isMicrosoft = location.hostname.endsWith('microsoft.com');\r\n        lines.push(\"html, body, \" + (strict ? \"body :not(iframe)\" + (isMicrosoft ? ':not(div[style^=\"position:absolute;top:0;left:-\"]' : '') : 'body > :not(iframe)') + \" {\");\r\n        lines.push(\"    background-color: \" + modifyBackgroundColor({ r: 255, g: 255, b: 255 }, filter) + \" !important;\");\r\n        lines.push(\"    border-color: \" + modifyBorderColor({ r: 64, g: 64, b: 64 }, filter) + \" !important;\");\r\n        lines.push(\"    color: \" + modifyForegroundColor({ r: 0, g: 0, b: 0 }, filter) + \" !important;\");\r\n        lines.push('}');\r\n        return lines.join('\\n');\r\n    }\r\n    var unparsableColors = new Set([\r\n        'inherit',\r\n        'transparent',\r\n        'initial',\r\n        'currentcolor',\r\n        'none',\r\n        'unset',\r\n    ]);\r\n    var colorParseCache = new Map();\r\n    function parseColorWithCache($color) {\r\n        $color = $color.trim();\r\n        if (colorParseCache.has($color)) {\r\n            return colorParseCache.get($color);\r\n        }\r\n        if ($color.includes('calc(')) {\r\n            $color = lowerCalcExpression($color);\r\n        }\r\n        var color = parse($color);\r\n        colorParseCache.set($color, color);\r\n        return color;\r\n    }\r\n    function tryParseColor($color) {\r\n        try {\r\n            return parseColorWithCache($color);\r\n        }\r\n        catch (err) {\r\n            return null;\r\n        }\r\n    }\r\n    function getColorModifier(prop, value) {\r\n        if (unparsableColors.has(value.toLowerCase())) {\r\n            return value;\r\n        }\r\n        try {\r\n            var rgb_1 = parseColorWithCache(value);\r\n            if (prop.includes('background')) {\r\n                return function (filter) { return modifyBackgroundColor(rgb_1, filter); };\r\n            }\r\n            if (prop.includes('border') || prop.includes('outline')) {\r\n                return function (filter) { return modifyBorderColor(rgb_1, filter); };\r\n            }\r\n            return function (filter) { return modifyForegroundColor(rgb_1, filter); };\r\n        }\r\n        catch (err) {\r\n            logWarn('Color parse error', err);\r\n            return null;\r\n        }\r\n    }\r\n    var gradientRegex = /[\\-a-z]+gradient\\(([^\\(\\)]*(\\(([^\\(\\)]*(\\(.*?\\)))*[^\\(\\)]*\\))){0,15}[^\\(\\)]*\\)/g;\r\n    var imageDetailsCache = new Map();\r\n    var awaitingForImageLoading = new Map();\r\n    function shouldIgnoreImage(selectorText, selectors) {\r\n        if (!selectorText || selectors.length === 0) {\r\n            return false;\r\n        }\r\n        if (selectors.some(function (s) { return s === '*'; })) {\r\n            return true;\r\n        }\r\n        var ruleSelectors = selectorText.split(/,\\s*/g);\r\n        var _loop_1 = function (i) {\r\n            var ignoredSelector = selectors[i];\r\n            if (ruleSelectors.some(function (s) { return s === ignoredSelector; })) {\r\n                return { value: true };\r\n            }\r\n        };\r\n        for (var i = 0; i < selectors.length; i++) {\r\n            var state_1 = _loop_1(i);\r\n            if (typeof state_1 === \"object\")\r\n                return state_1.value;\r\n        }\r\n        return false;\r\n    }\r\n    function getBgImageModifier(value, rule, ignoreImageSelectors, isCancelled) {\r\n        var _this = this;\r\n        try {\r\n            var gradients = getMatches(gradientRegex, value);\r\n            var urls = getMatches(cssURLRegex, value);\r\n            if (urls.length === 0 && gradients.length === 0) {\r\n                return value;\r\n            }\r\n            var getIndices = function (matches) {\r\n                var index = 0;\r\n                return matches.map(function (match) {\r\n                    var valueIndex = value.indexOf(match, index);\r\n                    index = valueIndex + match.length;\r\n                    return { match: match, index: valueIndex };\r\n                });\r\n            };\r\n            var matches_1 = getIndices(urls).map(function (i) { return (__assign({ type: 'url' }, i)); })\r\n                .concat(getIndices(gradients).map(function (i) { return (__assign({ type: 'gradient' }, i)); }))\r\n                .sort(function (a, b) { return a.index - b.index; });\r\n            var getGradientModifier_1 = function (gradient) {\r\n                var match = gradient.match(/^(.*-gradient)\\((.*)\\)$/);\r\n                var type = match[1];\r\n                var content = match[2];\r\n                var partsRegex = /([^\\(\\),]+(\\([^\\(\\)]*(\\([^\\(\\)]*\\)*[^\\(\\)]*)?\\))?[^\\(\\),]*),?/g;\r\n                var colorStopRegex = /^(from|color-stop|to)\\(([^\\(\\)]*?,\\s*)?(.*?)\\)$/;\r\n                var parts = getMatches(partsRegex, content, 1).map(function (part) {\r\n                    part = part.trim();\r\n                    var rgb = tryParseColor(part);\r\n                    if (rgb) {\r\n                        return function (filter) { return modifyGradientColor(rgb, filter); };\r\n                    }\r\n                    var space = part.lastIndexOf(' ');\r\n                    rgb = tryParseColor(part.substring(0, space));\r\n                    if (rgb) {\r\n                        return function (filter) { return modifyGradientColor(rgb, filter) + \" \" + part.substring(space + 1); };\r\n                    }\r\n                    var colorStopMatch = part.match(colorStopRegex);\r\n                    if (colorStopMatch) {\r\n                        rgb = tryParseColor(colorStopMatch[3]);\r\n                        if (rgb) {\r\n                            return function (filter) { return colorStopMatch[1] + \"(\" + (colorStopMatch[2] ? colorStopMatch[2] + \", \" : '') + modifyGradientColor(rgb, filter) + \")\"; };\r\n                        }\r\n                    }\r\n                    return function () { return part; };\r\n                });\r\n                return function (filter) {\r\n                    return type + \"(\" + parts.map(function (modify) { return modify(filter); }).join(', ') + \")\";\r\n                };\r\n            };\r\n            var getURLModifier_1 = function (urlValue) {\r\n                var _a;\r\n                if (shouldIgnoreImage(rule.selectorText, ignoreImageSelectors)) {\r\n                    return null;\r\n                }\r\n                var url = getCSSURLValue(urlValue);\r\n                var parentStyleSheet = rule.parentStyleSheet;\r\n                var baseURL = (parentStyleSheet && parentStyleSheet.href) ?\r\n                    getCSSBaseBath(parentStyleSheet.href) :\r\n                    ((_a = parentStyleSheet.ownerNode) === null || _a === void 0 ? void 0 : _a.baseURI) || location.origin;\r\n                url = getAbsoluteURL(baseURL, url);\r\n                var absoluteValue = \"url(\\\"\" + url + \"\\\")\";\r\n                return function (filter) { return __awaiter(_this, void 0, void 0, function () {\r\n                    var imageDetails, awaiters_1, err_1, bgImageValue;\r\n                    return __generator(this, function (_a) {\r\n                        switch (_a.label) {\r\n                            case 0:\r\n                                if (!imageDetailsCache.has(url)) return [3, 1];\r\n                                imageDetails = imageDetailsCache.get(url);\r\n                                return [3, 7];\r\n                            case 1:\r\n                                _a.trys.push([1, 6, , 7]);\r\n                                if (!awaitingForImageLoading.has(url)) return [3, 3];\r\n                                awaiters_1 = awaitingForImageLoading.get(url);\r\n                                return [4, new Promise(function (resolve) { return awaiters_1.push(resolve); })];\r\n                            case 2:\r\n                                imageDetails = _a.sent();\r\n                                if (!imageDetails) {\r\n                                    return [2, null];\r\n                                }\r\n                                return [3, 5];\r\n                            case 3:\r\n                                awaitingForImageLoading.set(url, []);\r\n                                return [4, getImageDetails(url)];\r\n                            case 4:\r\n                                imageDetails = _a.sent();\r\n                                imageDetailsCache.set(url, imageDetails);\r\n                                awaitingForImageLoading.get(url).forEach(function (resolve) { return resolve(imageDetails); });\r\n                                awaitingForImageLoading.delete(url);\r\n                                _a.label = 5;\r\n                            case 5:\r\n                                if (isCancelled()) {\r\n                                    return [2, null];\r\n                                }\r\n                                return [3, 7];\r\n                            case 6:\r\n                                err_1 = _a.sent();\r\n                                logWarn(err_1);\r\n                                if (awaitingForImageLoading.has(url)) {\r\n                                    awaitingForImageLoading.get(url).forEach(function (resolve) { return resolve(null); });\r\n                                    awaitingForImageLoading.delete(url);\r\n                                }\r\n                                return [2, absoluteValue];\r\n                            case 7:\r\n                                bgImageValue = getBgImageValue_1(imageDetails, filter) || absoluteValue;\r\n                                return [2, bgImageValue];\r\n                        }\r\n                    });\r\n                }); };\r\n            };\r\n            var getBgImageValue_1 = function (imageDetails, filter) {\r\n                var isDark = imageDetails.isDark, isLight = imageDetails.isLight, isTransparent = imageDetails.isTransparent, isLarge = imageDetails.isLarge, isTooLarge = imageDetails.isTooLarge, width = imageDetails.width;\r\n                var result;\r\n                if (isTooLarge) {\r\n                    result = \"url(\\\"\" + imageDetails.src + \"\\\")\";\r\n                }\r\n                else if (isDark && isTransparent && filter.mode === 1 && !isLarge && width > 2) {\r\n                    logInfo(\"Inverting dark image \" + imageDetails.src);\r\n                    var inverted = getFilteredImageDataURL(imageDetails, __assign(__assign({}, filter), { sepia: clamp(filter.sepia + 10, 0, 100) }));\r\n                    result = \"url(\\\"\" + inverted + \"\\\")\";\r\n                }\r\n                else if (isLight && !isTransparent && filter.mode === 1) {\r\n                    if (isLarge) {\r\n                        result = 'none';\r\n                    }\r\n                    else {\r\n                        logInfo(\"Dimming light image \" + imageDetails.src);\r\n                        var dimmed = getFilteredImageDataURL(imageDetails, filter);\r\n                        result = \"url(\\\"\" + dimmed + \"\\\")\";\r\n                    }\r\n                }\r\n                else if (filter.mode === 0 && isLight && !isLarge) {\r\n                    logInfo(\"Applying filter to image \" + imageDetails.src);\r\n                    var filtered = getFilteredImageDataURL(imageDetails, __assign(__assign({}, filter), { brightness: clamp(filter.brightness - 10, 5, 200), sepia: clamp(filter.sepia + 10, 0, 100) }));\r\n                    result = \"url(\\\"\" + filtered + \"\\\")\";\r\n                }\r\n                else {\r\n                    result = null;\r\n                }\r\n                return result;\r\n            };\r\n            var modifiers_1 = [];\r\n            var index_1 = 0;\r\n            matches_1.forEach(function (_a, i) {\r\n                var match = _a.match, type = _a.type, matchStart = _a.index;\r\n                var prefixStart = index_1;\r\n                var matchEnd = matchStart + match.length;\r\n                index_1 = matchEnd;\r\n                modifiers_1.push(function () { return value.substring(prefixStart, matchStart); });\r\n                modifiers_1.push(type === 'url' ? getURLModifier_1(match) : getGradientModifier_1(match));\r\n                if (i === matches_1.length - 1) {\r\n                    modifiers_1.push(function () { return value.substring(matchEnd); });\r\n                }\r\n            });\r\n            return function (filter) {\r\n                var results = modifiers_1.filter(Boolean).map(function (modify) { return modify(filter); });\r\n                if (results.some(function (r) { return r instanceof Promise; })) {\r\n                    return Promise.all(results)\r\n                        .then(function (asyncResults) {\r\n                        return asyncResults.join('');\r\n                    });\r\n                }\r\n                return results.join('');\r\n            };\r\n        }\r\n        catch (err) {\r\n            logWarn(\"Unable to parse gradient \" + value, err);\r\n            return null;\r\n        }\r\n    }\r\n    function getShadowModifierWithInfo(value) {\r\n        try {\r\n            var index_2 = 0;\r\n            var colorMatches_1 = getMatches(/(^|\\s)(?!calc)([a-z]+\\(.+?\\)|#[0-9a-f]+|[a-z]+)(.*?(inset|outset)?($|,))/ig, value, 2);\r\n            var notParsed_1 = 0;\r\n            var modifiers_2 = colorMatches_1.map(function (match, i) {\r\n                var prefixIndex = index_2;\r\n                var matchIndex = value.indexOf(match, index_2);\r\n                var matchEnd = matchIndex + match.length;\r\n                index_2 = matchEnd;\r\n                var rgb = tryParseColor(match);\r\n                if (!rgb) {\r\n                    notParsed_1++;\r\n                    return function () { return value.substring(prefixIndex, matchEnd); };\r\n                }\r\n                return function (filter) { return \"\" + value.substring(prefixIndex, matchIndex) + modifyShadowColor(rgb, filter) + (i === colorMatches_1.length - 1 ? value.substring(matchEnd) : ''); };\r\n            });\r\n            return function (filter) {\r\n                var modified = modifiers_2.map(function (modify) { return modify(filter); }).join('');\r\n                return {\r\n                    matchesLength: colorMatches_1.length,\r\n                    unparseableMatchesLength: notParsed_1,\r\n                    result: modified,\r\n                };\r\n            };\r\n        }\r\n        catch (err) {\r\n            logWarn(\"Unable to parse shadow \" + value, err);\r\n            return null;\r\n        }\r\n    }\r\n    function getShadowModifier(value) {\r\n        var shadowModifier = getShadowModifierWithInfo(value);\r\n        if (!shadowModifier) {\r\n            return null;\r\n        }\r\n        return function (theme) { return shadowModifier(theme).result; };\r\n    }\r\n    function getVariableModifier(variablesStore, prop, value, rule, ignoredImgSelectors, isCancelled) {\r\n        return variablesStore.getModifierForVariable({\r\n            varName: prop,\r\n            sourceValue: value,\r\n            rule: rule,\r\n            ignoredImgSelectors: ignoredImgSelectors,\r\n            isCancelled: isCancelled,\r\n        });\r\n    }\r\n    function getVariableDependantModifier(variablesStore, prop, value) {\r\n        return variablesStore.getModifierForVarDependant(prop, value);\r\n    }\r\n    function cleanModificationCache() {\r\n        colorParseCache.clear();\r\n        clearColorModificationCache();\r\n        imageDetailsCache.clear();\r\n        cleanImageProcessingCache();\r\n        awaitingForImageLoading.clear();\r\n    }\n\n    var VAR_TYPE_BGCOLOR = 1 << 0;\r\n    var VAR_TYPE_TEXTCOLOR = 1 << 1;\r\n    var VAR_TYPE_BORDERCOLOR = 1 << 2;\r\n    var VAR_TYPE_BGIMG = 1 << 3;\r\n    var VariablesStore = (function () {\r\n        function VariablesStore() {\r\n            this.varTypes = new Map();\r\n            this.rulesQueue = [];\r\n            this.definedVars = new Set();\r\n            this.varRefs = new Map();\r\n            this.unknownColorVars = new Set();\r\n            this.unknownBgVars = new Set();\r\n            this.undefinedVars = new Set();\r\n            this.initialVarTypes = new Map();\r\n            this.changedTypeVars = new Set();\r\n            this.typeChangeSubscriptions = new Map();\r\n            this.unstableVarValues = new Map();\r\n        }\r\n        VariablesStore.prototype.clear = function () {\r\n            this.varTypes.clear();\r\n            this.rulesQueue.splice(0);\r\n            this.definedVars.clear();\r\n            this.varRefs.clear();\r\n            this.unknownColorVars.clear();\r\n            this.unknownBgVars.clear();\r\n            this.undefinedVars.clear();\r\n            this.initialVarTypes.clear();\r\n            this.changedTypeVars.clear();\r\n            this.typeChangeSubscriptions.clear();\r\n            this.unstableVarValues.clear();\r\n        };\r\n        VariablesStore.prototype.isVarType = function (varName, typeNum) {\r\n            return (this.varTypes.has(varName) &&\r\n                (this.varTypes.get(varName) & typeNum) > 0);\r\n        };\r\n        VariablesStore.prototype.addRulesForMatching = function (rules) {\r\n            this.rulesQueue.push(rules);\r\n        };\r\n        VariablesStore.prototype.matchVariablesAndDependants = function () {\r\n            var _this = this;\r\n            this.changedTypeVars.clear();\r\n            this.initialVarTypes = new Map(this.varTypes);\r\n            this.collectRootVariables();\r\n            this.collectVariablesAndVarDep(this.rulesQueue);\r\n            this.rulesQueue.splice(0);\r\n            this.collectRootVarDependants();\r\n            this.varRefs.forEach(function (refs, v) {\r\n                refs.forEach(function (r) {\r\n                    if (_this.varTypes.has(v)) {\r\n                        _this.resolveVariableType(r, _this.varTypes.get(v));\r\n                    }\r\n                });\r\n            });\r\n            this.unknownColorVars.forEach(function (v) {\r\n                if (_this.unknownBgVars.has(v)) {\r\n                    _this.unknownColorVars.delete(v);\r\n                    _this.unknownBgVars.delete(v);\r\n                    _this.resolveVariableType(v, VAR_TYPE_BGCOLOR);\r\n                }\r\n                else if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR)) {\r\n                    _this.unknownColorVars.delete(v);\r\n                }\r\n                else {\r\n                    _this.undefinedVars.add(v);\r\n                }\r\n            });\r\n            this.unknownBgVars.forEach(function (v) {\r\n                var hasColor = _this.findVarRef(v, function (ref) {\r\n                    return (_this.unknownColorVars.has(ref) ||\r\n                        _this.isVarType(ref, VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR));\r\n                }) != null;\r\n                if (hasColor) {\r\n                    _this.itarateVarRefs(v, function (ref) {\r\n                        _this.resolveVariableType(ref, VAR_TYPE_BGCOLOR);\r\n                    });\r\n                }\r\n                else if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_BGIMG)) {\r\n                    _this.unknownBgVars.delete(v);\r\n                }\r\n                else {\r\n                    _this.undefinedVars.add(v);\r\n                }\r\n            });\r\n            this.changedTypeVars.forEach(function (varName) {\r\n                if (_this.typeChangeSubscriptions.has(varName)) {\r\n                    _this.typeChangeSubscriptions\r\n                        .get(varName)\r\n                        .forEach(function (callback) {\r\n                        callback();\r\n                    });\r\n                }\r\n            });\r\n            this.changedTypeVars.clear();\r\n        };\r\n        VariablesStore.prototype.getModifierForVariable = function (options) {\r\n            var _this = this;\r\n            return function (theme) {\r\n                var varName = options.varName, sourceValue = options.sourceValue, rule = options.rule, ignoredImgSelectors = options.ignoredImgSelectors, isCancelled = options.isCancelled;\r\n                var getDeclarations = function () {\r\n                    var declarations = [];\r\n                    var addModifiedValue = function (typeNum, varNameWrapper, colorModifier) {\r\n                        if (!_this.isVarType(varName, typeNum)) {\r\n                            return;\r\n                        }\r\n                        var property = varNameWrapper(varName);\r\n                        var modifiedValue;\r\n                        if (isVarDependant(sourceValue)) {\r\n                            if (isConstructedColorVar(sourceValue)) {\r\n                                var value = insertVarValues(sourceValue, _this.unstableVarValues);\r\n                                if (!value) {\r\n                                    value = typeNum === VAR_TYPE_BGCOLOR ? '#ffffff' : '#000000';\r\n                                }\r\n                                modifiedValue = colorModifier(value, theme);\r\n                            }\r\n                            else {\r\n                                modifiedValue = replaceCSSVariablesNames(sourceValue, function (v) { return varNameWrapper(v); }, function (fallback) { return colorModifier(fallback, theme); });\r\n                            }\r\n                        }\r\n                        else {\r\n                            modifiedValue = colorModifier(sourceValue, theme);\r\n                        }\r\n                        declarations.push({\r\n                            property: property,\r\n                            value: modifiedValue,\r\n                        });\r\n                    };\r\n                    addModifiedValue(VAR_TYPE_BGCOLOR, wrapBgColorVariableName, tryModifyBgColor);\r\n                    addModifiedValue(VAR_TYPE_TEXTCOLOR, wrapTextColorVariableName, tryModifyTextColor);\r\n                    addModifiedValue(VAR_TYPE_BORDERCOLOR, wrapBorderColorVariableName, tryModifyBorderColor);\r\n                    if (_this.isVarType(varName, VAR_TYPE_BGIMG)) {\r\n                        var property = wrapBgImgVariableName(varName);\r\n                        var modifiedValue = sourceValue;\r\n                        if (isVarDependant(sourceValue)) {\r\n                            modifiedValue = replaceCSSVariablesNames(sourceValue, function (v) { return wrapBgColorVariableName(v); }, function (fallback) { return tryModifyBgColor(fallback, theme); });\r\n                        }\r\n                        var bgModifier = getBgImageModifier(modifiedValue, rule, ignoredImgSelectors, isCancelled);\r\n                        modifiedValue = typeof bgModifier === 'function' ? bgModifier(theme) : bgModifier;\r\n                        declarations.push({\r\n                            property: property,\r\n                            value: modifiedValue,\r\n                        });\r\n                    }\r\n                    return declarations;\r\n                };\r\n                var callbacks = new Set();\r\n                var addListener = function (onTypeChange) {\r\n                    var callback = function () {\r\n                        var decs = getDeclarations();\r\n                        onTypeChange(decs);\r\n                    };\r\n                    callbacks.add(callback);\r\n                    _this.subscribeForVarTypeChange(varName, callback);\r\n                };\r\n                var removeListeners = function () {\r\n                    callbacks.forEach(function (callback) {\r\n                        _this.unsubscribeFromVariableTypeChanges(varName, callback);\r\n                    });\r\n                };\r\n                return {\r\n                    declarations: getDeclarations(),\r\n                    onTypeChange: { addListener: addListener, removeListeners: removeListeners },\r\n                };\r\n            };\r\n        };\r\n        VariablesStore.prototype.getModifierForVarDependant = function (property, sourceValue) {\r\n            var _this = this;\r\n            if (sourceValue.match(/^\\s*(rgb|hsl)a?\\(/)) {\r\n                var isBg_1 = property.startsWith('background');\r\n                var isText_1 = (property === 'color' || property === 'caret-color');\r\n                return function (theme) {\r\n                    var value = insertVarValues(sourceValue, _this.unstableVarValues);\r\n                    if (!value) {\r\n                        value = isBg_1 ? '#ffffff' : '#000000';\r\n                    }\r\n                    var modifier = isBg_1 ? tryModifyBgColor : isText_1 ? tryModifyTextColor : tryModifyBorderColor;\r\n                    return modifier(value, theme);\r\n                };\r\n            }\r\n            if (property === 'background-color') {\r\n                return function (theme) {\r\n                    return replaceCSSVariablesNames(sourceValue, function (v) { return wrapBgColorVariableName(v); }, function (fallback) { return tryModifyBgColor(fallback, theme); });\r\n                };\r\n            }\r\n            if (property === 'color' || property === 'caret-color') {\r\n                return function (theme) {\r\n                    return replaceCSSVariablesNames(sourceValue, function (v) { return wrapTextColorVariableName(v); }, function (fallback) { return tryModifyTextColor(fallback, theme); });\r\n                };\r\n            }\r\n            if (property === 'background' || property === 'background-image' || property === 'box-shadow') {\r\n                return function (theme) {\r\n                    var unknownVars = new Set();\r\n                    var modify = function () {\r\n                        var variableReplaced = replaceCSSVariablesNames(sourceValue, function (v) {\r\n                            if (_this.isVarType(v, VAR_TYPE_BGCOLOR)) {\r\n                                return wrapBgColorVariableName(v);\r\n                            }\r\n                            if (_this.isVarType(v, VAR_TYPE_BGIMG)) {\r\n                                return wrapBgImgVariableName(v);\r\n                            }\r\n                            unknownVars.add(v);\r\n                            return v;\r\n                        }, function (fallback) { return tryModifyBgColor(fallback, theme); });\r\n                        if (property === 'box-shadow') {\r\n                            var shadowModifier = getShadowModifierWithInfo(variableReplaced);\r\n                            var modifiedShadow = shadowModifier(theme);\r\n                            if (modifiedShadow.unparseableMatchesLength !== modifiedShadow.matchesLength) {\r\n                                return modifiedShadow.result;\r\n                            }\r\n                        }\r\n                        return variableReplaced;\r\n                    };\r\n                    var modified = modify();\r\n                    if (unknownVars.size > 0) {\r\n                        return new Promise(function (resolve) {\r\n                            var firstUnknownVar = unknownVars.values().next().value;\r\n                            var callback = function () {\r\n                                _this.unsubscribeFromVariableTypeChanges(firstUnknownVar, callback);\r\n                                var newValue = modify();\r\n                                resolve(newValue);\r\n                            };\r\n                            _this.subscribeForVarTypeChange(firstUnknownVar, callback);\r\n                        });\r\n                    }\r\n                    return modified;\r\n                };\r\n            }\r\n            if (property.startsWith('border') || property.startsWith('outline')) {\r\n                return function (theme) {\r\n                    return replaceCSSVariablesNames(sourceValue, function (v) { return wrapBorderColorVariableName(v); }, function (fallback) { return tryModifyBorderColor(fallback, theme); });\r\n                };\r\n            }\r\n            return null;\r\n        };\r\n        VariablesStore.prototype.subscribeForVarTypeChange = function (varName, callback) {\r\n            if (!this.typeChangeSubscriptions.has(varName)) {\r\n                this.typeChangeSubscriptions.set(varName, new Set());\r\n            }\r\n            var rootStore = this.typeChangeSubscriptions.get(varName);\r\n            if (!rootStore.has(callback)) {\r\n                rootStore.add(callback);\r\n            }\r\n        };\r\n        VariablesStore.prototype.unsubscribeFromVariableTypeChanges = function (varName, callback) {\r\n            if (this.typeChangeSubscriptions.has(varName)) {\r\n                this.typeChangeSubscriptions.get(varName).delete(callback);\r\n            }\r\n        };\r\n        VariablesStore.prototype.collectVariablesAndVarDep = function (ruleList) {\r\n            var _this = this;\r\n            ruleList.forEach(function (rules) {\r\n                iterateCSSRules(rules, function (rule) {\r\n                    rule.style && iterateCSSDeclarations(rule.style, function (property, value) {\r\n                        if (isVariable(property)) {\r\n                            _this.inspectVariable(property, value);\r\n                        }\r\n                        if (isVarDependant(value)) {\r\n                            _this.inspectVarDependant(property, value);\r\n                        }\r\n                    });\r\n                });\r\n            });\r\n        };\r\n        VariablesStore.prototype.collectRootVariables = function () {\r\n            var _this = this;\r\n            iterateCSSDeclarations(document.documentElement.style, function (property, value) {\r\n                if (isVariable(property)) {\r\n                    _this.inspectVariable(property, value);\r\n                }\r\n            });\r\n        };\r\n        VariablesStore.prototype.inspectVariable = function (varName, value) {\r\n            this.unstableVarValues.set(varName, value);\r\n            if (isVarDependant(value) && isConstructedColorVar(value)) {\r\n                this.unknownColorVars.add(varName);\r\n                this.definedVars.add(varName);\r\n            }\r\n            if (this.definedVars.has(varName)) {\r\n                return;\r\n            }\r\n            this.definedVars.add(varName);\r\n            var color = tryParseColor(value);\r\n            if (color) {\r\n                this.unknownColorVars.add(varName);\r\n            }\r\n            else if (value.includes('url(') ||\r\n                value.includes('linear-gradient(') ||\r\n                value.includes('radial-gradient(')) {\r\n                this.resolveVariableType(varName, VAR_TYPE_BGIMG);\r\n            }\r\n        };\r\n        VariablesStore.prototype.resolveVariableType = function (varName, typeNum) {\r\n            var initialType = this.initialVarTypes.get(varName) || 0;\r\n            var currentType = this.varTypes.get(varName) || 0;\r\n            var newType = currentType | typeNum;\r\n            this.varTypes.set(varName, newType);\r\n            if (newType !== initialType || this.undefinedVars.has(varName)) {\r\n                this.changedTypeVars.add(varName);\r\n                this.undefinedVars.delete(varName);\r\n            }\r\n            this.unknownColorVars.delete(varName);\r\n            this.unknownBgVars.delete(varName);\r\n        };\r\n        VariablesStore.prototype.collectRootVarDependants = function () {\r\n            var _this = this;\r\n            iterateCSSDeclarations(document.documentElement.style, function (property, value) {\r\n                if (isVarDependant(value)) {\r\n                    _this.inspectVarDependant(property, value);\r\n                }\r\n            });\r\n        };\r\n        VariablesStore.prototype.inspectVarDependant = function (property, value) {\r\n            var _this = this;\r\n            if (isVariable(property)) {\r\n                this.iterateVarDeps(value, function (ref) {\r\n                    if (!_this.varRefs.has(property)) {\r\n                        _this.varRefs.set(property, new Set());\r\n                    }\r\n                    _this.varRefs.get(property).add(ref);\r\n                });\r\n            }\r\n            else if (property === 'background-color' || property === 'box-shadow') {\r\n                this.iterateVarDeps(value, function (v) { return _this.resolveVariableType(v, VAR_TYPE_BGCOLOR); });\r\n            }\r\n            else if (property === 'color' || property === 'caret-color') {\r\n                this.iterateVarDeps(value, function (v) { return _this.resolveVariableType(v, VAR_TYPE_TEXTCOLOR); });\r\n            }\r\n            else if (property.startsWith('border') || property.startsWith('outline')) {\r\n                this.iterateVarDeps(value, function (v) { return _this.resolveVariableType(v, VAR_TYPE_BORDERCOLOR); });\r\n            }\r\n            else if (property === 'background' || property === 'background-image') {\r\n                this.iterateVarDeps(value, function (v) {\r\n                    if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_BGIMG)) {\r\n                        return;\r\n                    }\r\n                    var isBgColor = _this.findVarRef(v, function (ref) {\r\n                        return (_this.unknownColorVars.has(ref) ||\r\n                            _this.isVarType(ref, VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR));\r\n                    }) != null;\r\n                    _this.itarateVarRefs(v, function (ref) {\r\n                        if (isBgColor) {\r\n                            _this.resolveVariableType(ref, VAR_TYPE_BGCOLOR);\r\n                        }\r\n                        else {\r\n                            _this.unknownBgVars.add(ref);\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        };\r\n        VariablesStore.prototype.iterateVarDeps = function (value, iterator) {\r\n            var varDeps = new Set();\r\n            iterateVarDependencies(value, function (v) { return varDeps.add(v); });\r\n            varDeps.forEach(function (v) { return iterator(v); });\r\n        };\r\n        VariablesStore.prototype.findVarRef = function (varName, iterator, stack) {\r\n            var e_1, _a;\r\n            if (stack === void 0) { stack = new Set(); }\r\n            if (stack.has(varName)) {\r\n                return null;\r\n            }\r\n            stack.add(varName);\r\n            var result = iterator(varName);\r\n            if (result) {\r\n                return varName;\r\n            }\r\n            var refs = this.varRefs.get(varName);\r\n            if (!refs || refs.size === 0) {\r\n                return null;\r\n            }\r\n            try {\r\n                for (var refs_1 = __values(refs), refs_1_1 = refs_1.next(); !refs_1_1.done; refs_1_1 = refs_1.next()) {\r\n                    var ref = refs_1_1.value;\r\n                    var found = this.findVarRef(ref, iterator, stack);\r\n                    if (found) {\r\n                        return found;\r\n                    }\r\n                }\r\n            }\r\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n            finally {\r\n                try {\r\n                    if (refs_1_1 && !refs_1_1.done && (_a = refs_1.return)) _a.call(refs_1);\r\n                }\r\n                finally { if (e_1) throw e_1.error; }\r\n            }\r\n            return null;\r\n        };\r\n        VariablesStore.prototype.itarateVarRefs = function (varName, iterator) {\r\n            this.findVarRef(varName, function (ref) {\r\n                iterator(ref);\r\n                return false;\r\n            });\r\n        };\r\n        VariablesStore.prototype.setOnRootVariableChange = function (callback) {\r\n            this.onRootVariableDefined = callback;\r\n        };\r\n        VariablesStore.prototype.putRootVars = function (styleElement, theme) {\r\n            var e_2, _a;\r\n            var _this = this;\r\n            var sheet = styleElement.sheet;\r\n            if (sheet.cssRules.length > 0) {\r\n                sheet.deleteRule(0);\r\n            }\r\n            var declarations = new Map();\r\n            iterateCSSDeclarations(document.documentElement.style, function (property, value) {\r\n                if (isVariable(property)) {\r\n                    if (_this.isVarType(property, VAR_TYPE_BGCOLOR)) {\r\n                        declarations.set(wrapBgColorVariableName(property), tryModifyBgColor(value, theme));\r\n                    }\r\n                    if (_this.isVarType(property, VAR_TYPE_TEXTCOLOR)) {\r\n                        declarations.set(wrapTextColorVariableName(property), tryModifyTextColor(value, theme));\r\n                    }\r\n                    if (_this.isVarType(property, VAR_TYPE_BORDERCOLOR)) {\r\n                        declarations.set(wrapBorderColorVariableName(property), tryModifyBorderColor(value, theme));\r\n                    }\r\n                    _this.subscribeForVarTypeChange(property, _this.onRootVariableDefined);\r\n                }\r\n            });\r\n            var cssLines = [];\r\n            cssLines.push(':root {');\r\n            try {\r\n                for (var declarations_1 = __values(declarations), declarations_1_1 = declarations_1.next(); !declarations_1_1.done; declarations_1_1 = declarations_1.next()) {\r\n                    var _b = __read(declarations_1_1.value, 2), property = _b[0], value = _b[1];\r\n                    cssLines.push(\"    \" + property + \": \" + value + \";\");\r\n                }\r\n            }\r\n            catch (e_2_1) { e_2 = { error: e_2_1 }; }\r\n            finally {\r\n                try {\r\n                    if (declarations_1_1 && !declarations_1_1.done && (_a = declarations_1.return)) _a.call(declarations_1);\r\n                }\r\n                finally { if (e_2) throw e_2.error; }\r\n            }\r\n            cssLines.push('}');\r\n            var cssText = cssLines.join('\\n');\r\n            sheet.insertRule(cssText);\r\n        };\r\n        return VariablesStore;\r\n    }());\r\n    var variablesStore = new VariablesStore();\r\n    function getVariableRange(input, searchStart) {\r\n        if (searchStart === void 0) { searchStart = 0; }\r\n        var start = input.indexOf('var(', searchStart);\r\n        if (start >= 0) {\r\n            var range = getParenthesesRange(input, start + 3);\r\n            if (range) {\r\n                return { start: start, end: range.end };\r\n            }\r\n            return null;\r\n        }\r\n    }\r\n    function getVariablesMatches(input) {\r\n        var ranges = [];\r\n        var i = 0;\r\n        var range;\r\n        while ((range = getVariableRange(input, i))) {\r\n            var start = range.start, end = range.end;\r\n            ranges.push({ start: start, end: end, value: input.substring(start, end) });\r\n            i = range.end + 1;\r\n        }\r\n        return ranges;\r\n    }\r\n    function replaceVariablesMatches(input, replacer) {\r\n        var matches = getVariablesMatches(input);\r\n        var matchesCount = matches.length;\r\n        if (matchesCount === 0) {\r\n            return input;\r\n        }\r\n        var inputLength = input.length;\r\n        var replacements = matches.map(function (m) { return replacer(m.value); });\r\n        var parts = [];\r\n        parts.push(input.substring(0, matches[0].start));\r\n        for (var i = 0; i < matchesCount; i++) {\r\n            parts.push(replacements[i]);\r\n            var start = matches[i].end;\r\n            var end = i < matchesCount - 1 ? matches[i + 1].start : inputLength;\r\n            parts.push(input.substring(start, end));\r\n        }\r\n        return parts.join('');\r\n    }\r\n    function getVariableNameAndFallback(match) {\r\n        var commaIndex = match.indexOf(',');\r\n        var name;\r\n        var fallback;\r\n        if (commaIndex >= 0) {\r\n            name = match.substring(4, commaIndex).trim();\r\n            fallback = match.substring(commaIndex + 1, match.length - 1).trim();\r\n        }\r\n        else {\r\n            name = match.substring(4, match.length - 1).trim();\r\n            fallback = '';\r\n        }\r\n        return { name: name, fallback: fallback };\r\n    }\r\n    function replaceCSSVariablesNames(value, nameReplacer, fallbackReplacer) {\r\n        var matchReplacer = function (match) {\r\n            var _a = getVariableNameAndFallback(match), name = _a.name, fallback = _a.fallback;\r\n            var newName = nameReplacer(name);\r\n            if (!fallback) {\r\n                return \"var(\" + newName + \")\";\r\n            }\r\n            var newFallback;\r\n            if (isVarDependant(fallback)) {\r\n                newFallback = replaceCSSVariablesNames(fallback, nameReplacer, fallbackReplacer);\r\n            }\r\n            else if (fallbackReplacer) {\r\n                newFallback = fallbackReplacer(fallback);\r\n            }\r\n            else {\r\n                newFallback = fallback;\r\n            }\r\n            return \"var(\" + newName + \", \" + newFallback + \")\";\r\n        };\r\n        return replaceVariablesMatches(value, matchReplacer);\r\n    }\r\n    function iterateVarDependencies(value, iterator) {\r\n        replaceCSSVariablesNames(value, function (varName) {\r\n            iterator(varName);\r\n            return varName;\r\n        });\r\n    }\r\n    function wrapBgColorVariableName(name) {\r\n        return \"--darkreader-bg\" + name;\r\n    }\r\n    function wrapTextColorVariableName(name) {\r\n        return \"--darkreader-text\" + name;\r\n    }\r\n    function wrapBorderColorVariableName(name) {\r\n        return \"--darkreader-border\" + name;\r\n    }\r\n    function wrapBgImgVariableName(name) {\r\n        return \"--darkreader-bgimg\" + name;\r\n    }\r\n    function isVariable(property) {\r\n        return property.startsWith('--');\r\n    }\r\n    function isVarDependant(value) {\r\n        return value.includes('var(');\r\n    }\r\n    function isConstructedColorVar(value) {\r\n        return value.match(/^\\s*(rgb|hsl)a?\\(/);\r\n    }\r\n    var rawValueRegex = /^\\d{1,3}, ?\\d{1,3}, ?\\d{1,3}$/;\r\n    function parseRawValue(color) {\r\n        if (rawValueRegex.test(color)) {\r\n            var splitted = color.split(',');\r\n            var resultInRGB_1 = 'rgb(';\r\n            splitted.forEach(function (number) {\r\n                resultInRGB_1 += number.trim() + \", \";\r\n            });\r\n            resultInRGB_1 = resultInRGB_1.substr(0, resultInRGB_1.length - 2);\r\n            resultInRGB_1 += ')';\r\n            return { isRaw: true, color: resultInRGB_1 };\r\n        }\r\n        return { isRaw: false, color: color };\r\n    }\r\n    function handleRawValue(color, theme, modifyFunction) {\r\n        var _a = parseRawValue(color), isRaw = _a.isRaw, newColor = _a.color;\r\n        var rgb = tryParseColor(newColor);\r\n        if (rgb) {\r\n            var outputColor = modifyFunction(rgb, theme);\r\n            if (isRaw) {\r\n                var outputInRGB = tryParseColor(outputColor);\r\n                return outputInRGB ? outputInRGB.r + \", \" + outputInRGB.g + \", \" + outputInRGB.b : outputColor;\r\n            }\r\n            return outputColor;\r\n        }\r\n        return newColor;\r\n    }\r\n    function tryModifyBgColor(color, theme) {\r\n        return handleRawValue(color, theme, modifyBackgroundColor);\r\n    }\r\n    function tryModifyTextColor(color, theme) {\r\n        return handleRawValue(color, theme, modifyForegroundColor);\r\n    }\r\n    function tryModifyBorderColor(color, theme) {\r\n        return handleRawValue(color, theme, modifyBorderColor);\r\n    }\r\n    function insertVarValues(source, varValues, stack) {\r\n        if (stack === void 0) { stack = new Set(); }\r\n        var containsUnresolvedVar = false;\r\n        var matchReplacer = function (match) {\r\n            var _a = getVariableNameAndFallback(match), name = _a.name, fallback = _a.fallback;\r\n            if (stack.has(name)) {\r\n                containsUnresolvedVar = true;\r\n                return null;\r\n            }\r\n            stack.add(name);\r\n            var varValue = varValues.get(name) || fallback;\r\n            var inserted = null;\r\n            if (varValue) {\r\n                if (isVarDependant(varValue)) {\r\n                    inserted = insertVarValues(varValue, varValues, stack);\r\n                }\r\n                else {\r\n                    inserted = varValue;\r\n                }\r\n            }\r\n            if (!inserted) {\r\n                containsUnresolvedVar = true;\r\n                return null;\r\n            }\r\n            return inserted;\r\n        };\r\n        var replaced = replaceVariablesMatches(source, matchReplacer);\r\n        if (containsUnresolvedVar) {\r\n            return null;\r\n        }\r\n        return replaced;\r\n    }\n\n    var overrides = {\r\n        'background-color': {\r\n            customProp: '--darkreader-inline-bgcolor',\r\n            cssProp: 'background-color',\r\n            dataAttr: 'data-darkreader-inline-bgcolor',\r\n        },\r\n        'background-image': {\r\n            customProp: '--darkreader-inline-bgimage',\r\n            cssProp: 'background-image',\r\n            dataAttr: 'data-darkreader-inline-bgimage',\r\n        },\r\n        'border-color': {\r\n            customProp: '--darkreader-inline-border',\r\n            cssProp: 'border-color',\r\n            dataAttr: 'data-darkreader-inline-border',\r\n        },\r\n        'border-bottom-color': {\r\n            customProp: '--darkreader-inline-border-bottom',\r\n            cssProp: 'border-bottom-color',\r\n            dataAttr: 'data-darkreader-inline-border-bottom',\r\n        },\r\n        'border-left-color': {\r\n            customProp: '--darkreader-inline-border-left',\r\n            cssProp: 'border-left-color',\r\n            dataAttr: 'data-darkreader-inline-border-left',\r\n        },\r\n        'border-right-color': {\r\n            customProp: '--darkreader-inline-border-right',\r\n            cssProp: 'border-right-color',\r\n            dataAttr: 'data-darkreader-inline-border-right',\r\n        },\r\n        'border-top-color': {\r\n            customProp: '--darkreader-inline-border-top',\r\n            cssProp: 'border-top-color',\r\n            dataAttr: 'data-darkreader-inline-border-top',\r\n        },\r\n        'box-shadow': {\r\n            customProp: '--darkreader-inline-boxshadow',\r\n            cssProp: 'box-shadow',\r\n            dataAttr: 'data-darkreader-inline-boxshadow',\r\n        },\r\n        'color': {\r\n            customProp: '--darkreader-inline-color',\r\n            cssProp: 'color',\r\n            dataAttr: 'data-darkreader-inline-color',\r\n        },\r\n        'fill': {\r\n            customProp: '--darkreader-inline-fill',\r\n            cssProp: 'fill',\r\n            dataAttr: 'data-darkreader-inline-fill',\r\n        },\r\n        'stroke': {\r\n            customProp: '--darkreader-inline-stroke',\r\n            cssProp: 'stroke',\r\n            dataAttr: 'data-darkreader-inline-stroke',\r\n        },\r\n        'outline-color': {\r\n            customProp: '--darkreader-inline-outline',\r\n            cssProp: 'outline-color',\r\n            dataAttr: 'data-darkreader-inline-outline',\r\n        },\r\n        'stop-color': {\r\n            customProp: '--darkreader-inline-stopcolor',\r\n            cssProp: 'stop-color',\r\n            dataAttr: 'data-darkreader-inline-stopcolor',\r\n        },\r\n    };\r\n    var overridesList = Object.values(overrides);\r\n    var normalizedPropList = {};\r\n    overridesList.forEach(function (_a) {\r\n        var cssProp = _a.cssProp, customProp = _a.customProp;\r\n        return normalizedPropList[customProp] = cssProp;\r\n    });\r\n    var INLINE_STYLE_ATTRS = ['style', 'fill', 'stop-color', 'stroke', 'bgcolor', 'color'];\r\n    var INLINE_STYLE_SELECTOR = INLINE_STYLE_ATTRS.map(function (attr) { return \"[\" + attr + \"]\"; }).join(', ');\r\n    function getInlineOverrideStyle() {\r\n        return overridesList.map(function (_a) {\r\n            var dataAttr = _a.dataAttr, customProp = _a.customProp, cssProp = _a.cssProp;\r\n            return [\r\n                \"[\" + dataAttr + \"] {\",\r\n                \"  \" + cssProp + \": var(\" + customProp + \") !important;\",\r\n                '}',\r\n            ].join('\\n');\r\n        }).join('\\n');\r\n    }\r\n    function getInlineStyleElements(root) {\r\n        var results = [];\r\n        if (root instanceof Element && root.matches(INLINE_STYLE_SELECTOR)) {\r\n            results.push(root);\r\n        }\r\n        if (root instanceof Element || (isShadowDomSupported && root instanceof ShadowRoot) || root instanceof Document) {\r\n            push(results, root.querySelectorAll(INLINE_STYLE_SELECTOR));\r\n        }\r\n        return results;\r\n    }\r\n    var treeObservers = new Map();\r\n    var attrObservers = new Map();\r\n    function watchForInlineStyles(elementStyleDidChange, shadowRootDiscovered) {\r\n        deepWatchForInlineStyles(document, elementStyleDidChange, shadowRootDiscovered);\r\n        iterateShadowHosts(document.documentElement, function (host) {\r\n            deepWatchForInlineStyles(host.shadowRoot, elementStyleDidChange, shadowRootDiscovered);\r\n        });\r\n    }\r\n    function deepWatchForInlineStyles(root, elementStyleDidChange, shadowRootDiscovered) {\r\n        if (treeObservers.has(root)) {\r\n            treeObservers.get(root).disconnect();\r\n            attrObservers.get(root).disconnect();\r\n        }\r\n        var discoveredNodes = new WeakSet();\r\n        function discoverNodes(node) {\r\n            getInlineStyleElements(node).forEach(function (el) {\r\n                if (discoveredNodes.has(el)) {\r\n                    return;\r\n                }\r\n                discoveredNodes.add(el);\r\n                elementStyleDidChange(el);\r\n            });\r\n            iterateShadowHosts(node, function (n) {\r\n                if (discoveredNodes.has(node)) {\r\n                    return;\r\n                }\r\n                discoveredNodes.add(node);\r\n                shadowRootDiscovered(n.shadowRoot);\r\n                deepWatchForInlineStyles(n.shadowRoot, elementStyleDidChange, shadowRootDiscovered);\r\n            });\r\n        }\r\n        var treeObserver = createOptimizedTreeObserver(root, {\r\n            onMinorMutations: function (_a) {\r\n                var additions = _a.additions;\r\n                additions.forEach(function (added) { return discoverNodes(added); });\r\n            },\r\n            onHugeMutations: function () {\r\n                discoverNodes(root);\r\n            },\r\n        });\r\n        treeObservers.set(root, treeObserver);\r\n        var attemptCount = 0;\r\n        var start = null;\r\n        var ATTEMPTS_INTERVAL = getDuration({ seconds: 10 });\r\n        var RETRY_TIMEOUT = getDuration({ seconds: 2 });\r\n        var MAX_ATTEMPTS_COUNT = 50;\r\n        var cache = [];\r\n        var timeoutId = null;\r\n        var handleAttributeMutations = throttle(function (mutations) {\r\n            mutations.forEach(function (m) {\r\n                if (INLINE_STYLE_ATTRS.includes(m.attributeName)) {\r\n                    elementStyleDidChange(m.target);\r\n                }\r\n            });\r\n        });\r\n        var attrObserver = new MutationObserver(function (mutations) {\r\n            if (timeoutId) {\r\n                cache.push.apply(cache, __spreadArray([], __read(mutations), false));\r\n                return;\r\n            }\r\n            attemptCount++;\r\n            var now = Date.now();\r\n            if (start == null) {\r\n                start = now;\r\n            }\r\n            else if (attemptCount >= MAX_ATTEMPTS_COUNT) {\r\n                if (now - start < ATTEMPTS_INTERVAL) {\r\n                    timeoutId = setTimeout(function () {\r\n                        start = null;\r\n                        attemptCount = 0;\r\n                        timeoutId = null;\r\n                        var attributeCache = cache;\r\n                        cache = [];\r\n                        handleAttributeMutations(attributeCache);\r\n                    }, RETRY_TIMEOUT);\r\n                    cache.push.apply(cache, __spreadArray([], __read(mutations), false));\r\n                    return;\r\n                }\r\n                start = now;\r\n                attemptCount = 1;\r\n            }\r\n            handleAttributeMutations(mutations);\r\n        });\r\n        attrObserver.observe(root, {\r\n            attributes: true,\r\n            attributeFilter: INLINE_STYLE_ATTRS.concat(overridesList.map(function (_a) {\r\n                var dataAttr = _a.dataAttr;\r\n                return dataAttr;\r\n            })),\r\n            subtree: true,\r\n        });\r\n        attrObservers.set(root, attrObserver);\r\n    }\r\n    function stopWatchingForInlineStyles() {\r\n        treeObservers.forEach(function (o) { return o.disconnect(); });\r\n        attrObservers.forEach(function (o) { return o.disconnect(); });\r\n        treeObservers.clear();\r\n        attrObservers.clear();\r\n    }\r\n    var inlineStyleCache = new WeakMap();\r\n    var filterProps = ['brightness', 'contrast', 'grayscale', 'sepia', 'mode'];\r\n    function getInlineStyleCacheKey(el, theme) {\r\n        return INLINE_STYLE_ATTRS\r\n            .map(function (attr) { return attr + \"=\\\"\" + el.getAttribute(attr) + \"\\\"\"; })\r\n            .concat(filterProps.map(function (prop) { return prop + \"=\\\"\" + theme[prop] + \"\\\"\"; }))\r\n            .join(' ');\r\n    }\r\n    function shouldIgnoreInlineStyle(element, selectors) {\r\n        for (var i = 0, len = selectors.length; i < len; i++) {\r\n            var ingnoredSelector = selectors[i];\r\n            if (element.matches(ingnoredSelector)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    function overrideInlineStyle(element, theme, ignoreInlineSelectors, ignoreImageSelectors) {\r\n        var cacheKey = getInlineStyleCacheKey(element, theme);\r\n        if (cacheKey === inlineStyleCache.get(element)) {\r\n            return;\r\n        }\r\n        var unsetProps = new Set(Object.keys(overrides));\r\n        function setCustomProp(targetCSSProp, modifierCSSProp, cssVal) {\r\n            var _a = overrides[targetCSSProp], customProp = _a.customProp, dataAttr = _a.dataAttr;\r\n            var mod = getModifiableCSSDeclaration(modifierCSSProp, cssVal, {}, variablesStore, ignoreImageSelectors, null);\r\n            if (!mod) {\r\n                return;\r\n            }\r\n            var value = mod.value;\r\n            if (typeof value === 'function') {\r\n                value = value(theme);\r\n            }\r\n            element.style.setProperty(customProp, value);\r\n            if (!element.hasAttribute(dataAttr)) {\r\n                element.setAttribute(dataAttr, '');\r\n            }\r\n            unsetProps.delete(targetCSSProp);\r\n        }\r\n        if (ignoreInlineSelectors.length > 0) {\r\n            if (shouldIgnoreInlineStyle(element, ignoreInlineSelectors)) {\r\n                unsetProps.forEach(function (cssProp) {\r\n                    element.removeAttribute(overrides[cssProp].dataAttr);\r\n                });\r\n                return;\r\n            }\r\n        }\r\n        if (element.hasAttribute('bgcolor')) {\r\n            var value = element.getAttribute('bgcolor');\r\n            if (value.match(/^[0-9a-f]{3}$/i) || value.match(/^[0-9a-f]{6}$/i)) {\r\n                value = \"#\" + value;\r\n            }\r\n            setCustomProp('background-color', 'background-color', value);\r\n        }\r\n        if (element.hasAttribute('color') && element.rel !== 'mask-icon') {\r\n            var value = element.getAttribute('color');\r\n            if (value.match(/^[0-9a-f]{3}$/i) || value.match(/^[0-9a-f]{6}$/i)) {\r\n                value = \"#\" + value;\r\n            }\r\n            setCustomProp('color', 'color', value);\r\n        }\r\n        if (element instanceof SVGElement) {\r\n            if (element.hasAttribute('fill')) {\r\n                var SMALL_SVG_LIMIT_1 = 32;\r\n                var value_1 = element.getAttribute('fill');\r\n                if (value_1 !== 'none') {\r\n                    if (!(element instanceof SVGTextElement)) {\r\n                        var handleSVGElement = function () {\r\n                            var _a = element.getBoundingClientRect(), width = _a.width, height = _a.height;\r\n                            var isBg = (width > SMALL_SVG_LIMIT_1 || height > SMALL_SVG_LIMIT_1);\r\n                            setCustomProp('fill', isBg ? 'background-color' : 'color', value_1);\r\n                        };\r\n                        if (isReadyStateComplete()) {\r\n                            handleSVGElement();\r\n                        }\r\n                        else {\r\n                            addReadyStateCompleteListener(handleSVGElement);\r\n                        }\r\n                    }\r\n                    else {\r\n                        setCustomProp('fill', 'color', value_1);\r\n                    }\r\n                }\r\n            }\r\n            if (element.hasAttribute('stop-color')) {\r\n                setCustomProp('stop-color', 'background-color', element.getAttribute('stop-color'));\r\n            }\r\n        }\r\n        if (element.hasAttribute('stroke')) {\r\n            var value = element.getAttribute('stroke');\r\n            setCustomProp('stroke', element instanceof SVGLineElement || element instanceof SVGTextElement ? 'border-color' : 'color', value);\r\n        }\r\n        element.style && iterateCSSDeclarations(element.style, function (property, value) {\r\n            if (property === 'background-image' && value.includes('url')) {\r\n                return;\r\n            }\r\n            if (overrides.hasOwnProperty(property)) {\r\n                setCustomProp(property, property, value);\r\n            }\r\n            else {\r\n                var overridenProp = normalizedPropList[property];\r\n                if (overridenProp &&\r\n                    (!element.style.getPropertyValue(overridenProp) && !element.hasAttribute(overridenProp))) {\r\n                    if (overridenProp === 'background-color' && element.hasAttribute('bgcolor')) {\r\n                        return;\r\n                    }\r\n                    element.style.setProperty(property, '');\r\n                }\r\n            }\r\n        });\r\n        if (element.style && element instanceof SVGTextElement && element.style.fill) {\r\n            setCustomProp('fill', 'color', element.style.getPropertyValue('fill'));\r\n        }\r\n        forEach(unsetProps, function (cssProp) {\r\n            element.removeAttribute(overrides[cssProp].dataAttr);\r\n        });\r\n        inlineStyleCache.set(element, getInlineStyleCacheKey(element, theme));\r\n    }\n\n    var metaThemeColorName = 'theme-color';\r\n    var metaThemeColorSelector = \"meta[name=\\\"\" + metaThemeColorName + \"\\\"]\";\r\n    var srcMetaThemeColor = null;\r\n    var observer = null;\r\n    function changeMetaThemeColor(meta, theme) {\r\n        srcMetaThemeColor = srcMetaThemeColor || meta.content;\r\n        try {\r\n            var color = parse(srcMetaThemeColor);\r\n            meta.content = modifyBackgroundColor(color, theme);\r\n        }\r\n        catch (err) {\r\n            logWarn(err);\r\n        }\r\n    }\r\n    function changeMetaThemeColorWhenAvailable(theme) {\r\n        var meta = document.querySelector(metaThemeColorSelector);\r\n        if (meta) {\r\n            changeMetaThemeColor(meta, theme);\r\n        }\r\n        else {\r\n            if (observer) {\r\n                observer.disconnect();\r\n            }\r\n            observer = new MutationObserver(function (mutations) {\r\n                loop: for (var i = 0; i < mutations.length; i++) {\r\n                    var addedNodes = mutations[i].addedNodes;\r\n                    for (var j = 0; j < addedNodes.length; j++) {\r\n                        var node = addedNodes[j];\r\n                        if (node instanceof HTMLMetaElement && node.name === metaThemeColorName) {\r\n                            observer.disconnect();\r\n                            observer = null;\r\n                            changeMetaThemeColor(node, theme);\r\n                            break loop;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            observer.observe(document.head, { childList: true });\r\n        }\r\n    }\r\n    function restoreMetaThemeColor() {\r\n        if (observer) {\r\n            observer.disconnect();\r\n            observer = null;\r\n        }\r\n        var meta = document.querySelector(metaThemeColorSelector);\r\n        if (meta && srcMetaThemeColor) {\r\n            meta.content = srcMetaThemeColor;\r\n        }\r\n    }\n\n    var themeCacheKeys = [\r\n        'mode',\r\n        'brightness',\r\n        'contrast',\r\n        'grayscale',\r\n        'sepia',\r\n        'darkSchemeBackgroundColor',\r\n        'darkSchemeTextColor',\r\n        'lightSchemeBackgroundColor',\r\n        'lightSchemeTextColor',\r\n    ];\r\n    function getThemeKey(theme) {\r\n        return themeCacheKeys.map(function (p) { return p + \":\" + theme[p]; }).join(';');\r\n    }\r\n    var asyncQueue = createAsyncTasksQueue();\r\n    function createStyleSheetModifier() {\r\n        var renderId = 0;\r\n        var rulesTextCache = new Set();\r\n        var rulesModCache = new Map();\r\n        var varTypeChangeCleaners = new Set();\r\n        var prevFilterKey = null;\r\n        var hasNonLoadedLink = false;\r\n        var wasRebuilt = false;\r\n        function shouldRebuildStyle() {\r\n            return hasNonLoadedLink && !wasRebuilt;\r\n        }\r\n        function modifySheet(options) {\r\n            var rules = options.sourceCSSRules;\r\n            var theme = options.theme, ignoreImageAnalysis = options.ignoreImageAnalysis, force = options.force, prepareSheet = options.prepareSheet, isAsyncCancelled = options.isAsyncCancelled;\r\n            var rulesChanged = (rulesModCache.size === 0);\r\n            var notFoundCacheKeys = new Set(rulesModCache.keys());\r\n            var themeKey = getThemeKey(theme);\r\n            var themeChanged = (themeKey !== prevFilterKey);\r\n            if (hasNonLoadedLink) {\r\n                wasRebuilt = true;\r\n            }\r\n            var modRules = [];\r\n            iterateCSSRules(rules, function (rule) {\r\n                var cssText = rule.cssText;\r\n                var textDiffersFromPrev = false;\r\n                notFoundCacheKeys.delete(cssText);\r\n                if (rule.parentRule instanceof CSSMediaRule) {\r\n                    cssText += \";\" + rule.parentRule.media.mediaText;\r\n                }\r\n                if (!rulesTextCache.has(cssText)) {\r\n                    rulesTextCache.add(cssText);\r\n                    textDiffersFromPrev = true;\r\n                }\r\n                if (textDiffersFromPrev) {\r\n                    rulesChanged = true;\r\n                }\r\n                else {\r\n                    modRules.push(rulesModCache.get(cssText));\r\n                    return;\r\n                }\r\n                var modDecs = [];\r\n                rule.style && iterateCSSDeclarations(rule.style, function (property, value) {\r\n                    var mod = getModifiableCSSDeclaration(property, value, rule, variablesStore, ignoreImageAnalysis, isAsyncCancelled);\r\n                    if (mod) {\r\n                        modDecs.push(mod);\r\n                    }\r\n                });\r\n                var modRule = null;\r\n                if (modDecs.length > 0) {\r\n                    var parentRule = rule.parentRule;\r\n                    modRule = { selector: rule.selectorText, declarations: modDecs, parentRule: parentRule };\r\n                    modRules.push(modRule);\r\n                }\r\n                rulesModCache.set(cssText, modRule);\r\n            }, function () {\r\n                hasNonLoadedLink = true;\r\n            });\r\n            notFoundCacheKeys.forEach(function (key) {\r\n                rulesTextCache.delete(key);\r\n                rulesModCache.delete(key);\r\n            });\r\n            prevFilterKey = themeKey;\r\n            if (!force && !rulesChanged && !themeChanged) {\r\n                return;\r\n            }\r\n            renderId++;\r\n            function setRule(target, index, rule) {\r\n                var selector = rule.selector, declarations = rule.declarations;\r\n                var getDeclarationText = function (dec) {\r\n                    var property = dec.property, value = dec.value, important = dec.important, sourceValue = dec.sourceValue;\r\n                    return property + \": \" + (value == null ? sourceValue : value) + (important ? ' !important' : '') + \";\";\r\n                };\r\n                var cssRulesText = '';\r\n                declarations.forEach(function (declarations) {\r\n                    cssRulesText += getDeclarationText(declarations) + \" \";\r\n                });\r\n                var ruleText = selector + \" { \" + cssRulesText + \" }\";\r\n                target.insertRule(ruleText, index);\r\n            }\r\n            var asyncDeclarations = new Map();\r\n            var varDeclarations = new Map();\r\n            var asyncDeclarationCounter = 0;\r\n            var varDeclarationCounter = 0;\r\n            var rootReadyGroup = { rule: null, rules: [], isGroup: true };\r\n            var groupRefs = new WeakMap();\r\n            function getGroup(rule) {\r\n                if (rule == null) {\r\n                    return rootReadyGroup;\r\n                }\r\n                if (groupRefs.has(rule)) {\r\n                    return groupRefs.get(rule);\r\n                }\r\n                var group = { rule: rule, rules: [], isGroup: true };\r\n                groupRefs.set(rule, group);\r\n                var parentGroup = getGroup(rule.parentRule);\r\n                parentGroup.rules.push(group);\r\n                return group;\r\n            }\r\n            varTypeChangeCleaners.forEach(function (clear) { return clear(); });\r\n            varTypeChangeCleaners.clear();\r\n            modRules.filter(function (r) { return r; }).forEach(function (_a) {\r\n                var selector = _a.selector, declarations = _a.declarations, parentRule = _a.parentRule;\r\n                var group = getGroup(parentRule);\r\n                var readyStyleRule = { selector: selector, declarations: [], isGroup: false };\r\n                var readyDeclarations = readyStyleRule.declarations;\r\n                group.rules.push(readyStyleRule);\r\n                function handleAsyncDeclaration(property, modified, important, sourceValue) {\r\n                    var asyncKey = ++asyncDeclarationCounter;\r\n                    var asyncDeclaration = { property: property, value: null, important: important, asyncKey: asyncKey, sourceValue: sourceValue };\r\n                    readyDeclarations.push(asyncDeclaration);\r\n                    var currentRenderId = renderId;\r\n                    modified.then(function (asyncValue) {\r\n                        if (!asyncValue || isAsyncCancelled() || currentRenderId !== renderId) {\r\n                            return;\r\n                        }\r\n                        asyncDeclaration.value = asyncValue;\r\n                        asyncQueue.add(function () {\r\n                            if (isAsyncCancelled() || currentRenderId !== renderId) {\r\n                                return;\r\n                            }\r\n                            rebuildAsyncRule(asyncKey);\r\n                        });\r\n                    });\r\n                }\r\n                function handleVarDeclarations(property, modified, important, sourceValue) {\r\n                    var _a = modified, varDecs = _a.declarations, onTypeChange = _a.onTypeChange;\r\n                    var varKey = ++varDeclarationCounter;\r\n                    var currentRenderId = renderId;\r\n                    var initialIndex = readyDeclarations.length;\r\n                    var oldDecs = [];\r\n                    if (varDecs.length === 0) {\r\n                        var tempDec = { property: property, value: sourceValue, important: important, sourceValue: sourceValue, varKey: varKey };\r\n                        readyDeclarations.push(tempDec);\r\n                        oldDecs = [tempDec];\r\n                    }\r\n                    varDecs.forEach(function (mod) {\r\n                        if (mod.value instanceof Promise) {\r\n                            handleAsyncDeclaration(mod.property, mod.value, important, sourceValue);\r\n                        }\r\n                        else {\r\n                            var readyDec = { property: mod.property, value: mod.value, important: important, sourceValue: sourceValue, varKey: varKey };\r\n                            readyDeclarations.push(readyDec);\r\n                            oldDecs.push(readyDec);\r\n                        }\r\n                    });\r\n                    onTypeChange.addListener(function (newDecs) {\r\n                        if (isAsyncCancelled() || currentRenderId !== renderId) {\r\n                            return;\r\n                        }\r\n                        var readyVarDecs = newDecs.map(function (mod) {\r\n                            return { property: mod.property, value: mod.value, important: important, sourceValue: sourceValue, varKey: varKey };\r\n                        });\r\n                        var index = readyDeclarations.indexOf(oldDecs[0], initialIndex);\r\n                        readyDeclarations.splice.apply(readyDeclarations, __spreadArray([index, oldDecs.length], __read(readyVarDecs), false));\r\n                        oldDecs = readyVarDecs;\r\n                        rebuildVarRule(varKey);\r\n                    });\r\n                    varTypeChangeCleaners.add(function () { return onTypeChange.removeListeners(); });\r\n                }\r\n                declarations.forEach(function (_a) {\r\n                    var property = _a.property, value = _a.value, important = _a.important, sourceValue = _a.sourceValue;\r\n                    if (typeof value === 'function') {\r\n                        var modified = value(theme);\r\n                        if (modified instanceof Promise) {\r\n                            handleAsyncDeclaration(property, modified, important, sourceValue);\r\n                        }\r\n                        else if (property.startsWith('--')) {\r\n                            handleVarDeclarations(property, modified, important, sourceValue);\r\n                        }\r\n                        else {\r\n                            readyDeclarations.push({ property: property, value: modified, important: important, sourceValue: sourceValue });\r\n                        }\r\n                    }\r\n                    else {\r\n                        readyDeclarations.push({ property: property, value: value, important: important, sourceValue: sourceValue });\r\n                    }\r\n                });\r\n            });\r\n            var sheet = prepareSheet();\r\n            function buildStyleSheet() {\r\n                function createTarget(group, parent) {\r\n                    var rule = group.rule;\r\n                    if (rule instanceof CSSMediaRule) {\r\n                        var media = rule.media;\r\n                        var index = parent.cssRules.length;\r\n                        parent.insertRule(\"@media \" + media.mediaText + \" {}\", index);\r\n                        return parent.cssRules[index];\r\n                    }\r\n                    return parent;\r\n                }\r\n                function iterateReadyRules(group, target, styleIterator) {\r\n                    group.rules.forEach(function (r) {\r\n                        if (r.isGroup) {\r\n                            var t = createTarget(r, target);\r\n                            iterateReadyRules(r, t, styleIterator);\r\n                        }\r\n                        else {\r\n                            styleIterator(r, target);\r\n                        }\r\n                    });\r\n                }\r\n                iterateReadyRules(rootReadyGroup, sheet, function (rule, target) {\r\n                    var index = target.cssRules.length;\r\n                    rule.declarations.forEach(function (_a) {\r\n                        var asyncKey = _a.asyncKey, varKey = _a.varKey;\r\n                        if (asyncKey != null) {\r\n                            asyncDeclarations.set(asyncKey, { rule: rule, target: target, index: index });\r\n                        }\r\n                        if (varKey != null) {\r\n                            varDeclarations.set(varKey, { rule: rule, target: target, index: index });\r\n                        }\r\n                    });\r\n                    setRule(target, index, rule);\r\n                });\r\n            }\r\n            function rebuildAsyncRule(key) {\r\n                var _a = asyncDeclarations.get(key), rule = _a.rule, target = _a.target, index = _a.index;\r\n                target.deleteRule(index);\r\n                setRule(target, index, rule);\r\n                asyncDeclarations.delete(key);\r\n            }\r\n            function rebuildVarRule(key) {\r\n                var _a = varDeclarations.get(key), rule = _a.rule, target = _a.target, index = _a.index;\r\n                target.deleteRule(index);\r\n                setRule(target, index, rule);\r\n            }\r\n            buildStyleSheet();\r\n        }\r\n        return { modifySheet: modifySheet, shouldRebuildStyle: shouldRebuildStyle };\r\n    }\n\n    var STYLE_SELECTOR = 'style, link[rel*=\"stylesheet\" i]:not([disabled])';\r\n    function shouldManageStyle(element) {\r\n        return ((element instanceof HTMLStyleElement ||\r\n            element instanceof SVGStyleElement ||\r\n            (element instanceof HTMLLinkElement &&\r\n                element.rel &&\r\n                element.rel.toLowerCase().includes('stylesheet') &&\r\n                !element.disabled &&\r\n                (isFirefox ? !element.href.startsWith('moz-extension://') : true))) &&\r\n            !element.classList.contains('darkreader') &&\r\n            element.media.toLowerCase() !== 'print' &&\r\n            !element.classList.contains('stylus'));\r\n    }\r\n    function getManageableStyles(node, results, deep) {\r\n        if (results === void 0) { results = []; }\r\n        if (deep === void 0) { deep = true; }\r\n        if (shouldManageStyle(node)) {\r\n            results.push(node);\r\n        }\r\n        else if (node instanceof Element || (isShadowDomSupported && node instanceof ShadowRoot) || node === document) {\r\n            forEach(node.querySelectorAll(STYLE_SELECTOR), function (style) { return getManageableStyles(style, results, false); });\r\n            if (deep) {\r\n                iterateShadowHosts(node, function (host) { return getManageableStyles(host.shadowRoot, results, false); });\r\n            }\r\n        }\r\n        return results;\r\n    }\r\n    var syncStyleSet = new WeakSet();\r\n    var corsStyleSet = new WeakSet();\r\n    var canOptimizeUsingProxy$1 = false;\r\n    if (typeof document !== 'undefined') {\r\n        document.addEventListener('__darkreader__inlineScriptsAllowed', function () {\r\n            canOptimizeUsingProxy$1 = true;\r\n        });\r\n    }\r\n    var loadingLinkCounter = 0;\r\n    var rejectorsForLoadingLinks = new Map();\r\n    function cleanLoadingLinks() {\r\n        rejectorsForLoadingLinks.clear();\r\n    }\r\n    function manageStyle(element, _a) {\r\n        var update = _a.update, loadingStart = _a.loadingStart, loadingEnd = _a.loadingEnd;\r\n        var prevStyles = [];\r\n        var next = element;\r\n        while ((next = next.nextElementSibling) && next.matches('.darkreader')) {\r\n            prevStyles.push(next);\r\n        }\r\n        var corsCopy = prevStyles.find(function (el) { return el.matches('.darkreader--cors') && !corsStyleSet.has(el); }) || null;\r\n        var syncStyle = prevStyles.find(function (el) { return el.matches('.darkreader--sync') && !syncStyleSet.has(el); }) || null;\r\n        var corsCopyPositionWatcher = null;\r\n        var syncStylePositionWatcher = null;\r\n        var cancelAsyncOperations = false;\r\n        var isOverrideEmpty = true;\r\n        var sheetModifier = createStyleSheetModifier();\r\n        var observer = new MutationObserver(function () {\r\n            update();\r\n        });\r\n        var observerOptions = { attributes: true, childList: true, subtree: true, characterData: true };\r\n        function containsCSSImport() {\r\n            return element instanceof HTMLStyleElement && element.textContent.trim().match(cssImportRegex);\r\n        }\r\n        function hasImports(cssRules, checkCrossOrigin) {\r\n            var result = false;\r\n            if (cssRules) {\r\n                var rule = void 0;\r\n                cssRulesLoop: for (var i = 0, len = cssRules.length; i < len; i++) {\r\n                    rule = cssRules[i];\r\n                    if (rule.href) {\r\n                        if (checkCrossOrigin) {\r\n                            if (rule.href.startsWith('http') && !rule.href.startsWith(location.origin)) {\r\n                                result = true;\r\n                                break cssRulesLoop;\r\n                            }\r\n                        }\r\n                        else {\r\n                            result = true;\r\n                            break cssRulesLoop;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n        function getRulesSync() {\r\n            if (corsCopy) {\r\n                logInfo('[getRulesSync] Using cors-copy.');\r\n                return corsCopy.sheet.cssRules;\r\n            }\r\n            if (containsCSSImport()) {\r\n                logInfo('[getRulesSync] CSSImport detected.');\r\n                return null;\r\n            }\r\n            var cssRules = safeGetSheetRules();\r\n            if (element instanceof HTMLLinkElement && !isRelativeHrefOnAbsolutePath(element.href) && hasImports(cssRules, false)) {\r\n                logInfo('[getRulesSync] CSSImportRule detected on non-local href.');\r\n                return null;\r\n            }\r\n            if (hasImports(cssRules, true)) {\r\n                logInfo('[getRulesSync] Cross-Origin CSSImportRule detected.');\r\n                return null;\r\n            }\r\n            logInfo('[getRulesSync] Using cssRules.');\r\n            !cssRules && logWarn('[getRulesSync] cssRules is null, trying again.');\r\n            return cssRules;\r\n        }\r\n        function insertStyle() {\r\n            if (corsCopy) {\r\n                if (element.nextSibling !== corsCopy) {\r\n                    element.parentNode.insertBefore(corsCopy, element.nextSibling);\r\n                }\r\n                if (corsCopy.nextSibling !== syncStyle) {\r\n                    element.parentNode.insertBefore(syncStyle, corsCopy.nextSibling);\r\n                }\r\n            }\r\n            else if (element.nextSibling !== syncStyle) {\r\n                element.parentNode.insertBefore(syncStyle, element.nextSibling);\r\n            }\r\n        }\r\n        function createSyncStyle() {\r\n            syncStyle = element instanceof SVGStyleElement ? document.createElementNS('http://www.w3.org/2000/svg', 'style') : document.createElement('style');\r\n            syncStyle.classList.add('darkreader');\r\n            syncStyle.classList.add('darkreader--sync');\r\n            syncStyle.media = 'screen';\r\n            if (!isChromium && element.title) {\r\n                syncStyle.title = element.title;\r\n            }\r\n            syncStyleSet.add(syncStyle);\r\n        }\r\n        var isLoadingRules = false;\r\n        var wasLoadingError = false;\r\n        var loadingLinkId = ++loadingLinkCounter;\r\n        function getRulesAsync() {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var cssText, cssBasePath, _a, cssRules, accessError, err_1, fullCSSText, err_2;\r\n                var _b;\r\n                return __generator(this, function (_c) {\r\n                    switch (_c.label) {\r\n                        case 0:\r\n                            if (!(element instanceof HTMLLinkElement)) return [3, 7];\r\n                            _a = __read(getRulesOrError(), 2), cssRules = _a[0], accessError = _a[1];\r\n                            if (accessError) {\r\n                                logWarn(accessError);\r\n                            }\r\n                            if (!((!cssRules && !accessError && !isSafari) || (isSafari && !element.sheet) || isStillLoadingError(accessError))) return [3, 5];\r\n                            _c.label = 1;\r\n                        case 1:\r\n                            _c.trys.push([1, 3, , 4]);\r\n                            logInfo(\"Linkelement \" + loadingLinkId + \" is not loaded yet and thus will be await for\", element);\r\n                            return [4, linkLoading(element, loadingLinkId)];\r\n                        case 2:\r\n                            _c.sent();\r\n                            return [3, 4];\r\n                        case 3:\r\n                            err_1 = _c.sent();\r\n                            logWarn(err_1);\r\n                            wasLoadingError = true;\r\n                            return [3, 4];\r\n                        case 4:\r\n                            if (cancelAsyncOperations) {\r\n                                return [2, null];\r\n                            }\r\n                            _b = __read(getRulesOrError(), 2), cssRules = _b[0], accessError = _b[1];\r\n                            if (accessError) {\r\n                                logWarn(accessError);\r\n                            }\r\n                            _c.label = 5;\r\n                        case 5:\r\n                            if (cssRules) {\r\n                                if (!hasImports(cssRules, false)) {\r\n                                    return [2, cssRules];\r\n                                }\r\n                            }\r\n                            return [4, loadText(element.href)];\r\n                        case 6:\r\n                            cssText = _c.sent();\r\n                            cssBasePath = getCSSBaseBath(element.href);\r\n                            if (cancelAsyncOperations) {\r\n                                return [2, null];\r\n                            }\r\n                            return [3, 8];\r\n                        case 7:\r\n                            if (containsCSSImport()) {\r\n                                cssText = element.textContent.trim();\r\n                                cssBasePath = getCSSBaseBath(location.href);\r\n                            }\r\n                            else {\r\n                                return [2, null];\r\n                            }\r\n                            _c.label = 8;\r\n                        case 8:\r\n                            if (!cssText) return [3, 13];\r\n                            _c.label = 9;\r\n                        case 9:\r\n                            _c.trys.push([9, 11, , 12]);\r\n                            return [4, replaceCSSImports(cssText, cssBasePath)];\r\n                        case 10:\r\n                            fullCSSText = _c.sent();\r\n                            corsCopy = createCORSCopy(element, fullCSSText);\r\n                            return [3, 12];\r\n                        case 11:\r\n                            err_2 = _c.sent();\r\n                            logWarn(err_2);\r\n                            return [3, 12];\r\n                        case 12:\r\n                            if (corsCopy) {\r\n                                corsCopyPositionWatcher = watchForNodePosition(corsCopy, 'prev-sibling');\r\n                                return [2, corsCopy.sheet.cssRules];\r\n                            }\r\n                            _c.label = 13;\r\n                        case 13: return [2, null];\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        function details(options) {\r\n            var rules = getRulesSync();\r\n            if (!rules) {\r\n                if (options.secondRound) {\r\n                    logWarn('Detected dead-lock at details(), returning early to prevent it.');\r\n                    return null;\r\n                }\r\n                if (isLoadingRules || wasLoadingError) {\r\n                    return null;\r\n                }\r\n                isLoadingRules = true;\r\n                loadingStart();\r\n                getRulesAsync()\r\n                    .then(function (results) {\r\n                    isLoadingRules = false;\r\n                    loadingEnd();\r\n                    if (results) {\r\n                        update();\r\n                    }\r\n                })\r\n                    .catch(function (err) {\r\n                    logWarn(err);\r\n                    isLoadingRules = false;\r\n                    loadingEnd();\r\n                });\r\n                return null;\r\n            }\r\n            return { rules: rules };\r\n        }\r\n        var forceRenderStyle = false;\r\n        function render(theme, ignoreImageAnalysis) {\r\n            var rules = getRulesSync();\r\n            if (!rules) {\r\n                return;\r\n            }\r\n            cancelAsyncOperations = false;\r\n            function removeCSSRulesFromSheet(sheet) {\r\n                try {\r\n                    if (sheet.replaceSync) {\r\n                        sheet.replaceSync('');\r\n                        return;\r\n                    }\r\n                }\r\n                catch (err) {\r\n                    logWarn('Could not use fastpath for removing rules from stylesheet', err);\r\n                }\r\n                for (var i = sheet.cssRules.length - 1; i >= 0; i--) {\r\n                    sheet.deleteRule(i);\r\n                }\r\n            }\r\n            function prepareOverridesSheet() {\r\n                if (!syncStyle) {\r\n                    createSyncStyle();\r\n                }\r\n                syncStylePositionWatcher && syncStylePositionWatcher.stop();\r\n                insertStyle();\r\n                if (syncStyle.sheet == null) {\r\n                    syncStyle.textContent = '';\r\n                }\r\n                var sheet = syncStyle.sheet;\r\n                removeCSSRulesFromSheet(sheet);\r\n                if (syncStylePositionWatcher) {\r\n                    syncStylePositionWatcher.run();\r\n                }\r\n                else {\r\n                    syncStylePositionWatcher = watchForNodePosition(syncStyle, 'prev-sibling', function () {\r\n                        forceRenderStyle = true;\r\n                        buildOverrides();\r\n                    });\r\n                }\r\n                return syncStyle.sheet;\r\n            }\r\n            function buildOverrides() {\r\n                var force = forceRenderStyle;\r\n                forceRenderStyle = false;\r\n                sheetModifier.modifySheet({\r\n                    prepareSheet: prepareOverridesSheet,\r\n                    sourceCSSRules: rules,\r\n                    theme: theme,\r\n                    ignoreImageAnalysis: ignoreImageAnalysis,\r\n                    force: force,\r\n                    isAsyncCancelled: function () { return cancelAsyncOperations; },\r\n                });\r\n                isOverrideEmpty = syncStyle.sheet.cssRules.length === 0;\r\n                if (sheetModifier.shouldRebuildStyle()) {\r\n                    addReadyStateCompleteListener(function () { return update(); });\r\n                }\r\n            }\r\n            buildOverrides();\r\n        }\r\n        function getRulesOrError() {\r\n            try {\r\n                if (element.sheet == null) {\r\n                    return [null, null];\r\n                }\r\n                return [element.sheet.cssRules, null];\r\n            }\r\n            catch (err) {\r\n                return [null, err];\r\n            }\r\n        }\r\n        function isStillLoadingError(error) {\r\n            return error && error.message && error.message.includes('loading');\r\n        }\r\n        function safeGetSheetRules() {\r\n            var _a = __read(getRulesOrError(), 2), cssRules = _a[0], err = _a[1];\r\n            if (err) {\r\n                logWarn(err);\r\n                return null;\r\n            }\r\n            return cssRules;\r\n        }\r\n        function watchForSheetChanges() {\r\n            watchForSheetChangesUsingProxy();\r\n            if (!isThunderbird && !(canOptimizeUsingProxy$1 && element.sheet)) {\r\n                watchForSheetChangesUsingRAF();\r\n            }\r\n        }\r\n        var rulesChangeKey = null;\r\n        var rulesCheckFrameId = null;\r\n        function getRulesChangeKey() {\r\n            var rules = safeGetSheetRules();\r\n            return rules ? rules.length : null;\r\n        }\r\n        function didRulesKeyChange() {\r\n            return getRulesChangeKey() !== rulesChangeKey;\r\n        }\r\n        function watchForSheetChangesUsingRAF() {\r\n            rulesChangeKey = getRulesChangeKey();\r\n            stopWatchingForSheetChangesUsingRAF();\r\n            var checkForUpdate = function () {\r\n                if (didRulesKeyChange()) {\r\n                    rulesChangeKey = getRulesChangeKey();\r\n                    update();\r\n                }\r\n                if (canOptimizeUsingProxy$1 && element.sheet) {\r\n                    stopWatchingForSheetChangesUsingRAF();\r\n                    return;\r\n                }\r\n                rulesCheckFrameId = requestAnimationFrame(checkForUpdate);\r\n            };\r\n            checkForUpdate();\r\n        }\r\n        function stopWatchingForSheetChangesUsingRAF() {\r\n            cancelAnimationFrame(rulesCheckFrameId);\r\n        }\r\n        var areSheetChangesPending = false;\r\n        function onSheetChange() {\r\n            canOptimizeUsingProxy$1 = true;\r\n            stopWatchingForSheetChangesUsingRAF();\r\n            if (areSheetChangesPending) {\r\n                return;\r\n            }\r\n            function handleSheetChanges() {\r\n                areSheetChangesPending = false;\r\n                if (cancelAsyncOperations) {\r\n                    return;\r\n                }\r\n                update();\r\n            }\r\n            areSheetChangesPending = true;\r\n            if (typeof queueMicrotask === 'function') {\r\n                queueMicrotask(handleSheetChanges);\r\n            }\r\n            else {\r\n                requestAnimationFrame(handleSheetChanges);\r\n            }\r\n        }\r\n        function watchForSheetChangesUsingProxy() {\r\n            element.addEventListener('__darkreader__updateSheet', onSheetChange);\r\n        }\r\n        function stopWatchingForSheetChangesUsingProxy() {\r\n            element.removeEventListener('__darkreader__updateSheet', onSheetChange);\r\n        }\r\n        function stopWatchingForSheetChanges() {\r\n            stopWatchingForSheetChangesUsingProxy();\r\n            stopWatchingForSheetChangesUsingRAF();\r\n        }\r\n        function pause() {\r\n            observer.disconnect();\r\n            cancelAsyncOperations = true;\r\n            corsCopyPositionWatcher && corsCopyPositionWatcher.stop();\r\n            syncStylePositionWatcher && syncStylePositionWatcher.stop();\r\n            stopWatchingForSheetChanges();\r\n        }\r\n        function destroy() {\r\n            pause();\r\n            removeNode(corsCopy);\r\n            removeNode(syncStyle);\r\n            loadingEnd();\r\n            if (rejectorsForLoadingLinks.has(loadingLinkId)) {\r\n                var reject = rejectorsForLoadingLinks.get(loadingLinkId);\r\n                rejectorsForLoadingLinks.delete(loadingLinkId);\r\n                reject && reject();\r\n            }\r\n        }\r\n        function watch() {\r\n            observer.observe(element, observerOptions);\r\n            if (element instanceof HTMLStyleElement) {\r\n                watchForSheetChanges();\r\n            }\r\n        }\r\n        var maxMoveCount = 10;\r\n        var moveCount = 0;\r\n        function restore() {\r\n            if (!syncStyle) {\r\n                return;\r\n            }\r\n            moveCount++;\r\n            if (moveCount > maxMoveCount) {\r\n                logWarn('Style sheet was moved multiple times', element);\r\n                return;\r\n            }\r\n            logWarn('Restore style', syncStyle, element);\r\n            insertStyle();\r\n            corsCopyPositionWatcher && corsCopyPositionWatcher.skip();\r\n            syncStylePositionWatcher && syncStylePositionWatcher.skip();\r\n            if (!isOverrideEmpty) {\r\n                forceRenderStyle = true;\r\n                update();\r\n            }\r\n        }\r\n        return {\r\n            details: details,\r\n            render: render,\r\n            pause: pause,\r\n            destroy: destroy,\r\n            watch: watch,\r\n            restore: restore,\r\n        };\r\n    }\r\n    function linkLoading(link, loadingId) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve, reject) {\r\n                        var cleanUp = function () {\r\n                            link.removeEventListener('load', onLoad);\r\n                            link.removeEventListener('error', onError);\r\n                            rejectorsForLoadingLinks.delete(loadingId);\r\n                        };\r\n                        var onLoad = function () {\r\n                            cleanUp();\r\n                            logInfo(\"Linkelement \" + loadingId + \" has been loaded\");\r\n                            resolve();\r\n                        };\r\n                        var onError = function () {\r\n                            cleanUp();\r\n                            reject(\"Linkelement \" + loadingId + \" couldn't be loaded. \" + link.href);\r\n                        };\r\n                        rejectorsForLoadingLinks.set(loadingId, function () {\r\n                            cleanUp();\r\n                            reject();\r\n                        });\r\n                        link.addEventListener('load', onLoad);\r\n                        link.addEventListener('error', onError);\r\n                        if (!link.href) {\r\n                            onError();\r\n                        }\r\n                    })];\r\n            });\r\n        });\r\n    }\r\n    function getCSSImportURL(importDeclaration) {\r\n        return getCSSURLValue(importDeclaration\r\n            .substring(7)\r\n            .trim()\r\n            .replace(/;$/, '')\r\n            .replace(/screen$/, ''));\r\n    }\r\n    function loadText(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!url.startsWith('data:')) return [3, 3];\r\n                        return [4, fetch(url)];\r\n                    case 1: return [4, (_a.sent()).text()];\r\n                    case 2: return [2, _a.sent()];\r\n                    case 3: return [4, bgFetch({ url: url, responseType: 'text', mimeType: 'text/css', origin: window.location.origin })];\r\n                    case 4: return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function replaceCSSImports(cssText, basePath, cache) {\r\n        if (cache === void 0) { cache = new Map(); }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var importMatches, importMatches_1, importMatches_1_1, match, importURL, absoluteURL, importedCSS, err_3, e_1_1;\r\n            var e_1, _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        cssText = removeCSSComments(cssText);\r\n                        cssText = replaceCSSFontFace(cssText);\r\n                        cssText = replaceCSSRelativeURLsWithAbsolute(cssText, basePath);\r\n                        importMatches = getMatches(cssImportRegex, cssText);\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        _b.trys.push([1, 10, 11, 12]);\r\n                        importMatches_1 = __values(importMatches), importMatches_1_1 = importMatches_1.next();\r\n                        _b.label = 2;\r\n                    case 2:\r\n                        if (!!importMatches_1_1.done) return [3, 9];\r\n                        match = importMatches_1_1.value;\r\n                        importURL = getCSSImportURL(match);\r\n                        absoluteURL = getAbsoluteURL(basePath, importURL);\r\n                        importedCSS = void 0;\r\n                        if (!cache.has(absoluteURL)) return [3, 3];\r\n                        importedCSS = cache.get(absoluteURL);\r\n                        return [3, 7];\r\n                    case 3:\r\n                        _b.trys.push([3, 6, , 7]);\r\n                        return [4, loadText(absoluteURL)];\r\n                    case 4:\r\n                        importedCSS = _b.sent();\r\n                        cache.set(absoluteURL, importedCSS);\r\n                        return [4, replaceCSSImports(importedCSS, getCSSBaseBath(absoluteURL), cache)];\r\n                    case 5:\r\n                        importedCSS = _b.sent();\r\n                        return [3, 7];\r\n                    case 6:\r\n                        err_3 = _b.sent();\r\n                        logWarn(err_3);\r\n                        importedCSS = '';\r\n                        return [3, 7];\r\n                    case 7:\r\n                        cssText = cssText.split(match).join(importedCSS);\r\n                        _b.label = 8;\r\n                    case 8:\r\n                        importMatches_1_1 = importMatches_1.next();\r\n                        return [3, 2];\r\n                    case 9: return [3, 12];\r\n                    case 10:\r\n                        e_1_1 = _b.sent();\r\n                        e_1 = { error: e_1_1 };\r\n                        return [3, 12];\r\n                    case 11:\r\n                        try {\r\n                            if (importMatches_1_1 && !importMatches_1_1.done && (_a = importMatches_1.return)) _a.call(importMatches_1);\r\n                        }\r\n                        finally { if (e_1) throw e_1.error; }\r\n                        return [7];\r\n                    case 12:\r\n                        cssText = cssText.trim();\r\n                        return [2, cssText];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function createCORSCopy(srcElement, cssText) {\r\n        if (!cssText) {\r\n            return null;\r\n        }\r\n        var cors = document.createElement('style');\r\n        cors.classList.add('darkreader');\r\n        cors.classList.add('darkreader--cors');\r\n        cors.media = 'screen';\r\n        cors.textContent = cssText;\r\n        srcElement.parentNode.insertBefore(cors, srcElement.nextSibling);\r\n        cors.sheet.disabled = true;\r\n        corsStyleSet.add(cors);\r\n        return cors;\r\n    }\n\n    var observers = [];\r\n    var observedRoots;\r\n    var undefinedGroups = new Map();\r\n    var elementsDefinitionCallback;\r\n    function collectUndefinedElements(root) {\r\n        if (!isDefinedSelectorSupported) {\r\n            return;\r\n        }\r\n        forEach(root.querySelectorAll(':not(:defined)'), function (el) {\r\n            var tag = el.tagName.toLowerCase();\r\n            if (!tag.includes('-')) {\r\n                var extendedTag = el.getAttribute('is');\r\n                if (extendedTag) {\r\n                    tag = extendedTag;\r\n                }\r\n                else {\r\n                    return;\r\n                }\r\n            }\r\n            if (!undefinedGroups.has(tag)) {\r\n                undefinedGroups.set(tag, new Set());\r\n                customElementsWhenDefined(tag).then(function () {\r\n                    if (elementsDefinitionCallback) {\r\n                        var elements = undefinedGroups.get(tag);\r\n                        undefinedGroups.delete(tag);\r\n                        elementsDefinitionCallback(Array.from(elements));\r\n                    }\r\n                });\r\n            }\r\n            undefinedGroups.get(tag).add(el);\r\n        });\r\n    }\r\n    var canOptimizeUsingProxy = false;\r\n    if (typeof document !== 'undefined') {\r\n        document.addEventListener('__darkreader__inlineScriptsAllowed', function () {\r\n            canOptimizeUsingProxy = true;\r\n        });\r\n    }\r\n    var resolvers = new Map();\r\n    function handleIsDefined(e) {\r\n        canOptimizeUsingProxy = true;\r\n        if (resolvers.has(e.detail.tag)) {\r\n            var resolve = resolvers.get(e.detail.tag);\r\n            resolve();\r\n        }\r\n    }\r\n    function customElementsWhenDefined(tag) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve) {\r\n                        if (window.customElements && typeof customElements.whenDefined === 'function') {\r\n                            customElements.whenDefined(tag).then(function () { return resolve(); });\r\n                        }\r\n                        else if (canOptimizeUsingProxy) {\r\n                            resolvers.set(tag, resolve);\r\n                            document.dispatchEvent(new CustomEvent('__darkreader__addUndefinedResolver', { detail: { tag: tag } }));\r\n                        }\r\n                        else {\r\n                            var checkIfDefined_1 = function () {\r\n                                var elements = undefinedGroups.get(tag);\r\n                                if (elements && elements.size > 0) {\r\n                                    if (elements.values().next().value.matches(':defined')) {\r\n                                        resolve();\r\n                                    }\r\n                                    else {\r\n                                        requestAnimationFrame(checkIfDefined_1);\r\n                                    }\r\n                                }\r\n                            };\r\n                            requestAnimationFrame(checkIfDefined_1);\r\n                        }\r\n                    })];\r\n            });\r\n        });\r\n    }\r\n    function watchWhenCustomElementsDefined(callback) {\r\n        elementsDefinitionCallback = callback;\r\n    }\r\n    function unsubscribeFromDefineCustomElements() {\r\n        elementsDefinitionCallback = null;\r\n        undefinedGroups.clear();\r\n        document.removeEventListener('__darkreader__isDefined', handleIsDefined);\r\n    }\r\n    function watchForStyleChanges(currentStyles, update, shadowRootDiscovered) {\r\n        stopWatchingForStyleChanges();\r\n        var prevStyles = new Set(currentStyles);\r\n        var prevStyleSiblings = new WeakMap();\r\n        var nextStyleSiblings = new WeakMap();\r\n        function saveStylePosition(style) {\r\n            prevStyleSiblings.set(style, style.previousElementSibling);\r\n            nextStyleSiblings.set(style, style.nextElementSibling);\r\n        }\r\n        function forgetStylePosition(style) {\r\n            prevStyleSiblings.delete(style);\r\n            nextStyleSiblings.delete(style);\r\n        }\r\n        function didStylePositionChange(style) {\r\n            return style.previousElementSibling !== prevStyleSiblings.get(style) || style.nextElementSibling !== nextStyleSiblings.get(style);\r\n        }\r\n        currentStyles.forEach(saveStylePosition);\r\n        function handleStyleOperations(operations) {\r\n            var createdStyles = operations.createdStyles, removedStyles = operations.removedStyles, movedStyles = operations.movedStyles;\r\n            createdStyles.forEach(function (s) { return saveStylePosition(s); });\r\n            movedStyles.forEach(function (s) { return saveStylePosition(s); });\r\n            removedStyles.forEach(function (s) { return forgetStylePosition(s); });\r\n            createdStyles.forEach(function (s) { return prevStyles.add(s); });\r\n            removedStyles.forEach(function (s) { return prevStyles.delete(s); });\r\n            if (createdStyles.size + removedStyles.size + movedStyles.size > 0) {\r\n                update({\r\n                    created: Array.from(createdStyles),\r\n                    removed: Array.from(removedStyles),\r\n                    moved: Array.from(movedStyles),\r\n                    updated: [],\r\n                });\r\n            }\r\n        }\r\n        function handleMinorTreeMutations(_a) {\r\n            var additions = _a.additions, moves = _a.moves, deletions = _a.deletions;\r\n            var createdStyles = new Set();\r\n            var removedStyles = new Set();\r\n            var movedStyles = new Set();\r\n            additions.forEach(function (node) { return getManageableStyles(node).forEach(function (style) { return createdStyles.add(style); }); });\r\n            deletions.forEach(function (node) { return getManageableStyles(node).forEach(function (style) { return removedStyles.add(style); }); });\r\n            moves.forEach(function (node) { return getManageableStyles(node).forEach(function (style) { return movedStyles.add(style); }); });\r\n            handleStyleOperations({ createdStyles: createdStyles, removedStyles: removedStyles, movedStyles: movedStyles });\r\n            additions.forEach(function (n) {\r\n                iterateShadowHosts(n, subscribeForShadowRootChanges);\r\n                collectUndefinedElements(n);\r\n            });\r\n        }\r\n        function handleHugeTreeMutations(root) {\r\n            var styles = new Set(getManageableStyles(root));\r\n            var createdStyles = new Set();\r\n            var removedStyles = new Set();\r\n            var movedStyles = new Set();\r\n            styles.forEach(function (s) {\r\n                if (!prevStyles.has(s)) {\r\n                    createdStyles.add(s);\r\n                }\r\n            });\r\n            prevStyles.forEach(function (s) {\r\n                if (!styles.has(s)) {\r\n                    removedStyles.add(s);\r\n                }\r\n            });\r\n            styles.forEach(function (s) {\r\n                if (!createdStyles.has(s) && !removedStyles.has(s) && didStylePositionChange(s)) {\r\n                    movedStyles.add(s);\r\n                }\r\n            });\r\n            handleStyleOperations({ createdStyles: createdStyles, removedStyles: removedStyles, movedStyles: movedStyles });\r\n            iterateShadowHosts(root, subscribeForShadowRootChanges);\r\n            collectUndefinedElements(root);\r\n        }\r\n        function handleAttributeMutations(mutations) {\r\n            var updatedStyles = new Set();\r\n            var removedStyles = new Set();\r\n            mutations.forEach(function (m) {\r\n                var target = m.target;\r\n                if (target.isConnected) {\r\n                    if (shouldManageStyle(target)) {\r\n                        updatedStyles.add(target);\r\n                    }\r\n                    else if (target instanceof HTMLLinkElement && target.disabled) {\r\n                        removedStyles.add(target);\r\n                    }\r\n                }\r\n            });\r\n            if (updatedStyles.size + removedStyles.size > 0) {\r\n                update({\r\n                    updated: Array.from(updatedStyles),\r\n                    created: [],\r\n                    removed: Array.from(removedStyles),\r\n                    moved: [],\r\n                });\r\n            }\r\n        }\r\n        function observe(root) {\r\n            var treeObserver = createOptimizedTreeObserver(root, {\r\n                onMinorMutations: handleMinorTreeMutations,\r\n                onHugeMutations: handleHugeTreeMutations,\r\n            });\r\n            var attrObserver = new MutationObserver(handleAttributeMutations);\r\n            attrObserver.observe(root, { attributes: true, attributeFilter: ['rel', 'disabled', 'media'], subtree: true });\r\n            observers.push(treeObserver, attrObserver);\r\n            observedRoots.add(root);\r\n        }\r\n        function subscribeForShadowRootChanges(node) {\r\n            var shadowRoot = node.shadowRoot;\r\n            if (shadowRoot == null || observedRoots.has(shadowRoot)) {\r\n                return;\r\n            }\r\n            observe(shadowRoot);\r\n            shadowRootDiscovered(shadowRoot);\r\n        }\r\n        observe(document);\r\n        iterateShadowHosts(document.documentElement, subscribeForShadowRootChanges);\r\n        watchWhenCustomElementsDefined(function (hosts) {\r\n            var newStyles = [];\r\n            hosts.forEach(function (host) { return push(newStyles, getManageableStyles(host.shadowRoot)); });\r\n            update({ created: newStyles, updated: [], removed: [], moved: [] });\r\n            hosts.forEach(function (host) {\r\n                var shadowRoot = host.shadowRoot;\r\n                if (shadowRoot == null) {\r\n                    return;\r\n                }\r\n                subscribeForShadowRootChanges(host);\r\n                iterateShadowHosts(shadowRoot, subscribeForShadowRootChanges);\r\n                collectUndefinedElements(shadowRoot);\r\n            });\r\n        });\r\n        document.addEventListener('__darkreader__isDefined', handleIsDefined);\r\n        collectUndefinedElements(document);\r\n    }\r\n    function resetObservers() {\r\n        observers.forEach(function (o) { return o.disconnect(); });\r\n        observers.splice(0, observers.length);\r\n        observedRoots = new WeakSet();\r\n    }\r\n    function stopWatchingForStyleChanges() {\r\n        resetObservers();\r\n        unsubscribeFromDefineCustomElements();\r\n    }\n\n    function hexify(number) {\r\n        return (number < 16 ? '0' : '') + number.toString(16);\r\n    }\r\n    function generateUID() {\r\n        if (typeof crypto === 'undefined')\r\n            return 'xxx-xxxx';\r\n        if ('randomUUID' in crypto) {\r\n            var uuid = crypto.randomUUID();\r\n            return uuid.substring(0, 8) + uuid.substring(9, 13) + uuid.substring(14, 18) + uuid.substring(19, 23) + uuid.substring(24);\r\n        }\r\n        return Array.from(crypto.getRandomValues(new Uint8Array(16)))\r\n            .map(function (x) { return hexify(x); })\r\n            .join('');\r\n    }\n\n    var adoptedStyleOverrides = new WeakMap();\r\n    var overrideList = new WeakSet();\r\n    function createAdoptedStyleSheetOverride(node) {\r\n        var cancelAsyncOperations = false;\r\n        function injectSheet(sheet, override) {\r\n            var newSheets = __spreadArray([], __read(node.adoptedStyleSheets), false);\r\n            var sheetIndex = newSheets.indexOf(sheet);\r\n            var existingIndex = newSheets.indexOf(override);\r\n            if (sheetIndex === existingIndex - 1) {\r\n                return;\r\n            }\r\n            if (existingIndex >= 0) {\r\n                newSheets.splice(existingIndex, 1);\r\n            }\r\n            newSheets.splice(sheetIndex + 1, 0, override);\r\n            node.adoptedStyleSheets = newSheets;\r\n        }\r\n        function destroy() {\r\n            cancelAsyncOperations = true;\r\n            var newSheets = __spreadArray([], __read(node.adoptedStyleSheets), false);\r\n            node.adoptedStyleSheets.forEach(function (adoptedStyleSheet) {\r\n                if (overrideList.has(adoptedStyleSheet)) {\r\n                    var existingIndex = newSheets.indexOf(adoptedStyleSheet);\r\n                    if (existingIndex >= 0) {\r\n                        newSheets.splice(existingIndex, 1);\r\n                    }\r\n                    adoptedStyleOverrides.delete(adoptedStyleSheet);\r\n                    overrideList.delete(adoptedStyleSheet);\r\n                }\r\n            });\r\n            node.adoptedStyleSheets = newSheets;\r\n        }\r\n        function render(theme, ignoreImageAnalysis) {\r\n            node.adoptedStyleSheets.forEach(function (sheet) {\r\n                if (overrideList.has(sheet)) {\r\n                    return;\r\n                }\r\n                var rules = sheet.rules;\r\n                var override = new CSSStyleSheet();\r\n                function prepareOverridesSheet() {\r\n                    for (var i = override.cssRules.length - 1; i >= 0; i--) {\r\n                        override.deleteRule(i);\r\n                    }\r\n                    injectSheet(sheet, override);\r\n                    adoptedStyleOverrides.set(sheet, override);\r\n                    overrideList.add(override);\r\n                    return override;\r\n                }\r\n                var sheetModifier = createStyleSheetModifier();\r\n                sheetModifier.modifySheet({\r\n                    prepareSheet: prepareOverridesSheet,\r\n                    sourceCSSRules: rules,\r\n                    theme: theme,\r\n                    ignoreImageAnalysis: ignoreImageAnalysis,\r\n                    force: false,\r\n                    isAsyncCancelled: function () { return cancelAsyncOperations; },\r\n                });\r\n            });\r\n        }\r\n        return {\r\n            render: render,\r\n            destroy: destroy\r\n        };\r\n    }\n\n    function injectProxy(enableStyleSheetsProxy) {\r\n        document.dispatchEvent(new CustomEvent('__darkreader__inlineScriptsAllowed'));\r\n        var addRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'addRule');\r\n        var insertRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'insertRule');\r\n        var deleteRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'deleteRule');\r\n        var removeRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'removeRule');\r\n        var documentStyleSheetsDescriptor = enableStyleSheetsProxy ?\r\n            Object.getOwnPropertyDescriptor(Document.prototype, 'styleSheets') : null;\r\n        var shouldWrapHTMLElement = location.hostname.endsWith('baidu.com');\r\n        var getElementsByTagNameDescriptor = shouldWrapHTMLElement ?\r\n            Object.getOwnPropertyDescriptor(Element.prototype, 'getElementsByTagName') : null;\r\n        var cleanUp = function () {\r\n            Object.defineProperty(CSSStyleSheet.prototype, 'addRule', addRuleDescriptor);\r\n            Object.defineProperty(CSSStyleSheet.prototype, 'insertRule', insertRuleDescriptor);\r\n            Object.defineProperty(CSSStyleSheet.prototype, 'deleteRule', deleteRuleDescriptor);\r\n            Object.defineProperty(CSSStyleSheet.prototype, 'removeRule', removeRuleDescriptor);\r\n            document.removeEventListener('__darkreader__cleanUp', cleanUp);\r\n            document.removeEventListener('__darkreader__addUndefinedResolver', addUndefinedResolver);\r\n            if (enableStyleSheetsProxy) {\r\n                Object.defineProperty(Document.prototype, 'styleSheets', documentStyleSheetsDescriptor);\r\n            }\r\n            if (shouldWrapHTMLElement) {\r\n                Object.defineProperty(Element.prototype, 'getElementsByTagName', getElementsByTagNameDescriptor);\r\n            }\r\n        };\r\n        var addUndefinedResolver = function (e) {\r\n            customElements.whenDefined(e.detail.tag).then(function () {\r\n                document.dispatchEvent(new CustomEvent('__darkreader__isDefined', { detail: { tag: e.detail.tag } }));\r\n            });\r\n        };\r\n        document.addEventListener('__darkreader__cleanUp', cleanUp);\r\n        document.addEventListener('__darkreader__addUndefinedResolver', addUndefinedResolver);\r\n        var updateSheetEvent = new Event('__darkreader__updateSheet');\r\n        function proxyAddRule(selector, style, index) {\r\n            addRuleDescriptor.value.call(this, selector, style, index);\r\n            if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n            return -1;\r\n        }\r\n        function proxyInsertRule(rule, index) {\r\n            var returnValue = insertRuleDescriptor.value.call(this, rule, index);\r\n            if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n            return returnValue;\r\n        }\r\n        function proxyDeleteRule(index) {\r\n            deleteRuleDescriptor.value.call(this, index);\r\n            if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n        }\r\n        function proxyRemoveRule(index) {\r\n            removeRuleDescriptor.value.call(this, index);\r\n            if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n        }\r\n        function proxyDocumentStyleSheets() {\r\n            var docSheets = documentStyleSheetsDescriptor.get.call(this);\r\n            var filtered = __spreadArray([], __read(docSheets), false).filter(function (styleSheet) {\r\n                return !styleSheet.ownerNode.classList.contains('darkreader');\r\n            });\r\n            return Object.setPrototypeOf(filtered, StyleSheetList.prototype);\r\n        }\r\n        function proxyGetElementsByTagName(tagName) {\r\n            var _this = this;\r\n            if (tagName !== 'style') {\r\n                return getElementsByTagNameDescriptor.value.call(this, tagName);\r\n            }\r\n            var getCurrentElementValue = function () {\r\n                var elements = getElementsByTagNameDescriptor.value.call(_this, tagName);\r\n                return Object.setPrototypeOf(__spreadArray([], __read(elements), false).filter(function (element) {\r\n                    return !element.classList.contains('darkreader');\r\n                }), NodeList.prototype);\r\n            };\r\n            var elements = getCurrentElementValue();\r\n            var NodeListBehavior = {\r\n                get: function (_, property) {\r\n                    return getCurrentElementValue()[Number(property)];\r\n                }\r\n            };\r\n            elements = new Proxy(elements, NodeListBehavior);\r\n            return elements;\r\n        }\r\n        Object.defineProperty(CSSStyleSheet.prototype, 'addRule', Object.assign({}, addRuleDescriptor, { value: proxyAddRule }));\r\n        Object.defineProperty(CSSStyleSheet.prototype, 'insertRule', Object.assign({}, insertRuleDescriptor, { value: proxyInsertRule }));\r\n        Object.defineProperty(CSSStyleSheet.prototype, 'deleteRule', Object.assign({}, deleteRuleDescriptor, { value: proxyDeleteRule }));\r\n        Object.defineProperty(CSSStyleSheet.prototype, 'removeRule', Object.assign({}, removeRuleDescriptor, { value: proxyRemoveRule }));\r\n        if (enableStyleSheetsProxy) {\r\n            Object.defineProperty(Document.prototype, 'styleSheets', Object.assign({}, documentStyleSheetsDescriptor, { get: proxyDocumentStyleSheets }));\r\n        }\r\n        if (shouldWrapHTMLElement) {\r\n            Object.defineProperty(Element.prototype, 'getElementsByTagName', Object.assign({}, getElementsByTagNameDescriptor, { value: proxyGetElementsByTagName }));\r\n        }\r\n    }\n\n    var INSTANCE_ID = generateUID();\r\n    var styleManagers = new Map();\r\n    var adoptedStyleManagers = [];\r\n    var filter = null;\r\n    var fixes = null;\r\n    var isIFrame$1 = null;\r\n    var ignoredImageAnalysisSelectors = null;\r\n    var ignoredInlineSelectors = null;\r\n    function createOrUpdateStyle(className, root) {\r\n        if (root === void 0) { root = document.head || document; }\r\n        var element = root.querySelector(\".\" + className);\r\n        if (!element) {\r\n            element = document.createElement('style');\r\n            element.classList.add('darkreader');\r\n            element.classList.add(className);\r\n            element.media = 'screen';\r\n            element.textContent = '';\r\n        }\r\n        return element;\r\n    }\r\n    function createOrUpdateScript(className, root) {\r\n        if (root === void 0) { root = document.head || document; }\r\n        var element = root.querySelector(\".\" + className);\r\n        if (!element) {\r\n            element = document.createElement('script');\r\n            element.classList.add('darkreader');\r\n            element.classList.add(className);\r\n        }\r\n        return element;\r\n    }\r\n    var nodePositionWatchers = new Map();\r\n    function setupNodePositionWatcher(node, alias) {\r\n        nodePositionWatchers.has(alias) && nodePositionWatchers.get(alias).stop();\r\n        nodePositionWatchers.set(alias, watchForNodePosition(node, 'parent'));\r\n    }\r\n    function stopStylePositionWatchers() {\r\n        forEach(nodePositionWatchers.values(), function (watcher) { return watcher.stop(); });\r\n        nodePositionWatchers.clear();\r\n    }\r\n    function createStaticStyleOverrides() {\r\n        var fallbackStyle = createOrUpdateStyle('darkreader--fallback', document);\r\n        fallbackStyle.textContent = getModifiedFallbackStyle(filter, { strict: true });\r\n        document.head.insertBefore(fallbackStyle, document.head.firstChild);\r\n        setupNodePositionWatcher(fallbackStyle, 'fallback');\r\n        var userAgentStyle = createOrUpdateStyle('darkreader--user-agent');\r\n        userAgentStyle.textContent = getModifiedUserAgentStyle(filter, isIFrame$1, filter.styleSystemControls);\r\n        document.head.insertBefore(userAgentStyle, fallbackStyle.nextSibling);\r\n        setupNodePositionWatcher(userAgentStyle, 'user-agent');\r\n        var textStyle = createOrUpdateStyle('darkreader--text');\r\n        if (filter.useFont || filter.textStroke > 0) {\r\n            textStyle.textContent = createTextStyle(filter);\r\n        }\r\n        else {\r\n            textStyle.textContent = '';\r\n        }\r\n        document.head.insertBefore(textStyle, fallbackStyle.nextSibling);\r\n        setupNodePositionWatcher(textStyle, 'text');\r\n        var invertStyle = createOrUpdateStyle('darkreader--invert');\r\n        if (fixes && Array.isArray(fixes.invert) && fixes.invert.length > 0) {\r\n            invertStyle.textContent = [\r\n                fixes.invert.join(', ') + \" {\",\r\n                \"    filter: \" + getCSSFilterValue(__assign(__assign({}, filter), { contrast: filter.mode === 0 ? filter.contrast : clamp(filter.contrast - 10, 0, 100) })) + \" !important;\",\r\n                '}',\r\n            ].join('\\n');\r\n        }\r\n        else {\r\n            invertStyle.textContent = '';\r\n        }\r\n        document.head.insertBefore(invertStyle, textStyle.nextSibling);\r\n        setupNodePositionWatcher(invertStyle, 'invert');\r\n        var inlineStyle = createOrUpdateStyle('darkreader--inline');\r\n        inlineStyle.textContent = getInlineOverrideStyle();\r\n        document.head.insertBefore(inlineStyle, invertStyle.nextSibling);\r\n        setupNodePositionWatcher(inlineStyle, 'inline');\r\n        var overrideStyle = createOrUpdateStyle('darkreader--override');\r\n        overrideStyle.textContent = fixes && fixes.css ? replaceCSSTemplates(fixes.css) : '';\r\n        document.head.appendChild(overrideStyle);\r\n        setupNodePositionWatcher(overrideStyle, 'override');\r\n        var variableStyle = createOrUpdateStyle('darkreader--variables');\r\n        var selectionColors = getSelectionColor(filter);\r\n        var darkSchemeBackgroundColor = filter.darkSchemeBackgroundColor, darkSchemeTextColor = filter.darkSchemeTextColor, lightSchemeBackgroundColor = filter.lightSchemeBackgroundColor, lightSchemeTextColor = filter.lightSchemeTextColor, mode = filter.mode;\r\n        var schemeBackgroundColor = mode === 0 ? lightSchemeBackgroundColor : darkSchemeBackgroundColor;\r\n        var schemeTextColor = mode === 0 ? lightSchemeTextColor : darkSchemeTextColor;\r\n        schemeBackgroundColor = modifyBackgroundColor(parse(schemeBackgroundColor), filter);\r\n        schemeTextColor = modifyForegroundColor(parse(schemeTextColor), filter);\r\n        variableStyle.textContent = [\r\n            \":root {\",\r\n            \"   --darkreader-neutral-background: \" + schemeBackgroundColor + \";\",\r\n            \"   --darkreader-neutral-text: \" + schemeTextColor + \";\",\r\n            \"   --darkreader-selection-background: \" + selectionColors.backgroundColorSelection + \";\",\r\n            \"   --darkreader-selection-text: \" + selectionColors.foregroundColorSelection + \";\",\r\n            \"}\",\r\n        ].join('\\n');\r\n        document.head.insertBefore(variableStyle, inlineStyle.nextSibling);\r\n        setupNodePositionWatcher(variableStyle, 'variables');\r\n        var rootVarsStyle = createOrUpdateStyle('darkreader--root-vars');\r\n        document.head.insertBefore(rootVarsStyle, variableStyle.nextSibling);\r\n        var proxyScript = createOrUpdateScript('darkreader--proxy');\r\n        proxyScript.append(\"(\" + injectProxy + \")(!\" + (fixes && fixes.disableStyleSheetsProxy) + \")\");\r\n        document.head.insertBefore(proxyScript, rootVarsStyle.nextSibling);\r\n        proxyScript.remove();\r\n    }\r\n    var shadowRootsWithOverrides = new Set();\r\n    function createShadowStaticStyleOverrides(root) {\r\n        var inlineStyle = createOrUpdateStyle('darkreader--inline', root);\r\n        inlineStyle.textContent = getInlineOverrideStyle();\r\n        root.insertBefore(inlineStyle, root.firstChild);\r\n        var overrideStyle = createOrUpdateStyle('darkreader--override', root);\r\n        overrideStyle.textContent = fixes && fixes.css ? replaceCSSTemplates(fixes.css) : '';\r\n        root.insertBefore(overrideStyle, inlineStyle.nextSibling);\r\n        var invertStyle = createOrUpdateStyle('darkreader--invert', root);\r\n        if (fixes && Array.isArray(fixes.invert) && fixes.invert.length > 0) {\r\n            invertStyle.textContent = [\r\n                fixes.invert.join(', ') + \" {\",\r\n                \"    filter: \" + getCSSFilterValue(__assign(__assign({}, filter), { contrast: filter.mode === 0 ? filter.contrast : clamp(filter.contrast - 10, 0, 100) })) + \" !important;\",\r\n                '}',\r\n            ].join('\\n');\r\n        }\r\n        else {\r\n            invertStyle.textContent = '';\r\n        }\r\n        root.insertBefore(invertStyle, overrideStyle.nextSibling);\r\n        shadowRootsWithOverrides.add(root);\r\n    }\r\n    function replaceCSSTemplates($cssText) {\r\n        return $cssText.replace(/\\${(.+?)}/g, function (_, $color) {\r\n            var color = tryParseColor($color);\r\n            if (color) {\r\n                return modifyColor(color, filter);\r\n            }\r\n            logWarn(\"Couldn't parse CSSTemplate's color.\");\r\n            return $color;\r\n        });\r\n    }\r\n    function cleanFallbackStyle() {\r\n        var fallback = document.querySelector('.darkreader--fallback');\r\n        if (fallback) {\r\n            fallback.textContent = '';\r\n        }\r\n    }\r\n    function createDynamicStyleOverrides() {\r\n        cancelRendering();\r\n        var allStyles = getManageableStyles(document);\r\n        var newManagers = allStyles.filter(function (style) { return !styleManagers.has(style); }).map(function (style) { return createManager(style); });\r\n        newManagers\r\n            .map(function (manager) { return manager.details({ secondRound: false }); })\r\n            .filter(function (detail) { return detail && detail.rules.length > 0; })\r\n            .forEach(function (detail) {\r\n            variablesStore.addRulesForMatching(detail.rules);\r\n        });\r\n        variablesStore.matchVariablesAndDependants();\r\n        variablesStore.setOnRootVariableChange(function () {\r\n            variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\r\n        });\r\n        variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\r\n        styleManagers.forEach(function (manager) { return manager.render(filter, ignoredImageAnalysisSelectors); });\r\n        if (loadingStyles.size === 0) {\r\n            cleanFallbackStyle();\r\n        }\r\n        newManagers.forEach(function (manager) { return manager.watch(); });\r\n        var inlineStyleElements = toArray(document.querySelectorAll(INLINE_STYLE_SELECTOR));\r\n        iterateShadowHosts(document.documentElement, function (host) {\r\n            createShadowStaticStyleOverrides(host.shadowRoot);\r\n            var elements = host.shadowRoot.querySelectorAll(INLINE_STYLE_SELECTOR);\r\n            if (elements.length > 0) {\r\n                push(inlineStyleElements, elements);\r\n            }\r\n        });\r\n        inlineStyleElements.forEach(function (el) { return overrideInlineStyle(el, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors); });\r\n        handleAdoptedStyleSheets(document);\r\n    }\r\n    var loadingStylesCounter = 0;\r\n    var loadingStyles = new Set();\r\n    function createManager(element) {\r\n        var loadingStyleId = ++loadingStylesCounter;\r\n        logInfo(\"New manager for element, with loadingStyleID \" + loadingStyleId, element);\r\n        function loadingStart() {\r\n            if (!isDOMReady() || !didDocumentShowUp) {\r\n                loadingStyles.add(loadingStyleId);\r\n                logInfo(\"Current amount of styles loading: \" + loadingStyles.size);\r\n                var fallbackStyle = document.querySelector('.darkreader--fallback');\r\n                if (!fallbackStyle.textContent) {\r\n                    fallbackStyle.textContent = getModifiedFallbackStyle(filter, { strict: false });\r\n                }\r\n            }\r\n        }\r\n        function loadingEnd() {\r\n            loadingStyles.delete(loadingStyleId);\r\n            logInfo(\"Removed loadingStyle \" + loadingStyleId + \", now awaiting: \" + loadingStyles.size);\r\n            logInfo(\"To-do to be loaded\", loadingStyles);\r\n            if (loadingStyles.size === 0 && isDOMReady()) {\r\n                cleanFallbackStyle();\r\n            }\r\n        }\r\n        function update() {\r\n            var details = manager.details({ secondRound: true });\r\n            if (!details) {\r\n                return;\r\n            }\r\n            variablesStore.addRulesForMatching(details.rules);\r\n            variablesStore.matchVariablesAndDependants();\r\n            manager.render(filter, ignoredImageAnalysisSelectors);\r\n        }\r\n        var manager = manageStyle(element, { update: update, loadingStart: loadingStart, loadingEnd: loadingEnd });\r\n        styleManagers.set(element, manager);\r\n        return manager;\r\n    }\r\n    function removeManager(element) {\r\n        var manager = styleManagers.get(element);\r\n        if (manager) {\r\n            manager.destroy();\r\n            styleManagers.delete(element);\r\n        }\r\n    }\r\n    var throttledRenderAllStyles = throttle(function (callback) {\r\n        styleManagers.forEach(function (manager) { return manager.render(filter, ignoredImageAnalysisSelectors); });\r\n        adoptedStyleManagers.forEach(function (manager) { return manager.render(filter, ignoredImageAnalysisSelectors); });\r\n        callback && callback();\r\n    });\r\n    var cancelRendering = function () {\r\n        throttledRenderAllStyles.cancel();\r\n    };\r\n    function onDOMReady() {\r\n        if (loadingStyles.size === 0) {\r\n            cleanFallbackStyle();\r\n            return;\r\n        }\r\n        logWarn(\"DOM is ready, but still have styles being loaded.\", loadingStyles);\r\n    }\r\n    var documentVisibilityListener = null;\r\n    var didDocumentShowUp = typeof document !== 'undefined' && !document.hidden;\r\n    function watchForDocumentVisibility(callback) {\r\n        var alreadyWatching = Boolean(documentVisibilityListener);\r\n        documentVisibilityListener = function () {\r\n            if (!document.hidden) {\r\n                stopWatchingForDocumentVisibility();\r\n                callback();\r\n                didDocumentShowUp = true;\r\n            }\r\n        };\r\n        if (!alreadyWatching) {\r\n            document.addEventListener('visibilitychange', documentVisibilityListener);\r\n        }\r\n    }\r\n    function stopWatchingForDocumentVisibility() {\r\n        document.removeEventListener('visibilitychange', documentVisibilityListener);\r\n        documentVisibilityListener = null;\r\n    }\r\n    function createThemeAndWatchForUpdates() {\r\n        createStaticStyleOverrides();\r\n        function runDynamicStyle() {\r\n            createDynamicStyleOverrides();\r\n            watchForUpdates();\r\n        }\r\n        if (document.hidden) {\r\n            watchForDocumentVisibility(runDynamicStyle);\r\n        }\r\n        else {\r\n            runDynamicStyle();\r\n        }\r\n        changeMetaThemeColorWhenAvailable(filter);\r\n    }\r\n    function handleAdoptedStyleSheets(node) {\r\n        if (Array.isArray(node.adoptedStyleSheets)) {\r\n            if (node.adoptedStyleSheets.length > 0) {\r\n                var newManger = createAdoptedStyleSheetOverride(node);\r\n                adoptedStyleManagers.push(newManger);\r\n                newManger.render(filter, ignoredImageAnalysisSelectors);\r\n            }\r\n        }\r\n    }\r\n    function watchForUpdates() {\r\n        var managedStyles = Array.from(styleManagers.keys());\r\n        watchForStyleChanges(managedStyles, function (_a) {\r\n            var created = _a.created, updated = _a.updated, removed = _a.removed, moved = _a.moved;\r\n            var stylesToRemove = removed;\r\n            var stylesToManage = created\r\n                .concat(updated)\r\n                .concat(moved)\r\n                .filter(function (style) { return !styleManagers.has(style); });\r\n            var stylesToRestore = moved.filter(function (style) { return styleManagers.has(style); });\r\n            logInfo(\"Styles to be removed:\", stylesToRemove);\r\n            stylesToRemove.forEach(function (style) { return removeManager(style); });\r\n            var newManagers = stylesToManage.map(function (style) { return createManager(style); });\r\n            newManagers\r\n                .map(function (manager) { return manager.details({ secondRound: false }); })\r\n                .filter(function (detail) { return detail && detail.rules.length > 0; })\r\n                .forEach(function (detail) {\r\n                variablesStore.addRulesForMatching(detail.rules);\r\n            });\r\n            variablesStore.matchVariablesAndDependants();\r\n            newManagers.forEach(function (manager) { return manager.render(filter, ignoredImageAnalysisSelectors); });\r\n            newManagers.forEach(function (manager) { return manager.watch(); });\r\n            stylesToRestore.forEach(function (style) { return styleManagers.get(style).restore(); });\r\n        }, function (shadowRoot) {\r\n            createShadowStaticStyleOverrides(shadowRoot);\r\n            handleAdoptedStyleSheets(shadowRoot);\r\n        });\r\n        watchForInlineStyles(function (element) {\r\n            overrideInlineStyle(element, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors);\r\n            if (element === document.documentElement) {\r\n                var styleAttr = element.getAttribute('style');\r\n                if (styleAttr.includes('--')) {\r\n                    variablesStore.matchVariablesAndDependants();\r\n                    variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\r\n                }\r\n            }\r\n        }, function (root) {\r\n            createShadowStaticStyleOverrides(root);\r\n            var inlineStyleElements = root.querySelectorAll(INLINE_STYLE_SELECTOR);\r\n            if (inlineStyleElements.length > 0) {\r\n                forEach(inlineStyleElements, function (el) { return overrideInlineStyle(el, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors); });\r\n            }\r\n        });\r\n        addDOMReadyListener(onDOMReady);\r\n    }\r\n    function stopWatchingForUpdates() {\r\n        styleManagers.forEach(function (manager) { return manager.pause(); });\r\n        stopStylePositionWatchers();\r\n        stopWatchingForStyleChanges();\r\n        stopWatchingForInlineStyles();\r\n        removeDOMReadyListener(onDOMReady);\r\n        cleanReadyStateCompleteListeners();\r\n    }\r\n    function createDarkReaderInstanceMarker() {\r\n        var metaElement = document.createElement('meta');\r\n        metaElement.name = 'darkreader';\r\n        metaElement.content = INSTANCE_ID;\r\n        document.head.appendChild(metaElement);\r\n    }\r\n    function isAnotherDarkReaderInstanceActive() {\r\n        var meta = document.querySelector('meta[name=\"darkreader\"]');\r\n        if (meta) {\r\n            if (meta.content !== INSTANCE_ID) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        createDarkReaderInstanceMarker();\r\n        return false;\r\n    }\r\n    function createOrUpdateDynamicTheme(filterConfig, dynamicThemeFixes, iframe) {\r\n        filter = filterConfig;\r\n        fixes = dynamicThemeFixes;\r\n        if (fixes) {\r\n            ignoredImageAnalysisSelectors = Array.isArray(fixes.ignoreImageAnalysis) ? fixes.ignoreImageAnalysis : [];\r\n            ignoredInlineSelectors = Array.isArray(fixes.ignoreInlineStyle) ? fixes.ignoreInlineStyle : [];\r\n        }\r\n        else {\r\n            ignoredImageAnalysisSelectors = [];\r\n            ignoredInlineSelectors = [];\r\n        }\r\n        isIFrame$1 = iframe;\r\n        if (document.head) {\r\n            if (isAnotherDarkReaderInstanceActive()) {\r\n                return;\r\n            }\r\n            document.documentElement.setAttribute('data-darkreader-mode', 'dynamic');\r\n            document.documentElement.setAttribute('data-darkreader-scheme', filter.mode ? 'dark' : 'dimmed');\r\n            createThemeAndWatchForUpdates();\r\n        }\r\n        else {\r\n            if (!isFirefox) {\r\n                var fallbackStyle = createOrUpdateStyle('darkreader--fallback');\r\n                document.documentElement.appendChild(fallbackStyle);\r\n                fallbackStyle.textContent = getModifiedFallbackStyle(filter, { strict: true });\r\n            }\r\n            var headObserver_1 = new MutationObserver(function () {\r\n                if (document.head) {\r\n                    headObserver_1.disconnect();\r\n                    if (isAnotherDarkReaderInstanceActive()) {\r\n                        removeDynamicTheme();\r\n                        return;\r\n                    }\r\n                    createThemeAndWatchForUpdates();\r\n                }\r\n            });\r\n            headObserver_1.observe(document, { childList: true, subtree: true });\r\n        }\r\n    }\r\n    function removeProxy() {\r\n        document.dispatchEvent(new CustomEvent('__darkreader__cleanUp'));\r\n        removeNode(document.head.querySelector('.darkreader--proxy'));\r\n    }\r\n    function removeDynamicTheme() {\r\n        document.documentElement.removeAttribute(\"data-darkreader-mode\");\r\n        document.documentElement.removeAttribute(\"data-darkreader-scheme\");\r\n        cleanDynamicThemeCache();\r\n        removeNode(document.querySelector('.darkreader--fallback'));\r\n        if (document.head) {\r\n            restoreMetaThemeColor();\r\n            removeNode(document.head.querySelector('.darkreader--user-agent'));\r\n            removeNode(document.head.querySelector('.darkreader--text'));\r\n            removeNode(document.head.querySelector('.darkreader--invert'));\r\n            removeNode(document.head.querySelector('.darkreader--inline'));\r\n            removeNode(document.head.querySelector('.darkreader--override'));\r\n            removeNode(document.head.querySelector('.darkreader--variables'));\r\n            removeNode(document.head.querySelector('.darkreader--root-vars'));\r\n            removeNode(document.head.querySelector('meta[name=\"darkreader\"]'));\r\n            removeProxy();\r\n        }\r\n        shadowRootsWithOverrides.forEach(function (root) {\r\n            removeNode(root.querySelector('.darkreader--inline'));\r\n            removeNode(root.querySelector('.darkreader--override'));\r\n        });\r\n        shadowRootsWithOverrides.clear();\r\n        forEach(styleManagers.keys(), function (el) { return removeManager(el); });\r\n        loadingStyles.clear();\r\n        cleanLoadingLinks();\r\n        forEach(document.querySelectorAll('.darkreader'), removeNode);\r\n        adoptedStyleManagers.forEach(function (manager) {\r\n            manager.destroy();\r\n        });\r\n        adoptedStyleManagers.splice(0);\r\n    }\r\n    function cleanDynamicThemeCache() {\r\n        variablesStore.clear();\r\n        parsedURLCache.clear();\r\n        stopWatchingForDocumentVisibility();\r\n        cancelRendering();\r\n        stopWatchingForUpdates();\r\n        cleanModificationCache();\r\n    }\n\n    var blobRegex = /url\\(\\\"(blob\\:.*?)\\\"\\)/g;\r\n    function replaceBlobs(text) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var promises, data;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        promises = [];\r\n                        getMatches(blobRegex, text, 1).forEach(function (url) {\r\n                            var promise = loadAsDataURL(url);\r\n                            promises.push(promise);\r\n                        });\r\n                        return [4, Promise.all(promises)];\r\n                    case 1:\r\n                        data = _a.sent();\r\n                        return [2, text.replace(blobRegex, function () { return \"url(\\\"\" + data.shift() + \"\\\")\"; })];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    var banner = \"/*\\n                        _______\\n                       /       \\\\\\n                      .==.    .==.\\n                     ((  ))==((  ))\\n                    / \\\"==\\\"    \\\"==\\\"\\\\\\n                   /____|| || ||___\\\\\\n       ________     ____    ________  ___    ___\\n       |  ___  \\\\   /    \\\\   |  ___  \\\\ |  |  /  /\\n       |  |  \\\\  \\\\ /  /\\\\  \\\\  |  |  \\\\  \\\\|  |_/  /\\n       |  |   )  /  /__\\\\  \\\\ |  |__/  /|  ___  \\\\\\n       |  |__/  /  ______  \\\\|  ____  \\\\|  |  \\\\  \\\\\\n_______|_______/__/ ____ \\\\__\\\\__|___\\\\__\\\\__|___\\\\__\\\\____\\n|  ___  \\\\ |  ____/ /    \\\\   |  ___  \\\\ |  ____|  ___  \\\\\\n|  |  \\\\  \\\\|  |___ /  /\\\\  \\\\  |  |  \\\\  \\\\|  |___|  |  \\\\  \\\\\\n|  |__/  /|  ____/  /__\\\\  \\\\ |  |   )  |  ____|  |__/  /\\n|  ____  \\\\|  |__/  ______  \\\\|  |__/  /|  |___|  ____  \\\\\\n|__|   \\\\__\\\\____/__/      \\\\__\\\\_______/ |______|__|   \\\\__\\\\\\n                https://darkreader.org\\n*/\\n\\n/*! Dark reader generated CSS | Licensed under MIT https://github.com/darkreader/darkreader/blob/master/LICENSE */\\n\";\r\n    function collectCSS() {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            function addStaticCSS(selector, comment) {\r\n                var staticStyle = document.querySelector(selector);\r\n                if (staticStyle && staticStyle.textContent) {\r\n                    css.push(\"/* \" + comment + \" */\");\r\n                    css.push(staticStyle.textContent);\r\n                    css.push('');\r\n                }\r\n            }\r\n            var css, modifiedCSS, formattedCSS, _a, _b;\r\n            return __generator(this, function (_c) {\r\n                switch (_c.label) {\r\n                    case 0:\r\n                        css = [banner];\r\n                        addStaticCSS('.darkreader--fallback', 'Fallback Style');\r\n                        addStaticCSS('.darkreader--user-agent', 'User-Agent Style');\r\n                        addStaticCSS('.darkreader--text', 'Text Style');\r\n                        addStaticCSS('.darkreader--invert', 'Invert Style');\r\n                        addStaticCSS('.darkreader--variables', 'Variables Style');\r\n                        modifiedCSS = [];\r\n                        document.querySelectorAll('.darkreader--sync').forEach(function (element) {\r\n                            forEach(element.sheet.cssRules, function (rule) {\r\n                                rule && rule.cssText && modifiedCSS.push(rule.cssText);\r\n                            });\r\n                        });\r\n                        if (!modifiedCSS.length) return [3, 2];\r\n                        formattedCSS = formatCSS(modifiedCSS.join('\\n'));\r\n                        css.push('/* Modified CSS */');\r\n                        _b = (_a = css).push;\r\n                        return [4, replaceBlobs(formattedCSS)];\r\n                    case 1:\r\n                        _b.apply(_a, [_c.sent()]);\r\n                        css.push('');\r\n                        _c.label = 2;\r\n                    case 2:\r\n                        addStaticCSS('.darkreader--override', 'Override Style');\r\n                        return [2, css.join('\\n')];\r\n                }\r\n            });\r\n        });\r\n    }\n\n    var isDarkReaderEnabled = false;\r\n    var isIFrame = (function () {\r\n        if (typeof window === 'undefined')\r\n            return false;\r\n        try {\r\n            return window.self !== window.top;\r\n        }\r\n        catch (err) {\r\n            console.warn(err);\r\n            return true;\r\n        }\r\n    })();\r\n    function enable(themeOptions, fixes) {\r\n        if (themeOptions === void 0) { themeOptions = {}; }\r\n        if (fixes === void 0) { fixes = null; }\r\n        var theme = __assign(__assign({}, DEFAULT_THEME), themeOptions);\r\n        if (theme.engine !== ThemeEngines.dynamicTheme) {\r\n            throw new Error('Theme engine is not supported.');\r\n        }\r\n        createOrUpdateDynamicTheme(theme, fixes, isIFrame);\r\n        isDarkReaderEnabled = true;\r\n    }\r\n    function isEnabled() {\r\n        return isDarkReaderEnabled;\r\n    }\r\n    function disable() {\r\n        removeDynamicTheme();\r\n        isDarkReaderEnabled = false;\r\n    }\r\n    var store = {\r\n        themeOptions: null,\r\n        fixes: null,\r\n    };\r\n    function handleColorScheme() {\r\n        var darkScheme = matchMedia('(prefers-color-scheme: dark)');\r\n        if (darkScheme.matches) {\r\n            enable(store.themeOptions, store.fixes);\r\n        }\r\n        else {\r\n            disable();\r\n        }\r\n    }\r\n    function auto(themeOptions, fixes) {\r\n        if (themeOptions === void 0) { themeOptions = {}; }\r\n        if (fixes === void 0) { fixes = null; }\r\n        var darkScheme = matchMedia('(prefers-color-scheme: dark)');\r\n        if (themeOptions) {\r\n            store = { themeOptions: themeOptions, fixes: fixes };\r\n            handleColorScheme();\r\n            if (isMatchMediaChangeEventListenerSupported) {\r\n                darkScheme.addEventListener('change', handleColorScheme);\r\n            }\r\n            else {\r\n                darkScheme.addListener(handleColorScheme);\r\n            }\r\n        }\r\n        else {\r\n            if (isMatchMediaChangeEventListenerSupported) {\r\n                darkScheme.removeEventListener('change', handleColorScheme);\r\n            }\r\n            else {\r\n                darkScheme.removeListener(handleColorScheme);\r\n            }\r\n            disable();\r\n        }\r\n    }\r\n    function exportGeneratedCSS() {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, collectCSS()];\r\n                    case 1: return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    var setFetchMethod = setFetchMethod$1;\n\n    exports.auto = auto;\n    exports.disable = disable;\n    exports.enable = enable;\n    exports.exportGeneratedCSS = exportGeneratedCSS;\n    exports.isEnabled = isEnabled;\n    exports.setFetchMethod = setFetchMethod;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n}));\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}