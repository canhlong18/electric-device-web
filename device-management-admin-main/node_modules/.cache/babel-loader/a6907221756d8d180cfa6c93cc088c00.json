{"ast":null,"code":"import \"antd/es/message/style\";\nimport _message from \"antd/es/message\";\nimport \"antd/es/popconfirm/style\";\nimport _Popconfirm from \"antd/es/popconfirm\";\nimport _regeneratorRuntime from \"@babel/runtime/helpers/esm/regeneratorRuntime\";\nimport _toArray from \"@babel/runtime/helpers/esm/toArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nvar _excluded = [\"map_row_parentKey\", \"map_row_key\"],\n    _excluded2 = [\"map_row_key\"];\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\n/* eslint-disable react-hooks/exhaustive-deps */\n\nimport { LoadingOutlined } from '@ant-design/icons';\nimport { useIntl } from '@ant-design/pro-provider';\nimport useLazyKVMap from \"antd/es/table/hooks/useLazyKVMap\";\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport get from \"rc-util/es/utils/get\";\nimport set from \"rc-util/es/utils/set\";\nimport { noteOnce } from \"rc-util/es/warning\";\nimport { useContext, useMemo, useRef, useState } from 'react';\nimport { useDebounceFn, useRefFunction } from '..';\nimport ProFormContext from '../components/ProFormContext';\nimport { useDeepCompareEffectDebounce } from '../hooks/useDeepCompareEffect';\nimport usePrevious from '../hooks/usePrevious';\nimport { merge } from '../merge';\nimport useMountMergeState from '../useMountMergeState';\nexport var recordKeyToString = function recordKeyToString(rowKey) {\n  if (Array.isArray(rowKey)) return rowKey.join(',');\n  return rowKey;\n};\n/**\n * 使用map 来删除数据，性能一般 但是准确率比较高\n *\n * @param params\n * @param action\n */\n\nexport function editableRowByKey(params, action) {\n  var _recordKeyToString;\n\n  var getRowKey = params.getRowKey,\n      row = params.row,\n      data = params.data,\n      childrenColumnName = params.childrenColumnName;\n  var key = (_recordKeyToString = recordKeyToString(params.key)) === null || _recordKeyToString === void 0 ? void 0 : _recordKeyToString.toString();\n  var kvMap = new Map();\n  /**\n   * 打平这个数组\n   *\n   * @param records\n   * @param parentKey\n   */\n\n  function dig(records, map_row_parentKey, map_row_index) {\n    records.forEach(function (record, index) {\n      var eachIndex = (map_row_index || 0) * 10 + index;\n      var recordKey = getRowKey(record, eachIndex).toString(); // children 取在前面方便拼的时候按照反顺序放回去\n\n      if (record && _typeof(record) === 'object' && childrenColumnName in record) {\n        dig(record[childrenColumnName] || [], recordKey, eachIndex);\n      }\n\n      var newRecord = _objectSpread(_objectSpread({}, record), {}, {\n        map_row_key: recordKey,\n        children: undefined,\n        map_row_parentKey: map_row_parentKey\n      });\n\n      delete newRecord.children;\n\n      if (!map_row_parentKey) {\n        delete newRecord.map_row_parentKey;\n      }\n\n      kvMap.set(recordKey, newRecord);\n    });\n  }\n\n  if (action === 'top') {\n    kvMap.set(key, _objectSpread(_objectSpread({}, kvMap.get(key)), row));\n  }\n\n  dig(data);\n\n  if (action === 'update') {\n    kvMap.set(key, _objectSpread(_objectSpread({}, kvMap.get(key)), row));\n  }\n\n  if (action === 'delete') {\n    kvMap.delete(key);\n  }\n\n  var fill = function fill(map) {\n    var kvArrayMap = new Map();\n    var kvSource = [];\n    map.forEach(function (value) {\n      if (value.map_row_parentKey) {\n        // @ts-ignore\n        var map_row_parentKey = value.map_row_parentKey,\n            map_row_key = value.map_row_key,\n            reset = _objectWithoutProperties(value, _excluded);\n\n        if (kvArrayMap.has(map_row_key)) {\n          reset[childrenColumnName] = kvArrayMap.get(map_row_key);\n        }\n\n        kvArrayMap.set(map_row_parentKey, [].concat(_toConsumableArray(kvArrayMap.get(map_row_parentKey) || []), [reset]));\n      }\n    });\n    map.forEach(function (value) {\n      if (!value.map_row_parentKey) {\n        // @ts-ignore\n        var map_row_key = value.map_row_key,\n            rest = _objectWithoutProperties(value, _excluded2);\n\n        if (kvArrayMap.has(map_row_key)) {\n          var item = _objectSpread(_objectSpread({}, rest), {}, _defineProperty({}, childrenColumnName, kvArrayMap.get(map_row_key)));\n\n          kvSource.push(item);\n          return;\n        }\n\n        kvSource.push(rest);\n      }\n    });\n    return kvSource;\n  };\n\n  var source = fill(kvMap);\n  return source;\n}\n/**\n * 保存按钮的dom\n *\n * @param ActionRenderConfig\n */\n\nexport function SaveEditableAction(_ref) {\n  var recordKey = _ref.recordKey,\n      onSave = _ref.onSave,\n      form = _ref.form,\n      row = _ref.row,\n      children = _ref.children,\n      newLineConfig = _ref.newLineConfig,\n      editorType = _ref.editorType,\n      tableName = _ref.tableName;\n  var context = useContext(ProFormContext);\n\n  var _useMountMergeState = useMountMergeState(false),\n      _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),\n      loading = _useMountMergeState2[0],\n      setLoading = _useMountMergeState2[1];\n\n  return _jsxs(\"a\", {\n    onClick: function () {\n      var _onClick = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(e) {\n        var _context$getFieldForm, isMapEditor, namePath, fields, _recordKey, recordKeyPath, curValue, data, res;\n\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                e.stopPropagation();\n                e.preventDefault();\n                _context.prev = 2;\n                isMapEditor = editorType === 'Map'; // 为了兼容类型为 array 的 dataIndex,当 recordKey 是一个数组时，用于获取表单值的 key 只取第一项，\n                // 从表单中获取回来之后，再根据 namepath 获取具体的某个字段并设置\n\n                namePath = [tableName, Array.isArray(recordKey) ? recordKey[0] : recordKey].map(function (key) {\n                  return key === null || key === void 0 ? void 0 : key.toString();\n                }).flat(1).filter(Boolean);\n                setLoading(true); // @ts-expect-error\n\n                _context.next = 8;\n                return form.validateFields(namePath, {\n                  recursive: true\n                });\n\n              case 8:\n                fields = ((_context$getFieldForm = context.getFieldFormatValue) === null || _context$getFieldForm === void 0 ? void 0 : _context$getFieldForm.call(context, namePath)) || form.getFieldValue(namePath); // 处理 dataIndex 为数组的情况\n\n                if (Array.isArray(recordKey) && recordKey.length > 1) {\n                  // 获取 namepath\n                  _recordKey = _toArray(recordKey), recordKeyPath = _recordKey.slice(1); // 将目标值获取出来并设置到 fields 当中\n\n                  curValue = get(fields, recordKeyPath);\n                  set(fields, recordKeyPath, curValue);\n                }\n\n                data = isMapEditor ? set({}, namePath, fields, true) : fields; // 获取数据并保存\n\n                _context.next = 13;\n                return onSave === null || onSave === void 0 ? void 0 : onSave(recordKey, // 如果是 map 模式，fields 就是一个值，所以需要set 到对象中\n                // 数据模式 fields 是一个对象，所以不需要\n                merge({}, row, data), row, newLineConfig);\n\n              case 13:\n                res = _context.sent;\n                setLoading(false);\n                return _context.abrupt(\"return\", res);\n\n              case 18:\n                _context.prev = 18;\n                _context.t0 = _context[\"catch\"](2); // eslint-disable-next-line no-console\n\n                console.log(_context.t0);\n                setLoading(false);\n                return _context.abrupt(\"return\", null);\n\n              case 23:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[2, 18]]);\n      }));\n\n      function onClick(_x) {\n        return _onClick.apply(this, arguments);\n      }\n\n      return onClick;\n    }(),\n    children: [loading ? _jsx(LoadingOutlined, {\n      style: {\n        marginRight: 8\n      }\n    }) : null, children || '保存']\n  }, \"save\");\n}\n/**\n * 删除按钮 dom\n *\n * @param ActionRenderConfig\n */\n\nexport var DeleteEditableAction = function DeleteEditableAction(_ref2) {\n  var recordKey = _ref2.recordKey,\n      onDelete = _ref2.onDelete,\n      row = _ref2.row,\n      children = _ref2.children,\n      deletePopconfirmMessage = _ref2.deletePopconfirmMessage,\n      cancelEditable = _ref2.cancelEditable;\n\n  var _useMountMergeState3 = useMountMergeState(function () {\n    return false;\n  }),\n      _useMountMergeState4 = _slicedToArray(_useMountMergeState3, 2),\n      loading = _useMountMergeState4[0],\n      setLoading = _useMountMergeState4[1];\n\n  var onConfirm = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      var res;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              setLoading(true);\n              _context2.next = 4;\n              return onDelete === null || onDelete === void 0 ? void 0 : onDelete(recordKey, row);\n\n            case 4:\n              res = _context2.sent;\n              setLoading(false);\n              setTimeout(function () {\n                // 删除之后解除编辑状态，防止新建一行失效\n                cancelEditable(recordKey);\n              }, 0);\n              return _context2.abrupt(\"return\", res);\n\n            case 10:\n              _context2.prev = 10;\n              _context2.t0 = _context2[\"catch\"](0); // eslint-disable-next-line no-console\n\n              console.log(_context2.t0);\n              setLoading(false);\n              return _context2.abrupt(\"return\", null);\n\n            case 15:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 10]]);\n    }));\n\n    return function onConfirm() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return children !== false ? _jsx(_Popconfirm, {\n    title: deletePopconfirmMessage,\n    onConfirm: onConfirm,\n    children: _jsxs(\"a\", {\n      children: [loading ? _jsx(LoadingOutlined, {\n        style: {\n          marginRight: 8\n        }\n      }) : null, children || '删除']\n    })\n  }, \"delete\") : null;\n};\n\nvar CancelEditableAction = function CancelEditableAction(props) {\n  var recordKey = props.recordKey,\n      tableName = props.tableName,\n      newLineConfig = props.newLineConfig,\n      form = props.form,\n      editorType = props.editorType,\n      onCancel = props.onCancel,\n      cancelEditable = props.cancelEditable,\n      row = props.row,\n      cancelText = props.cancelText;\n  var context = useContext(ProFormContext);\n  return _jsx(\"a\", {\n    onClick: function () {\n      var _onClick2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(e) {\n        var _context$getFieldForm2;\n\n        var isMapEditor, namePath, fields, record, res;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                e.stopPropagation();\n                e.preventDefault();\n                isMapEditor = editorType === 'Map';\n                namePath = [tableName, recordKey].flat(1).filter(Boolean);\n                fields = ((_context$getFieldForm2 = context.getFieldFormatValue) === null || _context$getFieldForm2 === void 0 ? void 0 : _context$getFieldForm2.call(context, namePath)) || form.getFieldValue(namePath);\n                record = isMapEditor ? set({}, namePath, fields) : fields;\n                _context3.next = 8;\n                return onCancel === null || onCancel === void 0 ? void 0 : onCancel(recordKey, record, row, newLineConfig);\n\n              case 8:\n                res = _context3.sent;\n                cancelEditable(recordKey);\n                /** 充值为默认值，不然编辑的行会丢掉 */\n\n                form.setFieldsValue(_defineProperty({}, recordKey, isMapEditor ? get(row, namePath) : row));\n                return _context3.abrupt(\"return\", res);\n\n              case 12:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      function onClick(_x2) {\n        return _onClick2.apply(this, arguments);\n      }\n\n      return onClick;\n    }(),\n    children: cancelText || '取消'\n  }, \"cancel\");\n};\n\nexport function defaultActionRender(row, config) {\n  var recordKey = config.recordKey,\n      newLineConfig = config.newLineConfig,\n      saveText = config.saveText,\n      deleteText = config.deleteText;\n  return [_jsx(SaveEditableAction, _objectSpread(_objectSpread({}, config), {}, {\n    row: row,\n    children: saveText\n  }), \"save\"), (newLineConfig === null || newLineConfig === void 0 ? void 0 : newLineConfig.options.recordKey) !== recordKey ? _jsx(DeleteEditableAction, _objectSpread(_objectSpread({}, config), {}, {\n    row: row,\n    children: deleteText\n  }), \"delete\") : null, _jsx(CancelEditableAction, _objectSpread(_objectSpread({}, config), {}, {\n    row: row\n  }), \"cancel\")];\n}\n/**\n * 一个方便的hooks 用于维护编辑的状态\n *\n * @param props\n */\n\nfunction useEditableArray(props) {\n  var _useState = useState(undefined),\n      _useState2 = _slicedToArray(_useState, 2),\n      newLineRecordCache = _useState2[0],\n      setNewLineRecordCache = _useState2[1];\n\n  var dataSourceKeyIndexMapRef = useRef(new Map());\n  var newLineRecordRef = useRef(undefined);\n  useDeepCompareEffectDebounce(function () {\n    var map = new Map();\n\n    var loopGetKey = function loopGetKey(dataSource) {\n      dataSource === null || dataSource === void 0 ? void 0 : dataSource.forEach(function (record, index) {\n        var _recordKeyToString2;\n\n        map.set(index.toString(), recordKeyToString(props.getRowKey(record, -1)));\n        map.set((_recordKeyToString2 = recordKeyToString(props.getRowKey(record, -1))) === null || _recordKeyToString2 === void 0 ? void 0 : _recordKeyToString2.toString(), index.toString());\n\n        if (props.childrenColumnName && record[props.childrenColumnName]) {\n          loopGetKey(record[props.childrenColumnName]);\n        }\n      });\n    };\n\n    loopGetKey(props.dataSource);\n    dataSourceKeyIndexMapRef.current = map;\n  }, [props.dataSource]); // 这里这么做是为了存上次的状态，不然每次存一下再拿\n\n  newLineRecordRef.current = newLineRecordCache;\n  var editableType = props.type || 'single';\n\n  var _useLazyKVMap = useLazyKVMap(props.dataSource, 'children', props.getRowKey),\n      _useLazyKVMap2 = _slicedToArray(_useLazyKVMap, 1),\n      getRecordByKey = _useLazyKVMap2[0];\n\n  var _useMergedState = useMergedState([], {\n    value: props.editableKeys,\n    onChange: props.onChange ? function (keys) {\n      var _props$onChange;\n\n      props === null || props === void 0 ? void 0 : (_props$onChange = props.onChange) === null || _props$onChange === void 0 ? void 0 : _props$onChange.call(props, // 计算编辑的key\n      keys.filter(function (key) {\n        return key !== undefined;\n      }), // 计算编辑的行\n      keys.map(function (key) {\n        return getRecordByKey(key);\n      }).filter(function (key) {\n        return key !== undefined;\n      }));\n    } : undefined\n  }),\n      _useMergedState2 = _slicedToArray(_useMergedState, 2),\n      editableKeys = _useMergedState2[0],\n      setEditableRowKeys = _useMergedState2[1];\n  /** 一个用来标志的set 提供了方便的 api 来去重什么的 */\n\n\n  var editableKeysSet = useMemo(function () {\n    var keys = editableType === 'single' ? editableKeys === null || editableKeys === void 0 ? void 0 : editableKeys.slice(0, 1) : editableKeys;\n    return new Set(keys);\n  }, [(editableKeys || []).join(','), editableType]);\n  var editableKeysRef = usePrevious(editableKeys);\n  /** 这行是不是编辑状态 */\n\n  var isEditable = useRefFunction(function (row) {\n    var _props$getRowKey, _props$getRowKey$toSt, _props$getRowKey2, _props$getRowKey2$toS; // 为了兼容一下name 模式的 indexKey，所以需要判断两次，一次是index，一次是没有 index 的\n\n\n    var recordKeyOrIndex = (_props$getRowKey = props.getRowKey(row, row.index)) === null || _props$getRowKey === void 0 ? void 0 : (_props$getRowKey$toSt = _props$getRowKey.toString) === null || _props$getRowKey$toSt === void 0 ? void 0 : _props$getRowKey$toSt.call(_props$getRowKey); // 这里是不设置 index 的地方\n\n    var recordKey = (_props$getRowKey2 = props.getRowKey(row, -1)) === null || _props$getRowKey2 === void 0 ? void 0 : (_props$getRowKey2$toS = _props$getRowKey2.toString) === null || _props$getRowKey2$toS === void 0 ? void 0 : _props$getRowKey2$toS.call(_props$getRowKey2); // 都转化为了字符串，不然 number 和 string\n\n    var stringEditableKeys = editableKeys.map(function (key) {\n      return key === null || key === void 0 ? void 0 : key.toString();\n    });\n    var stringEditableKeysRef = (editableKeysRef === null || editableKeysRef === void 0 ? void 0 : editableKeysRef.map(function (key) {\n      return key === null || key === void 0 ? void 0 : key.toString();\n    })) || [];\n    var preIsEditable = props.tableName && !!(stringEditableKeysRef === null || stringEditableKeysRef === void 0 ? void 0 : stringEditableKeysRef.includes(recordKey)) || !!(stringEditableKeysRef === null || stringEditableKeysRef === void 0 ? void 0 : stringEditableKeysRef.includes(recordKeyOrIndex));\n    return {\n      recordKey: recordKey,\n      isEditable: props.tableName && (stringEditableKeys === null || stringEditableKeys === void 0 ? void 0 : stringEditableKeys.includes(recordKey)) || (stringEditableKeys === null || stringEditableKeys === void 0 ? void 0 : stringEditableKeys.includes(recordKeyOrIndex)),\n      preIsEditable: preIsEditable\n    };\n  });\n  /**\n   * 进入编辑状态\n   *\n   * @param recordKey\n   */\n\n  var startEditable = useRefFunction(function (recordKey) {\n    // 如果是单行的话，不允许多行编辑\n    if (editableKeysSet.size > 0 && editableType === 'single' && props.onlyOneLineEditorAlertMessage !== false) {\n      _message.warn(props.onlyOneLineEditorAlertMessage || '只能同时编辑一行');\n\n      return false;\n    }\n\n    editableKeysSet.add(recordKey);\n    setEditableRowKeys(Array.from(editableKeysSet));\n    return true;\n  });\n  /**\n   * 退出编辑状态\n   *\n   * @param recordKey\n   */\n\n  var cancelEditable = useRefFunction(function (recordKey, needReTry) {\n    var relayKey = recordKeyToString(recordKey).toString();\n    var key = dataSourceKeyIndexMapRef.current.get(relayKey);\n    /** 如果没找到key，转化一下再去找 */\n\n    if (!editableKeysSet.has(relayKey) && key && (needReTry !== null && needReTry !== void 0 ? needReTry : true) && props.tableName) {\n      cancelEditable(key, false);\n      return;\n    }\n    /** 如果这个是 new Line 直接删除 */\n\n\n    if (newLineRecordCache && newLineRecordCache.options.recordKey === recordKey) {\n      setNewLineRecordCache(undefined);\n    }\n\n    editableKeysSet.delete(relayKey);\n    editableKeysSet.delete(recordKeyToString(recordKey));\n    setEditableRowKeys(Array.from(editableKeysSet));\n    return true;\n  });\n  var propsOnValuesChange = useDebounceFn( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n    var _props$onValuesChange;\n\n    var _len,\n        rest,\n        _key,\n        _args4 = arguments;\n\n    return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            for (_len = _args4.length, rest = new Array(_len), _key = 0; _key < _len; _key++) {\n              rest[_key] = _args4[_key];\n            } //@ts-ignore\n\n\n            (_props$onValuesChange = props.onValuesChange) === null || _props$onValuesChange === void 0 ? void 0 : _props$onValuesChange.call.apply(_props$onValuesChange, [props].concat(rest));\n\n          case 2:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  })), 64);\n  var onValuesChange = useRefFunction(function (value, values) {\n    var _Object$keys$pop;\n\n    if (!props.onValuesChange) {\n      return;\n    }\n\n    var dataSource = props.dataSource; // 这里是把正在编辑中的所有表单数据都修改掉\n    // 不然会用 props 里面的 dataSource，数据只有正在编辑中的\n    // Object.keys(get(values, [props.tableName || ''].flat(1)) || values).forEach((recordKey) => {\n\n    editableKeys.forEach(function (eachRecordKey) {\n      if ((newLineRecordCache === null || newLineRecordCache === void 0 ? void 0 : newLineRecordCache.options.recordKey) === eachRecordKey) return;\n      var recordKey = eachRecordKey.toString(); // 如果数据在这个 form 中没有展示，也不显示\n\n      var editRow = get(values, [props.tableName || '', recordKey].flat(1).filter(function (key) {\n        return key || key === 0;\n      }));\n      if (!editRow) return;\n      dataSource = editableRowByKey({\n        data: dataSource,\n        getRowKey: props.getRowKey,\n        row: editRow,\n        key: recordKey,\n        childrenColumnName: props.childrenColumnName || 'children'\n      }, 'update');\n    });\n    var relayValue = props.tableName ? get(value, [props.tableName || ''].flat(1)) : value;\n    var recordKey = (_Object$keys$pop = Object.keys(relayValue || {}).pop()) === null || _Object$keys$pop === void 0 ? void 0 : _Object$keys$pop.toString(); //从form 和 cache 中取得数据\n\n    var newLineRecordData = _objectSpread(_objectSpread({}, newLineRecordCache === null || newLineRecordCache === void 0 ? void 0 : newLineRecordCache.defaultValue), get(values, [props.tableName || '', recordKey.toString()].flat(1).filter(function (key) {\n      return key || key === 0;\n    })));\n    /** 如果已经在 dataSource 中存在了，直接 find */\n\n\n    var editRow = dataSourceKeyIndexMapRef.current.has(recordKeyToString(recordKey)) ? dataSource.find(function (item, index) {\n      var _props$getRowKey3;\n\n      var key = (_props$getRowKey3 = props.getRowKey(item, index)) === null || _props$getRowKey3 === void 0 ? void 0 : _props$getRowKey3.toString();\n      return key === recordKey;\n    }) : newLineRecordData;\n    propsOnValuesChange.run(editRow || newLineRecordData, dataSource);\n  });\n  /**\n   * 同时只能支持一行,取消之后数据消息，不会触发 dataSource\n   *\n   * @param row\n   * @param options\n   * @name 增加新的行\n   */\n\n  var addEditRecord = useRefFunction(function (row, options) {\n    if ((options === null || options === void 0 ? void 0 : options.parentKey) && !dataSourceKeyIndexMapRef.current.has(recordKeyToString(options === null || options === void 0 ? void 0 : options.parentKey).toString())) {\n      console.warn(\"can't find record by key\", options === null || options === void 0 ? void 0 : options.parentKey);\n      return false;\n    } // 暂时不支持多行新增\n\n\n    if (newLineRecordRef.current && props.onlyAddOneLineAlertMessage !== false) {\n      _message.warn(props.onlyAddOneLineAlertMessage || '只能新增一行');\n\n      return false;\n    } // 如果是单行的话，不允许多行编辑\n\n\n    if (editableKeysSet.size > 0 && editableType === 'single' && props.onlyOneLineEditorAlertMessage !== false) {\n      _message.warn(props.onlyOneLineEditorAlertMessage || '只能同时编辑一行');\n\n      return false;\n    } // 防止多次渲染\n\n\n    var recordKey = props.getRowKey(row, -1);\n\n    if (!recordKey) {\n      noteOnce(!!recordKey, '请设置 recordCreatorProps.record 并返回一个唯一的key  \\n  https://procomponents.ant.design/components/editable-table#editable-%E6%96%B0%E5%BB%BA%E8%A1%8C');\n      throw new Error('请设置 recordCreatorProps.record 并返回一个唯一的key');\n    }\n\n    editableKeysSet.add(recordKey);\n    setEditableRowKeys(Array.from(editableKeysSet)); // 如果是dataSource 新增模式的话，取消再开始编辑，\n    // 这样就可以把新增到 dataSource的数据进入编辑模式了\n    // [a,b,cache] => [a,b,c]\n\n    if ((options === null || options === void 0 ? void 0 : options.newRecordType) === 'dataSource' || props.tableName) {\n      var _recordKeyToString3;\n\n      var actionProps = {\n        data: props.dataSource,\n        getRowKey: props.getRowKey,\n        row: _objectSpread(_objectSpread({}, row), {}, {\n          map_row_parentKey: (options === null || options === void 0 ? void 0 : options.parentKey) ? (_recordKeyToString3 = recordKeyToString(options === null || options === void 0 ? void 0 : options.parentKey)) === null || _recordKeyToString3 === void 0 ? void 0 : _recordKeyToString3.toString() : undefined\n        }),\n        key: recordKey,\n        childrenColumnName: props.childrenColumnName || 'children'\n      };\n      props.setDataSource(editableRowByKey(actionProps, (options === null || options === void 0 ? void 0 : options.position) === 'top' ? 'top' : 'update'));\n    } else {\n      setNewLineRecordCache({\n        defaultValue: row,\n        options: _objectSpread(_objectSpread({}, options), {}, {\n          recordKey: recordKey\n        })\n      });\n    }\n\n    return true;\n  }); // Internationalization\n\n  var intl = useIntl();\n  var saveText = (props === null || props === void 0 ? void 0 : props.saveText) || intl.getMessage('editableTable.action.save', '保存');\n  var deleteText = (props === null || props === void 0 ? void 0 : props.deleteText) || intl.getMessage('editableTable.action.delete', '删除');\n  var cancelText = (props === null || props === void 0 ? void 0 : props.cancelText) || intl.getMessage('editableTable.action.cancel', '取消');\n  var actionSaveRef = useRefFunction( /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(recordKey, editRow, originRow, newLine) {\n      var _props$onSave, _recordKeyToString4, _options$parentKey;\n\n      var _ref6, options, res, actionProps;\n\n      return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _ref6 = newLine || newLineRecordRef.current || {}, options = _ref6.options;\n              _context5.next = 3;\n              return props === null || props === void 0 ? void 0 : (_props$onSave = props.onSave) === null || _props$onSave === void 0 ? void 0 : _props$onSave.call(props, recordKey, editRow, originRow, newLine);\n\n            case 3:\n              res = _context5.sent; // 保存时解除编辑模式\n\n              cancelEditable(recordKey);\n\n              if (!(!(options === null || options === void 0 ? void 0 : options.parentKey) && (options === null || options === void 0 ? void 0 : options.recordKey) === recordKey)) {\n                _context5.next = 8;\n                break;\n              }\n\n              if ((options === null || options === void 0 ? void 0 : options.position) === 'top') {\n                props.setDataSource([editRow].concat(_toConsumableArray(props.dataSource)));\n              } else {\n                props.setDataSource([].concat(_toConsumableArray(props.dataSource), [editRow]));\n              }\n\n              return _context5.abrupt(\"return\", res);\n\n            case 8:\n              actionProps = {\n                data: props.dataSource,\n                getRowKey: props.getRowKey,\n                row: options ? _objectSpread(_objectSpread({}, editRow), {}, {\n                  map_row_parentKey: (_recordKeyToString4 = recordKeyToString((_options$parentKey = options === null || options === void 0 ? void 0 : options.parentKey) !== null && _options$parentKey !== void 0 ? _options$parentKey : '')) === null || _recordKeyToString4 === void 0 ? void 0 : _recordKeyToString4.toString()\n                }) : editRow,\n                key: recordKey,\n                childrenColumnName: props.childrenColumnName || 'children'\n              };\n              props.setDataSource(editableRowByKey(actionProps, (options === null || options === void 0 ? void 0 : options.position) === 'top' ? 'top' : 'update'));\n              return _context5.abrupt(\"return\", res);\n\n            case 11:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function (_x3, _x4, _x5, _x6) {\n      return _ref5.apply(this, arguments);\n    };\n  }());\n  var actionDeleteRef = useRefFunction( /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(recordKey, editRow) {\n      var _props$onDelete;\n\n      var actionProps, res;\n      return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              actionProps = {\n                data: props.dataSource,\n                getRowKey: props.getRowKey,\n                row: editRow,\n                key: recordKey,\n                childrenColumnName: props.childrenColumnName || 'children'\n              };\n              _context6.next = 3;\n              return props === null || props === void 0 ? void 0 : (_props$onDelete = props.onDelete) === null || _props$onDelete === void 0 ? void 0 : _props$onDelete.call(props, recordKey, editRow);\n\n            case 3:\n              res = _context6.sent;\n              props.setDataSource(editableRowByKey(actionProps, 'delete'));\n              return _context6.abrupt(\"return\", res);\n\n            case 6:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function (_x7, _x8) {\n      return _ref7.apply(this, arguments);\n    };\n  }());\n  var actionCancelRef = useRefFunction( /*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(recordKey, editRow, originRow, newLine) {\n      var _props$onCancel;\n\n      var res;\n      return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.next = 2;\n              return props === null || props === void 0 ? void 0 : (_props$onCancel = props.onCancel) === null || _props$onCancel === void 0 ? void 0 : _props$onCancel.call(props, recordKey, editRow, originRow, newLine);\n\n            case 2:\n              res = _context7.sent;\n              return _context7.abrupt(\"return\", res);\n\n            case 4:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }));\n\n    return function (_x9, _x10, _x11, _x12) {\n      return _ref8.apply(this, arguments);\n    };\n  }());\n\n  var actionRender = function actionRender(row, form) {\n    var key = props.getRowKey(row, row.index);\n    var config = {\n      saveText: saveText,\n      cancelText: cancelText,\n      deleteText: deleteText,\n      addEditRecord: addEditRecord,\n      recordKey: key,\n      cancelEditable: cancelEditable,\n      index: row.index,\n      tableName: props.tableName,\n      newLineConfig: newLineRecordCache,\n      onCancel: actionCancelRef,\n      onDelete: actionDeleteRef,\n      onSave: actionSaveRef,\n      form: form,\n      editableKeys: editableKeys,\n      setEditableRowKeys: setEditableRowKeys,\n      deletePopconfirmMessage: props.deletePopconfirmMessage || '删除此行？'\n    };\n    var defaultDoms = defaultActionRender(row, config);\n    if (props.actionRender) return props.actionRender(row, config, {\n      save: defaultDoms[0],\n      delete: defaultDoms[1],\n      cancel: defaultDoms[2]\n    });\n    return defaultDoms;\n  };\n\n  return {\n    editableKeys: editableKeys,\n    setEditableRowKeys: setEditableRowKeys,\n    isEditable: isEditable,\n    actionRender: actionRender,\n    startEditable: startEditable,\n    cancelEditable: cancelEditable,\n    addEditRecord: addEditRecord,\n    newLineRecord: newLineRecordCache,\n    preEditableKeys: editableKeysRef,\n    onValuesChange: onValuesChange\n  };\n}\n\nexport default useEditableArray;","map":{"version":3,"names":["_message","_Popconfirm","_regeneratorRuntime","_toArray","_asyncToGenerator","_slicedToArray","_defineProperty","_toConsumableArray","_objectWithoutProperties","_objectSpread","_typeof","_excluded","_excluded2","jsx","_jsx","jsxs","_jsxs","LoadingOutlined","useIntl","useLazyKVMap","useMergedState","get","set","noteOnce","useContext","useMemo","useRef","useState","useDebounceFn","useRefFunction","ProFormContext","useDeepCompareEffectDebounce","usePrevious","merge","useMountMergeState","recordKeyToString","rowKey","Array","isArray","join","editableRowByKey","params","action","_recordKeyToString","getRowKey","row","data","childrenColumnName","key","toString","kvMap","Map","dig","records","map_row_parentKey","map_row_index","forEach","record","index","eachIndex","recordKey","newRecord","map_row_key","children","undefined","delete","fill","map","kvArrayMap","kvSource","value","reset","has","concat","rest","item","push","source","SaveEditableAction","_ref","onSave","form","newLineConfig","editorType","tableName","context","_useMountMergeState","_useMountMergeState2","loading","setLoading","onClick","_onClick","mark","_callee","e","_context$getFieldForm","isMapEditor","namePath","fields","_recordKey","recordKeyPath","curValue","res","wrap","_callee$","_context","prev","next","stopPropagation","preventDefault","flat","filter","Boolean","validateFields","recursive","getFieldFormatValue","call","getFieldValue","length","slice","sent","abrupt","t0","console","log","stop","_x","apply","arguments","style","marginRight","DeleteEditableAction","_ref2","onDelete","deletePopconfirmMessage","cancelEditable","_useMountMergeState3","_useMountMergeState4","onConfirm","_ref3","_callee2","_callee2$","_context2","setTimeout","title","CancelEditableAction","props","onCancel","cancelText","_onClick2","_callee3","_context$getFieldForm2","_callee3$","_context3","setFieldsValue","_x2","defaultActionRender","config","saveText","deleteText","options","useEditableArray","_useState","_useState2","newLineRecordCache","setNewLineRecordCache","dataSourceKeyIndexMapRef","newLineRecordRef","loopGetKey","dataSource","_recordKeyToString2","current","editableType","type","_useLazyKVMap","_useLazyKVMap2","getRecordByKey","_useMergedState","editableKeys","onChange","keys","_props$onChange","_useMergedState2","setEditableRowKeys","editableKeysSet","Set","editableKeysRef","isEditable","_props$getRowKey","_props$getRowKey$toSt","_props$getRowKey2","_props$getRowKey2$toS","recordKeyOrIndex","stringEditableKeys","stringEditableKeysRef","preIsEditable","includes","startEditable","size","onlyOneLineEditorAlertMessage","warn","add","from","needReTry","relayKey","propsOnValuesChange","_callee4","_props$onValuesChange","_len","_key","_args4","_callee4$","_context4","onValuesChange","values","_Object$keys$pop","eachRecordKey","editRow","relayValue","Object","pop","newLineRecordData","defaultValue","find","_props$getRowKey3","run","addEditRecord","parentKey","onlyAddOneLineAlertMessage","Error","newRecordType","_recordKeyToString3","actionProps","setDataSource","position","intl","getMessage","actionSaveRef","_ref5","_callee5","originRow","newLine","_props$onSave","_recordKeyToString4","_options$parentKey","_ref6","_callee5$","_context5","_x3","_x4","_x5","_x6","actionDeleteRef","_ref7","_callee6","_props$onDelete","_callee6$","_context6","_x7","_x8","actionCancelRef","_ref8","_callee7","_props$onCancel","_callee7$","_context7","_x9","_x10","_x11","_x12","actionRender","defaultDoms","save","cancel","newLineRecord","preEditableKeys"],"sources":["D:/Canh Long/Documents/Nam4_Ky 2/Chuyên Đề Mạng/Web/device-management-admin-main/node_modules/@ant-design/pro-utils/es/useEditableArray/index.js"],"sourcesContent":["import \"antd/es/message/style\";\nimport _message from \"antd/es/message\";\nimport \"antd/es/popconfirm/style\";\nimport _Popconfirm from \"antd/es/popconfirm\";\nimport _regeneratorRuntime from \"@babel/runtime/helpers/esm/regeneratorRuntime\";\nimport _toArray from \"@babel/runtime/helpers/esm/toArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nvar _excluded = [\"map_row_parentKey\", \"map_row_key\"],\n    _excluded2 = [\"map_row_key\"];\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\n/* eslint-disable react-hooks/exhaustive-deps */\n\nimport { LoadingOutlined } from '@ant-design/icons';\nimport { useIntl } from '@ant-design/pro-provider';\nimport useLazyKVMap from \"antd/es/table/hooks/useLazyKVMap\";\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport get from \"rc-util/es/utils/get\";\nimport set from \"rc-util/es/utils/set\";\nimport { noteOnce } from \"rc-util/es/warning\";\nimport { useContext, useMemo, useRef, useState } from 'react';\nimport { useDebounceFn, useRefFunction } from '..';\nimport ProFormContext from '../components/ProFormContext';\nimport { useDeepCompareEffectDebounce } from '../hooks/useDeepCompareEffect';\nimport usePrevious from '../hooks/usePrevious';\nimport { merge } from '../merge';\nimport useMountMergeState from '../useMountMergeState';\nexport var recordKeyToString = function recordKeyToString(rowKey) {\n  if (Array.isArray(rowKey)) return rowKey.join(',');\n  return rowKey;\n};\n/**\n * 使用map 来删除数据，性能一般 但是准确率比较高\n *\n * @param params\n * @param action\n */\n\nexport function editableRowByKey(params, action) {\n  var _recordKeyToString;\n\n  var getRowKey = params.getRowKey,\n      row = params.row,\n      data = params.data,\n      childrenColumnName = params.childrenColumnName;\n  var key = (_recordKeyToString = recordKeyToString(params.key)) === null || _recordKeyToString === void 0 ? void 0 : _recordKeyToString.toString();\n  var kvMap = new Map();\n  /**\n   * 打平这个数组\n   *\n   * @param records\n   * @param parentKey\n   */\n\n  function dig(records, map_row_parentKey, map_row_index) {\n    records.forEach(function (record, index) {\n      var eachIndex = (map_row_index || 0) * 10 + index;\n      var recordKey = getRowKey(record, eachIndex).toString(); // children 取在前面方便拼的时候按照反顺序放回去\n\n      if (record && _typeof(record) === 'object' && childrenColumnName in record) {\n        dig(record[childrenColumnName] || [], recordKey, eachIndex);\n      }\n\n      var newRecord = _objectSpread(_objectSpread({}, record), {}, {\n        map_row_key: recordKey,\n        children: undefined,\n        map_row_parentKey: map_row_parentKey\n      });\n\n      delete newRecord.children;\n\n      if (!map_row_parentKey) {\n        delete newRecord.map_row_parentKey;\n      }\n\n      kvMap.set(recordKey, newRecord);\n    });\n  }\n\n  if (action === 'top') {\n    kvMap.set(key, _objectSpread(_objectSpread({}, kvMap.get(key)), row));\n  }\n\n  dig(data);\n\n  if (action === 'update') {\n    kvMap.set(key, _objectSpread(_objectSpread({}, kvMap.get(key)), row));\n  }\n\n  if (action === 'delete') {\n    kvMap.delete(key);\n  }\n\n  var fill = function fill(map) {\n    var kvArrayMap = new Map();\n    var kvSource = [];\n    map.forEach(function (value) {\n      if (value.map_row_parentKey) {\n        // @ts-ignore\n        var map_row_parentKey = value.map_row_parentKey,\n            map_row_key = value.map_row_key,\n            reset = _objectWithoutProperties(value, _excluded);\n\n        if (kvArrayMap.has(map_row_key)) {\n          reset[childrenColumnName] = kvArrayMap.get(map_row_key);\n        }\n\n        kvArrayMap.set(map_row_parentKey, [].concat(_toConsumableArray(kvArrayMap.get(map_row_parentKey) || []), [reset]));\n      }\n    });\n    map.forEach(function (value) {\n      if (!value.map_row_parentKey) {\n        // @ts-ignore\n        var map_row_key = value.map_row_key,\n            rest = _objectWithoutProperties(value, _excluded2);\n\n        if (kvArrayMap.has(map_row_key)) {\n          var item = _objectSpread(_objectSpread({}, rest), {}, _defineProperty({}, childrenColumnName, kvArrayMap.get(map_row_key)));\n\n          kvSource.push(item);\n          return;\n        }\n\n        kvSource.push(rest);\n      }\n    });\n    return kvSource;\n  };\n\n  var source = fill(kvMap);\n  return source;\n}\n/**\n * 保存按钮的dom\n *\n * @param ActionRenderConfig\n */\n\nexport function SaveEditableAction(_ref) {\n  var recordKey = _ref.recordKey,\n      onSave = _ref.onSave,\n      form = _ref.form,\n      row = _ref.row,\n      children = _ref.children,\n      newLineConfig = _ref.newLineConfig,\n      editorType = _ref.editorType,\n      tableName = _ref.tableName;\n  var context = useContext(ProFormContext);\n\n  var _useMountMergeState = useMountMergeState(false),\n      _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),\n      loading = _useMountMergeState2[0],\n      setLoading = _useMountMergeState2[1];\n\n  return _jsxs(\"a\", {\n    onClick: function () {\n      var _onClick = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(e) {\n        var _context$getFieldForm, isMapEditor, namePath, fields, _recordKey, recordKeyPath, curValue, data, res;\n\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                e.stopPropagation();\n                e.preventDefault();\n                _context.prev = 2;\n                isMapEditor = editorType === 'Map'; // 为了兼容类型为 array 的 dataIndex,当 recordKey 是一个数组时，用于获取表单值的 key 只取第一项，\n                // 从表单中获取回来之后，再根据 namepath 获取具体的某个字段并设置\n\n                namePath = [tableName, Array.isArray(recordKey) ? recordKey[0] : recordKey].map(function (key) {\n                  return key === null || key === void 0 ? void 0 : key.toString();\n                }).flat(1).filter(Boolean);\n                setLoading(true); // @ts-expect-error\n\n                _context.next = 8;\n                return form.validateFields(namePath, {\n                  recursive: true\n                });\n\n              case 8:\n                fields = ((_context$getFieldForm = context.getFieldFormatValue) === null || _context$getFieldForm === void 0 ? void 0 : _context$getFieldForm.call(context, namePath)) || form.getFieldValue(namePath); // 处理 dataIndex 为数组的情况\n\n                if (Array.isArray(recordKey) && recordKey.length > 1) {\n                  // 获取 namepath\n                  _recordKey = _toArray(recordKey), recordKeyPath = _recordKey.slice(1); // 将目标值获取出来并设置到 fields 当中\n\n                  curValue = get(fields, recordKeyPath);\n                  set(fields, recordKeyPath, curValue);\n                }\n\n                data = isMapEditor ? set({}, namePath, fields, true) : fields; // 获取数据并保存\n\n                _context.next = 13;\n                return onSave === null || onSave === void 0 ? void 0 : onSave(recordKey, // 如果是 map 模式，fields 就是一个值，所以需要set 到对象中\n                // 数据模式 fields 是一个对象，所以不需要\n                merge({}, row, data), row, newLineConfig);\n\n              case 13:\n                res = _context.sent;\n                setLoading(false);\n                return _context.abrupt(\"return\", res);\n\n              case 18:\n                _context.prev = 18;\n                _context.t0 = _context[\"catch\"](2);\n                // eslint-disable-next-line no-console\n                console.log(_context.t0);\n                setLoading(false);\n                return _context.abrupt(\"return\", null);\n\n              case 23:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[2, 18]]);\n      }));\n\n      function onClick(_x) {\n        return _onClick.apply(this, arguments);\n      }\n\n      return onClick;\n    }(),\n    children: [loading ? _jsx(LoadingOutlined, {\n      style: {\n        marginRight: 8\n      }\n    }) : null, children || '保存']\n  }, \"save\");\n}\n/**\n * 删除按钮 dom\n *\n * @param ActionRenderConfig\n */\n\nexport var DeleteEditableAction = function DeleteEditableAction(_ref2) {\n  var recordKey = _ref2.recordKey,\n      onDelete = _ref2.onDelete,\n      row = _ref2.row,\n      children = _ref2.children,\n      deletePopconfirmMessage = _ref2.deletePopconfirmMessage,\n      cancelEditable = _ref2.cancelEditable;\n\n  var _useMountMergeState3 = useMountMergeState(function () {\n    return false;\n  }),\n      _useMountMergeState4 = _slicedToArray(_useMountMergeState3, 2),\n      loading = _useMountMergeState4[0],\n      setLoading = _useMountMergeState4[1];\n\n  var onConfirm = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      var res;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              setLoading(true);\n              _context2.next = 4;\n              return onDelete === null || onDelete === void 0 ? void 0 : onDelete(recordKey, row);\n\n            case 4:\n              res = _context2.sent;\n              setLoading(false);\n              setTimeout(function () {\n                // 删除之后解除编辑状态，防止新建一行失效\n                cancelEditable(recordKey);\n              }, 0);\n              return _context2.abrupt(\"return\", res);\n\n            case 10:\n              _context2.prev = 10;\n              _context2.t0 = _context2[\"catch\"](0);\n              // eslint-disable-next-line no-console\n              console.log(_context2.t0);\n              setLoading(false);\n              return _context2.abrupt(\"return\", null);\n\n            case 15:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 10]]);\n    }));\n\n    return function onConfirm() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return children !== false ? _jsx(_Popconfirm, {\n    title: deletePopconfirmMessage,\n    onConfirm: onConfirm,\n    children: _jsxs(\"a\", {\n      children: [loading ? _jsx(LoadingOutlined, {\n        style: {\n          marginRight: 8\n        }\n      }) : null, children || '删除']\n    })\n  }, \"delete\") : null;\n};\n\nvar CancelEditableAction = function CancelEditableAction(props) {\n  var recordKey = props.recordKey,\n      tableName = props.tableName,\n      newLineConfig = props.newLineConfig,\n      form = props.form,\n      editorType = props.editorType,\n      onCancel = props.onCancel,\n      cancelEditable = props.cancelEditable,\n      row = props.row,\n      cancelText = props.cancelText;\n  var context = useContext(ProFormContext);\n  return _jsx(\"a\", {\n    onClick: function () {\n      var _onClick2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(e) {\n        var _context$getFieldForm2;\n\n        var isMapEditor, namePath, fields, record, res;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                e.stopPropagation();\n                e.preventDefault();\n                isMapEditor = editorType === 'Map';\n                namePath = [tableName, recordKey].flat(1).filter(Boolean);\n                fields = ((_context$getFieldForm2 = context.getFieldFormatValue) === null || _context$getFieldForm2 === void 0 ? void 0 : _context$getFieldForm2.call(context, namePath)) || form.getFieldValue(namePath);\n                record = isMapEditor ? set({}, namePath, fields) : fields;\n                _context3.next = 8;\n                return onCancel === null || onCancel === void 0 ? void 0 : onCancel(recordKey, record, row, newLineConfig);\n\n              case 8:\n                res = _context3.sent;\n                cancelEditable(recordKey);\n                /** 充值为默认值，不然编辑的行会丢掉 */\n\n                form.setFieldsValue(_defineProperty({}, recordKey, isMapEditor ? get(row, namePath) : row));\n                return _context3.abrupt(\"return\", res);\n\n              case 12:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      function onClick(_x2) {\n        return _onClick2.apply(this, arguments);\n      }\n\n      return onClick;\n    }(),\n    children: cancelText || '取消'\n  }, \"cancel\");\n};\n\nexport function defaultActionRender(row, config) {\n  var recordKey = config.recordKey,\n      newLineConfig = config.newLineConfig,\n      saveText = config.saveText,\n      deleteText = config.deleteText;\n  return [_jsx(SaveEditableAction, _objectSpread(_objectSpread({}, config), {}, {\n    row: row,\n    children: saveText\n  }), \"save\"), (newLineConfig === null || newLineConfig === void 0 ? void 0 : newLineConfig.options.recordKey) !== recordKey ? _jsx(DeleteEditableAction, _objectSpread(_objectSpread({}, config), {}, {\n    row: row,\n    children: deleteText\n  }), \"delete\") : null, _jsx(CancelEditableAction, _objectSpread(_objectSpread({}, config), {}, {\n    row: row\n  }), \"cancel\")];\n}\n/**\n * 一个方便的hooks 用于维护编辑的状态\n *\n * @param props\n */\n\nfunction useEditableArray(props) {\n  var _useState = useState(undefined),\n      _useState2 = _slicedToArray(_useState, 2),\n      newLineRecordCache = _useState2[0],\n      setNewLineRecordCache = _useState2[1];\n\n  var dataSourceKeyIndexMapRef = useRef(new Map());\n  var newLineRecordRef = useRef(undefined);\n  useDeepCompareEffectDebounce(function () {\n    var map = new Map();\n\n    var loopGetKey = function loopGetKey(dataSource) {\n      dataSource === null || dataSource === void 0 ? void 0 : dataSource.forEach(function (record, index) {\n        var _recordKeyToString2;\n\n        map.set(index.toString(), recordKeyToString(props.getRowKey(record, -1)));\n        map.set((_recordKeyToString2 = recordKeyToString(props.getRowKey(record, -1))) === null || _recordKeyToString2 === void 0 ? void 0 : _recordKeyToString2.toString(), index.toString());\n\n        if (props.childrenColumnName && record[props.childrenColumnName]) {\n          loopGetKey(record[props.childrenColumnName]);\n        }\n      });\n    };\n\n    loopGetKey(props.dataSource);\n    dataSourceKeyIndexMapRef.current = map;\n  }, [props.dataSource]); // 这里这么做是为了存上次的状态，不然每次存一下再拿\n\n  newLineRecordRef.current = newLineRecordCache;\n  var editableType = props.type || 'single';\n\n  var _useLazyKVMap = useLazyKVMap(props.dataSource, 'children', props.getRowKey),\n      _useLazyKVMap2 = _slicedToArray(_useLazyKVMap, 1),\n      getRecordByKey = _useLazyKVMap2[0];\n\n  var _useMergedState = useMergedState([], {\n    value: props.editableKeys,\n    onChange: props.onChange ? function (keys) {\n      var _props$onChange;\n\n      props === null || props === void 0 ? void 0 : (_props$onChange = props.onChange) === null || _props$onChange === void 0 ? void 0 : _props$onChange.call(props, // 计算编辑的key\n      keys.filter(function (key) {\n        return key !== undefined;\n      }), // 计算编辑的行\n      keys.map(function (key) {\n        return getRecordByKey(key);\n      }).filter(function (key) {\n        return key !== undefined;\n      }));\n    } : undefined\n  }),\n      _useMergedState2 = _slicedToArray(_useMergedState, 2),\n      editableKeys = _useMergedState2[0],\n      setEditableRowKeys = _useMergedState2[1];\n  /** 一个用来标志的set 提供了方便的 api 来去重什么的 */\n\n\n  var editableKeysSet = useMemo(function () {\n    var keys = editableType === 'single' ? editableKeys === null || editableKeys === void 0 ? void 0 : editableKeys.slice(0, 1) : editableKeys;\n    return new Set(keys);\n  }, [(editableKeys || []).join(','), editableType]);\n  var editableKeysRef = usePrevious(editableKeys);\n  /** 这行是不是编辑状态 */\n\n  var isEditable = useRefFunction(function (row) {\n    var _props$getRowKey, _props$getRowKey$toSt, _props$getRowKey2, _props$getRowKey2$toS;\n\n    // 为了兼容一下name 模式的 indexKey，所以需要判断两次，一次是index，一次是没有 index 的\n    var recordKeyOrIndex = (_props$getRowKey = props.getRowKey(row, row.index)) === null || _props$getRowKey === void 0 ? void 0 : (_props$getRowKey$toSt = _props$getRowKey.toString) === null || _props$getRowKey$toSt === void 0 ? void 0 : _props$getRowKey$toSt.call(_props$getRowKey); // 这里是不设置 index 的地方\n\n    var recordKey = (_props$getRowKey2 = props.getRowKey(row, -1)) === null || _props$getRowKey2 === void 0 ? void 0 : (_props$getRowKey2$toS = _props$getRowKey2.toString) === null || _props$getRowKey2$toS === void 0 ? void 0 : _props$getRowKey2$toS.call(_props$getRowKey2); // 都转化为了字符串，不然 number 和 string\n\n    var stringEditableKeys = editableKeys.map(function (key) {\n      return key === null || key === void 0 ? void 0 : key.toString();\n    });\n    var stringEditableKeysRef = (editableKeysRef === null || editableKeysRef === void 0 ? void 0 : editableKeysRef.map(function (key) {\n      return key === null || key === void 0 ? void 0 : key.toString();\n    })) || [];\n    var preIsEditable = props.tableName && !!(stringEditableKeysRef === null || stringEditableKeysRef === void 0 ? void 0 : stringEditableKeysRef.includes(recordKey)) || !!(stringEditableKeysRef === null || stringEditableKeysRef === void 0 ? void 0 : stringEditableKeysRef.includes(recordKeyOrIndex));\n    return {\n      recordKey: recordKey,\n      isEditable: props.tableName && (stringEditableKeys === null || stringEditableKeys === void 0 ? void 0 : stringEditableKeys.includes(recordKey)) || (stringEditableKeys === null || stringEditableKeys === void 0 ? void 0 : stringEditableKeys.includes(recordKeyOrIndex)),\n      preIsEditable: preIsEditable\n    };\n  });\n  /**\n   * 进入编辑状态\n   *\n   * @param recordKey\n   */\n\n  var startEditable = useRefFunction(function (recordKey) {\n    // 如果是单行的话，不允许多行编辑\n    if (editableKeysSet.size > 0 && editableType === 'single' && props.onlyOneLineEditorAlertMessage !== false) {\n      _message.warn(props.onlyOneLineEditorAlertMessage || '只能同时编辑一行');\n\n      return false;\n    }\n\n    editableKeysSet.add(recordKey);\n    setEditableRowKeys(Array.from(editableKeysSet));\n    return true;\n  });\n  /**\n   * 退出编辑状态\n   *\n   * @param recordKey\n   */\n\n  var cancelEditable = useRefFunction(function (recordKey, needReTry) {\n    var relayKey = recordKeyToString(recordKey).toString();\n    var key = dataSourceKeyIndexMapRef.current.get(relayKey);\n    /** 如果没找到key，转化一下再去找 */\n\n    if (!editableKeysSet.has(relayKey) && key && (needReTry !== null && needReTry !== void 0 ? needReTry : true) && props.tableName) {\n      cancelEditable(key, false);\n      return;\n    }\n    /** 如果这个是 new Line 直接删除 */\n\n\n    if (newLineRecordCache && newLineRecordCache.options.recordKey === recordKey) {\n      setNewLineRecordCache(undefined);\n    }\n\n    editableKeysSet.delete(relayKey);\n    editableKeysSet.delete(recordKeyToString(recordKey));\n    setEditableRowKeys(Array.from(editableKeysSet));\n    return true;\n  });\n  var propsOnValuesChange = useDebounceFn( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n    var _props$onValuesChange;\n\n    var _len,\n        rest,\n        _key,\n        _args4 = arguments;\n\n    return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            for (_len = _args4.length, rest = new Array(_len), _key = 0; _key < _len; _key++) {\n              rest[_key] = _args4[_key];\n            }\n\n            //@ts-ignore\n            (_props$onValuesChange = props.onValuesChange) === null || _props$onValuesChange === void 0 ? void 0 : _props$onValuesChange.call.apply(_props$onValuesChange, [props].concat(rest));\n\n          case 2:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  })), 64);\n  var onValuesChange = useRefFunction(function (value, values) {\n    var _Object$keys$pop;\n\n    if (!props.onValuesChange) {\n      return;\n    }\n\n    var dataSource = props.dataSource; // 这里是把正在编辑中的所有表单数据都修改掉\n    // 不然会用 props 里面的 dataSource，数据只有正在编辑中的\n    // Object.keys(get(values, [props.tableName || ''].flat(1)) || values).forEach((recordKey) => {\n\n    editableKeys.forEach(function (eachRecordKey) {\n      if ((newLineRecordCache === null || newLineRecordCache === void 0 ? void 0 : newLineRecordCache.options.recordKey) === eachRecordKey) return;\n      var recordKey = eachRecordKey.toString(); // 如果数据在这个 form 中没有展示，也不显示\n\n      var editRow = get(values, [props.tableName || '', recordKey].flat(1).filter(function (key) {\n        return key || key === 0;\n      }));\n      if (!editRow) return;\n      dataSource = editableRowByKey({\n        data: dataSource,\n        getRowKey: props.getRowKey,\n        row: editRow,\n        key: recordKey,\n        childrenColumnName: props.childrenColumnName || 'children'\n      }, 'update');\n    });\n    var relayValue = props.tableName ? get(value, [props.tableName || ''].flat(1)) : value;\n    var recordKey = (_Object$keys$pop = Object.keys(relayValue || {}).pop()) === null || _Object$keys$pop === void 0 ? void 0 : _Object$keys$pop.toString(); //从form 和 cache 中取得数据\n\n    var newLineRecordData = _objectSpread(_objectSpread({}, newLineRecordCache === null || newLineRecordCache === void 0 ? void 0 : newLineRecordCache.defaultValue), get(values, [props.tableName || '', recordKey.toString()].flat(1).filter(function (key) {\n      return key || key === 0;\n    })));\n    /** 如果已经在 dataSource 中存在了，直接 find */\n\n\n    var editRow = dataSourceKeyIndexMapRef.current.has(recordKeyToString(recordKey)) ? dataSource.find(function (item, index) {\n      var _props$getRowKey3;\n\n      var key = (_props$getRowKey3 = props.getRowKey(item, index)) === null || _props$getRowKey3 === void 0 ? void 0 : _props$getRowKey3.toString();\n      return key === recordKey;\n    }) : newLineRecordData;\n    propsOnValuesChange.run(editRow || newLineRecordData, dataSource);\n  });\n  /**\n   * 同时只能支持一行,取消之后数据消息，不会触发 dataSource\n   *\n   * @param row\n   * @param options\n   * @name 增加新的行\n   */\n\n  var addEditRecord = useRefFunction(function (row, options) {\n    if ((options === null || options === void 0 ? void 0 : options.parentKey) && !dataSourceKeyIndexMapRef.current.has(recordKeyToString(options === null || options === void 0 ? void 0 : options.parentKey).toString())) {\n      console.warn(\"can't find record by key\", options === null || options === void 0 ? void 0 : options.parentKey);\n      return false;\n    } // 暂时不支持多行新增\n\n\n    if (newLineRecordRef.current && props.onlyAddOneLineAlertMessage !== false) {\n      _message.warn(props.onlyAddOneLineAlertMessage || '只能新增一行');\n\n      return false;\n    } // 如果是单行的话，不允许多行编辑\n\n\n    if (editableKeysSet.size > 0 && editableType === 'single' && props.onlyOneLineEditorAlertMessage !== false) {\n      _message.warn(props.onlyOneLineEditorAlertMessage || '只能同时编辑一行');\n\n      return false;\n    } // 防止多次渲染\n\n\n    var recordKey = props.getRowKey(row, -1);\n\n    if (!recordKey) {\n      noteOnce(!!recordKey, '请设置 recordCreatorProps.record 并返回一个唯一的key  \\n  https://procomponents.ant.design/components/editable-table#editable-%E6%96%B0%E5%BB%BA%E8%A1%8C');\n      throw new Error('请设置 recordCreatorProps.record 并返回一个唯一的key');\n    }\n\n    editableKeysSet.add(recordKey);\n    setEditableRowKeys(Array.from(editableKeysSet)); // 如果是dataSource 新增模式的话，取消再开始编辑，\n    // 这样就可以把新增到 dataSource的数据进入编辑模式了\n    // [a,b,cache] => [a,b,c]\n\n    if ((options === null || options === void 0 ? void 0 : options.newRecordType) === 'dataSource' || props.tableName) {\n      var _recordKeyToString3;\n\n      var actionProps = {\n        data: props.dataSource,\n        getRowKey: props.getRowKey,\n        row: _objectSpread(_objectSpread({}, row), {}, {\n          map_row_parentKey: (options === null || options === void 0 ? void 0 : options.parentKey) ? (_recordKeyToString3 = recordKeyToString(options === null || options === void 0 ? void 0 : options.parentKey)) === null || _recordKeyToString3 === void 0 ? void 0 : _recordKeyToString3.toString() : undefined\n        }),\n        key: recordKey,\n        childrenColumnName: props.childrenColumnName || 'children'\n      };\n      props.setDataSource(editableRowByKey(actionProps, (options === null || options === void 0 ? void 0 : options.position) === 'top' ? 'top' : 'update'));\n    } else {\n      setNewLineRecordCache({\n        defaultValue: row,\n        options: _objectSpread(_objectSpread({}, options), {}, {\n          recordKey: recordKey\n        })\n      });\n    }\n\n    return true;\n  }); // Internationalization\n\n  var intl = useIntl();\n  var saveText = (props === null || props === void 0 ? void 0 : props.saveText) || intl.getMessage('editableTable.action.save', '保存');\n  var deleteText = (props === null || props === void 0 ? void 0 : props.deleteText) || intl.getMessage('editableTable.action.delete', '删除');\n  var cancelText = (props === null || props === void 0 ? void 0 : props.cancelText) || intl.getMessage('editableTable.action.cancel', '取消');\n  var actionSaveRef = useRefFunction( /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(recordKey, editRow, originRow, newLine) {\n      var _props$onSave, _recordKeyToString4, _options$parentKey;\n\n      var _ref6, options, res, actionProps;\n\n      return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _ref6 = newLine || newLineRecordRef.current || {}, options = _ref6.options;\n              _context5.next = 3;\n              return props === null || props === void 0 ? void 0 : (_props$onSave = props.onSave) === null || _props$onSave === void 0 ? void 0 : _props$onSave.call(props, recordKey, editRow, originRow, newLine);\n\n            case 3:\n              res = _context5.sent;\n              // 保存时解除编辑模式\n              cancelEditable(recordKey);\n\n              if (!(!(options === null || options === void 0 ? void 0 : options.parentKey) && (options === null || options === void 0 ? void 0 : options.recordKey) === recordKey)) {\n                _context5.next = 8;\n                break;\n              }\n\n              if ((options === null || options === void 0 ? void 0 : options.position) === 'top') {\n                props.setDataSource([editRow].concat(_toConsumableArray(props.dataSource)));\n              } else {\n                props.setDataSource([].concat(_toConsumableArray(props.dataSource), [editRow]));\n              }\n\n              return _context5.abrupt(\"return\", res);\n\n            case 8:\n              actionProps = {\n                data: props.dataSource,\n                getRowKey: props.getRowKey,\n                row: options ? _objectSpread(_objectSpread({}, editRow), {}, {\n                  map_row_parentKey: (_recordKeyToString4 = recordKeyToString((_options$parentKey = options === null || options === void 0 ? void 0 : options.parentKey) !== null && _options$parentKey !== void 0 ? _options$parentKey : '')) === null || _recordKeyToString4 === void 0 ? void 0 : _recordKeyToString4.toString()\n                }) : editRow,\n                key: recordKey,\n                childrenColumnName: props.childrenColumnName || 'children'\n              };\n              props.setDataSource(editableRowByKey(actionProps, (options === null || options === void 0 ? void 0 : options.position) === 'top' ? 'top' : 'update'));\n              return _context5.abrupt(\"return\", res);\n\n            case 11:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function (_x3, _x4, _x5, _x6) {\n      return _ref5.apply(this, arguments);\n    };\n  }());\n  var actionDeleteRef = useRefFunction( /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(recordKey, editRow) {\n      var _props$onDelete;\n\n      var actionProps, res;\n      return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              actionProps = {\n                data: props.dataSource,\n                getRowKey: props.getRowKey,\n                row: editRow,\n                key: recordKey,\n                childrenColumnName: props.childrenColumnName || 'children'\n              };\n              _context6.next = 3;\n              return props === null || props === void 0 ? void 0 : (_props$onDelete = props.onDelete) === null || _props$onDelete === void 0 ? void 0 : _props$onDelete.call(props, recordKey, editRow);\n\n            case 3:\n              res = _context6.sent;\n              props.setDataSource(editableRowByKey(actionProps, 'delete'));\n              return _context6.abrupt(\"return\", res);\n\n            case 6:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function (_x7, _x8) {\n      return _ref7.apply(this, arguments);\n    };\n  }());\n  var actionCancelRef = useRefFunction( /*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(recordKey, editRow, originRow, newLine) {\n      var _props$onCancel;\n\n      var res;\n      return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.next = 2;\n              return props === null || props === void 0 ? void 0 : (_props$onCancel = props.onCancel) === null || _props$onCancel === void 0 ? void 0 : _props$onCancel.call(props, recordKey, editRow, originRow, newLine);\n\n            case 2:\n              res = _context7.sent;\n              return _context7.abrupt(\"return\", res);\n\n            case 4:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }));\n\n    return function (_x9, _x10, _x11, _x12) {\n      return _ref8.apply(this, arguments);\n    };\n  }());\n\n  var actionRender = function actionRender(row, form) {\n    var key = props.getRowKey(row, row.index);\n    var config = {\n      saveText: saveText,\n      cancelText: cancelText,\n      deleteText: deleteText,\n      addEditRecord: addEditRecord,\n      recordKey: key,\n      cancelEditable: cancelEditable,\n      index: row.index,\n      tableName: props.tableName,\n      newLineConfig: newLineRecordCache,\n      onCancel: actionCancelRef,\n      onDelete: actionDeleteRef,\n      onSave: actionSaveRef,\n      form: form,\n      editableKeys: editableKeys,\n      setEditableRowKeys: setEditableRowKeys,\n      deletePopconfirmMessage: props.deletePopconfirmMessage || '删除此行？'\n    };\n    var defaultDoms = defaultActionRender(row, config);\n    if (props.actionRender) return props.actionRender(row, config, {\n      save: defaultDoms[0],\n      delete: defaultDoms[1],\n      cancel: defaultDoms[2]\n    });\n    return defaultDoms;\n  };\n\n  return {\n    editableKeys: editableKeys,\n    setEditableRowKeys: setEditableRowKeys,\n    isEditable: isEditable,\n    actionRender: actionRender,\n    startEditable: startEditable,\n    cancelEditable: cancelEditable,\n    addEditRecord: addEditRecord,\n    newLineRecord: newLineRecordCache,\n    preEditableKeys: editableKeysRef,\n    onValuesChange: onValuesChange\n  };\n}\n\nexport default useEditableArray;"],"mappings":"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"},"metadata":{},"sourceType":"module"}